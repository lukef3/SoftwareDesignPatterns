È
YC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Validators\CustomerValidator.cs
	namespace 	
ToolSYS
 
. 
Business 
. 

Validators %
{ 
public 

class 
CustomerValidator "
:# $
AbstractValidator% 6
<6 7
Customer7 ?
>? @
{ 
public		 
CustomerValidator		  
(		  !
)		! "
{

 	
RuleFor 
( 
c 
=> 
c 
. 
forename #
)# $
. 
NotEmpty 
( 
) 
. 
WithMessage '
(' (
$str( ?
)? @
. 
MaximumLength 
( 
$num !
)! "
." #
WithMessage# .
(. /
$str/ V
)V W
. 
Matches 
( 
$str &
)& '
.' (
WithMessage( 3
(3 4
$str4 \
)\ ]
;] ^
RuleFor 
( 
c 
=> 
c 
. 
surname "
)" #
. 
NotEmpty 
( 
) 
. 
WithMessage '
(' (
$str( >
)> ?
. 
MaximumLength 
( 
$num !
)! "
." #
WithMessage# .
(. /
$str/ U
)U V
. 
Matches 
( 
$str &
)& '
.' (
WithMessage( 3
(3 4
$str4 [
)[ \
;\ ]
RuleFor 
( 
c 
=> 
c 
. 
email  
)  !
. 
NotEmpty 
( 
) 
. 
WithMessage '
(' (
$str( <
)< =
. 
Matches 
( 
$str 6
)6 7
.7 8
WithMessage8 C
(C D
$strD ^
)^ _
;_ `
RuleFor 
( 
c 
=> 
c 
. 
phone  
)  !
. 
NotEmpty 
( 
) 
. 
WithMessage '
(' (
$str( C
)C D
. 
Length 
( 
$num 
, 
$num 
) 
. 
WithMessage *
(* +
$str+ Z
)Z [
. 
Matches 
( 
$str #
)# $
.$ %
WithMessage% 0
(0 1
$str1 \
)\ ]
;] ^
RuleFor 
( 
c 
=> 
c 
. 
eircode "
)" #
. 
NotEmpty 
( 
) 
. 
WithMessage '
(' (
$str( >
)> ?
.   
Matches   
(   
$str   W
,  W X
RegexOptions  Y e
.  e f

IgnoreCase  f p
)  p q
.  q r
WithMessage  r }
(  } ~
$str	  ~ ê
)
  ê ë
;
  ë í
}!! 	
}"" 
}## Ûk
VC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Strategies\ReportStrategy.cs
	namespace 	
ToolSYS
 
. 
Business 
. 

Strategies %
{ 
public 

	interface 
IReportStrategy $
{ 

ReportData		 
GenerateReport		 !
(		! "
int		" %
year		& *
,		* +
string		, 2

reportType		3 =
)		= >
;		> ?
}

 
public 

class 
RevenueReport 
:  
IReportStrategy! 0
{ 
private 
readonly 
IAnalysisData &
_analysisData' 4
;4 5
public 
RevenueReport 
( 
IAnalysisData *
analysisData+ 7
)7 8
{ 	
_analysisData 
= 
analysisData (
;( )
} 	
public 

ReportData 
GenerateReport (
(( )
int) ,
year- 1
,1 2
string3 9

reportType: D
)D E
{ 	
var 
( 
labels 
, 
values 
)  
=! "
GetData# *
(* +
year+ /
)/ 0
;0 1
return 
new 

ReportData !
{ 
Title 
= 
$" 
$str 0
{0 1
year1 5
}5 6
"6 7
,7 8
YLabel 
= 
$str )
,) *
XLabels 
= 
labels  
.  !
ToList! '
(' (
)( )
,) *
YValues 
= 
values  
.  !
ToList! '
(' (
)( )
,) *
	ChartType 
= 
	ChartType %
.% &
Line& *
} 
; 
}   	
private"" 
("" 
string"" 
["" 
]"" 
Labels""  
,""  !
double""" (
[""( )
]"") *
Values""+ 1
)""1 2
GetData""3 :
("": ;
int""; >
year""? C
)""C D
{## 	
var$$ 
revenueTable$$ 
=$$ 
_analysisData$$ ,
.$$, -
GetMonthlyRevenues$$- ?
($$? @
year$$@ D
)$$D E
;$$E F
string%% 
[%% 
]%% 
months%% 
=%% 
GetMonthNames%% +
(%%+ ,
)%%, -
;%%- .
var&& 
revenues&& 
=&& 
new&& 
double&& %
[&&% &
$num&&& (
]&&( )
;&&) *
foreach'' 
('' 
DataRow'' 
row''  
in''! #
revenueTable''$ 0
.''0 1
Rows''1 5
)''5 6
{(( 
if)) 
()) 
int)) 
.)) 
TryParse))  
())  !
row))! $
[))$ %
$str))% ,
])), -
.))- .
ToString)). 6
())6 7
)))7 8
,))8 9
out)): =
var))> A
monthNumber))B M
)))M N
&&))O Q
double** 
.** 
TryParse** #
(**# $
row**$ '
[**' (
$str**( 1
]**1 2
.**2 3
ToString**3 ;
(**; <
)**< =
,**= >
out**? B
var**C F
revenue**G N
)**N O
)**O P
{++ 
var,, 

monthIndex,, "
=,,# $
monthNumber,,% 0
-,,1 2
$num,,3 4
;,,4 5
if-- 
(-- 

monthIndex-- "
is--# %
>=--& (
$num--) *
and--+ .
<--/ 0
$num--1 3
)--3 4
{.. 
revenues//  
[//  !

monthIndex//! +
]//+ ,
=//- .
revenue/// 6
;//6 7
}00 
}11 
}22 
return33 
(33 
months33 
,33 
revenues33 $
)33$ %
;33% &
}44 	
private66 
string66 
[66 
]66 
GetMonthNames66 &
(66& '
)66' (
{77 	
return88 
new88 
string88 
[88 
]88 
{99 
$str:: 
,:: 
$str:: %
,::% &
$str::' .
,::. /
$str::0 7
,::7 8
$str::9 >
,::> ?
$str::@ F
,::F G
$str;; 
,;; 
$str;;  
,;;  !
$str;;" -
,;;- .
$str;;/ 8
,;;8 9
$str;;: D
,;;D E
$str;;F P
}<< 
;<< 
}== 	
}>> 
public@@ 

class@@ 
RentalReport@@ 
:@@ 
IReportStrategy@@  /
{AA 
privateBB 
readonlyBB 
IAnalysisDataBB &
_analysisDataBB' 4
;BB4 5
publicCC 
RentalReportCC 
(CC 
IAnalysisDataCC )
analysisDataCC* 6
)CC6 7
{DD 	
_analysisDataEE 
=EE 
analysisDataEE (
;EE( )
}FF 	
publicHH 

ReportDataHH 
GenerateReportHH (
(HH( )
intHH) ,
yearHH- 1
,HH1 2
stringHH3 9

reportTypeHH: D
)HHD E
{II 	
varJJ 
(JJ 
labelsJJ 
,JJ 
valuesJJ 
)JJ  
=JJ! "
GetDataJJ# *
(JJ* +
yearJJ+ /
)JJ/ 0
;JJ0 1
returnLL 
newLL 

ReportDataLL !
{MM 
TitleNN 
=NN 
$"NN 
$strNN 0
{NN0 1
yearNN1 5
}NN5 6
"NN6 7
,NN7 8
YLabelOO 
=OO 
$strOO *
,OO* +
XLabelsPP 
=PP 
labelsPP  
.PP  !
ToListPP! '
(PP' (
)PP( )
,PP) *
YValuesQQ 
=QQ 
valuesQQ  
.QQ  !
ToListQQ! '
(QQ' (
)QQ( )
,QQ) *
	ChartTypeRR 
=RR 
	ChartTypeRR %
.RR% &
LineRR& *
}SS 
;SS 
}TT 	
privateVV 
(VV 
stringVV 
[VV 
]VV 
LabelsVV  
,VV  !
doubleVV" (
[VV( )
]VV) *
ValuesVV+ 1
)VV1 2
GetDataVV3 :
(VV: ;
intVV; >
yearVV? C
)VVC D
{WW 	
varXX 
rentalTableXX 
=XX 
_analysisDataXX +
.XX+ ,
GetMonthlyRentalsXX, =
(XX= >
yearXX> B
)XXB C
;XXC D
stringYY 
[YY 
]YY 
monthsYY 
=YY 
GetMonthNamesYY +
(YY+ ,
)YY, -
;YY- .
varZZ 
rentalsZZ 
=ZZ 
newZZ 
doubleZZ $
[ZZ$ %
$numZZ% '
]ZZ' (
;ZZ( )
foreach[[ 
([[ 
DataRow[[ 
row[[  
in[[! #
rentalTable[[$ /
.[[/ 0
Rows[[0 4
)[[4 5
{\\ 
if]] 
(]] 
int]] 
.]] 
TryParse]]  
(]]  !
row]]! $
[]]$ %
$str]]% ,
]]], -
.]]- .
ToString]]. 6
(]]6 7
)]]7 8
,]]8 9
out]]: =
var]]> A
monthNumber]]B M
)]]M N
&&]]O Q
double^^ 
.^^ 
TryParse^^ #
(^^# $
row^^$ '
[^^' (
$str^^( 4
]^^4 5
.^^5 6
ToString^^6 >
(^^> ?
)^^? @
,^^@ A
out^^B E
var^^F I
rental^^J P
)^^P Q
)^^Q R
{__ 
var`` 

monthIndex`` "
=``# $
monthNumber``% 0
-``1 2
$num``3 4
;``4 5
ifaa 
(aa 

monthIndexaa "
isaa# %
>=aa& (
$numaa) *
andaa+ .
<aa/ 0
$numaa1 3
)aa3 4
{bb 
rentalscc 
[cc  

monthIndexcc  *
]cc* +
=cc, -
rentalcc. 4
;cc4 5
}dd 
}ee 
}ff 
returngg 
(gg 
monthsgg 
,gg 
rentalsgg #
)gg# $
;gg$ %
}hh 	
privatejj 
stringjj 
[jj 
]jj 
GetMonthNamesjj &
(jj& '
)jj' (
{kk 	
returnll 
newll 
stringll 
[ll 
]ll 
{mm 
$strnn 
,nn 
$strnn %
,nn% &
$strnn' .
,nn. /
$strnn0 7
,nn7 8
$strnn9 >
,nn> ?
$strnn@ F
,nnF G
$stroo 
,oo 
$stroo  
,oo  !
$stroo" -
,oo- .
$stroo/ 8
,oo8 9
$stroo: D
,ooD E
$strooF P
}pp 
;pp 
}qq 	
}rr 
publictt 

classtt &
ToolTypeDistributionReporttt +
:tt, -
IReportStrategytt. =
{uu 
privatevv 
readonlyvv 
IAnalysisDatavv &
_analysisDatavv' 4
;vv4 5
publicxx &
ToolTypeDistributionReportxx )
(xx) *
IAnalysisDataxx* 7
analysisDataxx8 D
)xxD E
{yy 	
_analysisDatazz 
=zz 
analysisDatazz (
;zz( )
}{{ 	
public}} 

ReportData}} 
GenerateReport}} (
(}}( )
int}}) ,
year}}- 1
,}}1 2
string}}3 9

reportType}}: D
)}}D E
{~~ 	
var 
( 
labels 
, 
values 
)  
=! "
GetData# *
(* +
year+ /
)/ 0
;0 1
return
ÅÅ 
new
ÅÅ 

ReportData
ÅÅ !
{
ÇÇ 
Title
ÉÉ 
=
ÉÉ 
$"
ÉÉ 
$str
ÉÉ <
{
ÉÉ< =
year
ÉÉ= A
}
ÉÉA B
"
ÉÉB C
,
ÉÉC D
YLabel
ÑÑ 
=
ÑÑ 
$str
ÑÑ ,
,
ÑÑ, -
XLabels
ÖÖ 
=
ÖÖ 
labels
ÖÖ  
.
ÖÖ  !
ToList
ÖÖ! '
(
ÖÖ' (
)
ÖÖ( )
,
ÖÖ) *
YValues
ÜÜ 
=
ÜÜ 
values
ÜÜ  
.
ÜÜ  !
ToList
ÜÜ! '
(
ÜÜ' (
)
ÜÜ( )
,
ÜÜ) *
	ChartType
áá 
=
áá 
	ChartType
áá %
.
áá% &
Pie
áá& )
}
àà 
;
àà 
}
ââ 	
private
ãã 
(
ãã 
string
ãã 
[
ãã 
]
ãã 
Labels
ãã  
,
ãã  !
double
ãã" (
[
ãã( )
]
ãã) *
Values
ãã+ 1
)
ãã1 2
GetData
ãã3 :
(
ãã: ;
int
ãã; >
year
ãã? C
)
ããC D
{
åå 	
var
çç !
categoryRentalTable
çç #
=
çç$ %
_analysisData
çç& 3
.
çç3 4 
GetCategoryRentals
çç4 F
(
ççF G
year
ççG K
)
ççK L
;
ççL M
List
éé 
<
éé 
string
éé 
>
éé 

categories
éé #
=
éé$ %
new
éé& )
List
éé* .
<
éé. /
string
éé/ 5
>
éé5 6
(
éé6 7
)
éé7 8
;
éé8 9
var
èè 
rentalCounts
èè 
=
èè 
new
èè "
List
èè# '
<
èè' (
double
èè( .
>
èè. /
(
èè/ 0
)
èè0 1
;
èè1 2
foreach
ëë 
(
ëë 
DataRow
ëë 
row
ëë  
in
ëë! #!
categoryRentalTable
ëë$ 7
.
ëë7 8
Rows
ëë8 <
)
ëë< =
{
íí 
var
ìì 
category
ìì 
=
ìì 
row
ìì "
[
ìì" #
$str
ìì# 1
]
ìì1 2
.
ìì2 3
ToString
ìì3 ;
(
ìì; <
)
ìì< =
;
ìì= >
if
îî 
(
îî 
double
îî 
.
îî 
TryParse
îî #
(
îî# $
row
îî$ '
[
îî' (
$str
îî( 4
]
îî4 5
.
îî5 6
ToString
îî6 >
(
îî> ?
)
îî? @
,
îî@ A
out
îîB E
var
îîF I
count
îîJ O
)
îîO P
)
îîP Q
{
ïï 

categories
ññ 
.
ññ 
Add
ññ "
(
ññ" #
category
ññ# +
)
ññ+ ,
;
ññ, -
rentalCounts
óó  
.
óó  !
Add
óó! $
(
óó$ %
count
óó% *
)
óó* +
;
óó+ ,
}
òò 
}
ôô 
return
õõ 
(
õõ 

categories
õõ 
.
õõ 
ToArray
õõ &
(
õõ& '
)
õõ' (
,
õõ( )
rentalCounts
õõ* 6
.
õõ6 7
ToArray
õõ7 >
(
õõ> ?
)
õõ? @
)
õõ@ A
;
õõA B
}
úú 	
}
ùù 
}ûû ™

hC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\SimpleFactories\ReportStrategySimpleFactory.cs
	namespace 	
ToolSYS
 
. 
Business 
. 
	Factories $
;$ %
public 
class '
ReportStrategySimpleFactory (
{ 
public 

static 
IReportStrategy !
GetStrategy" -
(- .
string. 4

reportType5 ?
,? @
IAnalysisDataA N
analysisDataO [
)[ \
{		 
return

 

reportType

 
switch

  
{ 	
$str 
=> !
new" %
RevenueReport& 3
(3 4
analysisData4 @
)@ A
,A B
$str "
=># %
new& )
RentalReport* 6
(6 7
analysisData7 C
)C D
,D E
$str $
=>% '
new( +&
ToolTypeDistributionReport, F
(F G
analysisDataG S
)S T
,T U
_ 	
=>
 
throw 
new 
ArgumentException (
(( )
$str) >
)> ?
} 	
;	 

} 
} æ;
QC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Services\ToolService.cs
	namespace 	
ToolSYS
 
. 
Business 
. 
Services #
{ 
public 

	interface 
IToolService !
{ 
void		 
AddTool		 
(		 
Tool		 
tool		 
)		 
;		  
void

 

UpdateTool

 
(

 
Tool

 
tool

 !
)

! "
;

" #
void 

RemoveTool 
( 
int 
toolId "
)" #
;# $
DataSet 
GetFilteredTools  
(  !
string! '
toolIdAsString( 6
,6 7
string8 >
categoryCode? K
,K L
stringM S
descriptionT _
,_ `
stringa g
manufacturerh t
,t u
stringv |
status	} É
,
É Ñ
string
Ö ã
phrase
å í
)
í ì
;
ì î
DataSet 
GetAvailableTools !
(! "
)" #
;# $
DataSet 
GetRentableTools  
(  !
string! '
categoryCode( 4
,4 5
DateTime6 >
from? C
,C D
DateTimeE M
toN P
)P Q
;Q R
int 
GetNextToolId 
( 
) 
; 
} 
public 

class 
ToolService 
: 
IToolService +
{ 
private 
readonly 
	IToolData "
	_toolData# ,
;, -
public 
ToolService 
( 
	IToolData $
toolData% -
)- .
{ 	
	_toolData 
= 
toolData  
;  !
} 	
public 
void 
AddTool 
( 
Tool  
tool! %
)% &
{ 	
ValidateTool 
( 
tool 
, 
isUpdate '
:' (
false) .
). /
;/ 0
	_toolData 
. 
AddTool 
( 
tool "
)" #
;# $
}   	
public"" 
void"" 

UpdateTool"" 
("" 
Tool"" #
tool""$ (
)""( )
{## 	
ValidateTool$$ 
($$ 
tool$$ 
,$$ 
isUpdate$$ '
:$$' (
true$$) -
)$$- .
;$$. /
	_toolData%% 
.%% 

UpdateTool%%  
(%%  !
tool%%! %
)%%% &
;%%& '
}&& 	
public(( 
void(( 

RemoveTool(( 
((( 
int(( "
toolId((# )
)(() *
{)) 	
if** 
(** 
!** 
	_toolData** 
.** 

ToolExists** %
(**% &
toolId**& ,
)**, -
)**- .
throw++ 
new++ 
ArgumentException++ +
(+++ ,
$str++, >
)++> ?
;++? @
	_toolData-- 
.-- 

RemoveTool--  
(--  !
toolId--! '
)--' (
;--( )
}.. 	
public00 
DataSet00 
GetFilteredTools00 '
(00' (
string00( .
toolIdAsString00/ =
,00= >
string00? E
categoryCode00F R
,00R S
string00T Z
description00[ f
,00f g
string00h n
manufacturer00o {
,00{ |
string	00} É
status
00Ñ ä
,
00ä ã
string
00å í
phrase
00ì ô
)
00ô ö
{11 	
return22 
	_toolData22 
.22 
GetFilteredTools22 -
(22- .
toolIdAsString22. <
,22< =
categoryCode22> J
,22J K
description22L W
,22W X
manufacturer22Y e
,22e f
status22g m
,22m n
phrase22o u
)22u v
;22v w
}33 	
public55 
DataSet55 
GetAvailableTools55 (
(55( )
)55) *
{66 	
return77 
	_toolData77 
.77 
GetAvailableTools77 .
(77. /
)77/ 0
;770 1
}88 	
public:: 
DataSet:: 
GetRentableTools:: '
(::' (
string::( .
categoryCode::/ ;
,::; <
DateTime::= E
from::F J
,::J K
DateTime::L T
to::U W
)::W X
{;; 	
return<< 
	_toolData<< 
.<< 
GetRentableTools<< -
(<<- .
categoryCode<<. :
,<<: ;
from<<< @
,<<@ A
to<<B D
)<<D E
;<<E F
}== 	
public?? 
int?? 
GetNextToolId??  
(??  !
)??! "
{@@ 	
returnAA 
	_toolDataAA 
.AA 
GetNextToolIdAA *
(AA* +
)AA+ ,
;AA, -
}BB 	
privateDD 
voidDD 
ValidateToolDD !
(DD! "
ToolDD" &
toolDD' +
,DD+ ,
boolDD- 1
isUpdateDD2 :
)DD: ;
{EE 	
ifFF 
(FF 
stringFF 
.FF 
IsNullOrEmptyFF $
(FF$ %
toolFF% )
.FF) *
toolDescriptionFF* 9
)FF9 :
||FF; =
toolFF> B
.FFB C
toolDescriptionFFC R
.FFR S
LengthFFS Y
>FFZ [
$numFF\ ^
)FF^ _
throwGG 
newGG 
ArgumentExceptionGG +
(GG+ ,
$strGG, c
)GGc d
;GGd e
ifII 
(II 
stringII 
.II 
IsNullOrEmptyII $
(II$ %
toolII% )
.II) *
categoryCodeII* 6
)II6 7
)II7 8
throwJJ 
newJJ 
ArgumentExceptionJJ +
(JJ+ ,
$strJJ, H
)JJH I
;JJI J
ifLL 
(LL 
!LL 
toolLL 
.LL 
categoryCodeLL "
.LL" #
AllLL# &
(LL& '
charLL' +
.LL+ ,
IsLetterOrDigitLL, ;
)LL; <
)LL< =
throwMM 
newMM 
ArgumentExceptionMM +
(MM+ ,
$strMM, d
)MMd e
;MMe f
ifOO 
(OO 
stringOO 
.OO 
IsNullOrEmptyOO $
(OO$ %
toolOO% )
.OO) *
toolManufacturerOO* :
)OO: ;
||OO< >
toolOO? C
.OOC D
toolManufacturerOOD T
.OOT U
LengthOOU [
>OO\ ]
$numOO^ `
)OO` a
throwPP 
newPP 
ArgumentExceptionPP +
(PP+ ,
$strPP, d
)PPd e
;PPe f
ifRR 
(RR 
!RR 
isUpdateRR 
&&RR 
	_toolDataRR &
.RR& '

ToolExistsRR' 1
(RR1 2
toolRR2 6
.RR6 7
toolIdRR7 =
)RR= >
)RR> ?
throwSS 
newSS 
ArgumentExceptionSS +
(SS+ ,
$strSS, Q
)SSQ R
;SSR S
}TT 	
}UU 
}VV Ò.
SC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Services\RentalService.cs
	namespace 	
ToolSYS
 
. 
Business 
. 
Services #
{ 
public 

	interface 
IRentalService #
{		 
int

 
GetNextRentalId

 
(

 
)

 
;

 
decimal 
CalculateRentalFee "
(" #
int# &

customerId' 1
,1 2
string3 9
categoryCode: F
,F G
DateTimeH P
rentDateQ Y
,Y Z
DateTime[ c

returnDated n
)n o
;o p
void 
ConfirmRental 
( 
Rental !
rental" (
)( )
;) *
	DataTable 
GetRentalItems  
(  !
int! $
rentalId% -
)- .
;. /
void 

ReturnTool 
( 
int 
rentalId $
,$ %
int& )
toolId* 0
)0 1
;1 2
} 
public 

class 
RentalService 
:  
IRentalService! /
{ 
private 
readonly 
	IRateData "
	_rateData# ,
;, -
private 
readonly 
IUnitOfWork $
_unitOfWork% 0
;0 1
public 
RentalService 
( 
	IRateData &
rateData' /
,/ 0
IUnitOfWork1 <

unitOfWork= G
)G H
{ 	
	_rateData 
= 
rateData  
;  !
_unitOfWork 
= 

unitOfWork $
;$ %
} 	
public 
int 
GetNextRentalId "
(" #
)# $
{ 	
return 
_unitOfWork 
. 
Rentals &
.& '
GetNextRentalId' 6
(6 7
)7 8
;8 9
} 	
public   
decimal   
CalculateRentalFee   )
(  ) *
int  * -

customerId  . 8
,  8 9
string  : @
categoryCode  A M
,  M N
DateTime  O W
rentDate  X `
,  ` a
DateTime  b j

returnDate  k u
)  u v
{!! 	
if"" 
("" 
rentDate"" 
>"" 

returnDate"" %
)""% &
throw## 
new## 
ArgumentException## +
(##+ ,
$str##, Y
)##Y Z
;##Z [
int%% 

daysRented%% 
=%% 
(%% 

returnDate%% (
-%%) *
rentDate%%+ 3
)%%3 4
.%%4 5
Days%%5 9
+%%: ;
$num%%< =
;%%= >
Rate&& 
rate&& 
=&& 
	_rateData&& !
.&&! "!
GetRateByCategoryCode&&" 7
(&&7 8
categoryCode&&8 D
)&&D E
;&&E F
decimal'' 
	dailyRate'' 
='' 
rate''  $
.''$ %
rate''% )
;'') *
decimal(( 
fee(( 
=(( 
	dailyRate(( #
*(($ %

daysRented((& 0
;((0 1
return** 
fee** 
;** 
}++ 	
public-- 
void-- 
ConfirmRental-- !
(--! "
Rental--" (
rental--) /
)--/ 0
{.. 	
try// 
{00 
_unitOfWork11 
.11 
BeginTransaction11 ,
(11, -
)11- .
;11. /
_unitOfWork33 
.33 
Rentals33 #
.33# $
	AddRental33$ -
(33- .
rental33. 4
)334 5
;335 6
foreach55 
(55 
var55 

rentalItem55 '
in55( *
rental55+ 1
.551 2
rentalItems552 =
)55= >
{66 
_unitOfWork77 
.77  
RentalItems77  +
.77+ ,
AddRentalItem77, 9
(779 :

rentalItem77: D
)77D E
;77E F
}88 
_unitOfWork:: 
.:: 
Commit:: "
(::" #
)::# $
;::$ %
};; 
catch<< 
{== 
_unitOfWork>> 
.>> 
Rollback>> $
(>>$ %
)>>% &
;>>& '
throw?? 
;?? 
}@@ 
}AA 	
publicCC 
	DataTableCC 
GetRentalItemsCC '
(CC' (
intCC( +
rentalIdCC, 4
)CC4 5
{DD 	
ifEE 
(EE 
rentalIdEE 
<=EE 
$numEE 
)EE 
throwFF 
newFF 
ArgumentExceptionFF +
(FF+ ,
$strFF, @
)FF@ A
;FFA B
returnHH 
_unitOfWorkHH 
.HH 
RentalsHH &
.HH& '$
GetRentalItemsByRentalIdHH' ?
(HH? @
rentalIdHH@ H
)HHH I
;HHI J
}II 	
publicKK 
voidKK 

ReturnToolKK 
(KK 
intKK "
rentalIdKK# +
,KK+ ,
intKK- 0
toolIdKK1 7
)KK7 8
{LL 	
ifMM 
(MM 
rentalIdMM 
<=MM 
$numMM 
||MM  
toolIdMM! '
<=MM( *
$numMM+ ,
)MM, -
throwNN 
newNN 
ArgumentExceptionNN +
(NN+ ,
$strNN, Z
)NNZ [
;NN[ \
_unitOfWorkPP 
.PP 
RentalsPP 
.PP  

ReturnToolPP  *
(PP* +
rentalIdPP+ 3
,PP3 4
toolIdPP5 ;
)PP; <
;PP< =
}QQ 	
}TT 
}UU Î(
QC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Services\RateService.cs
	namespace 	
ToolSYS
 
. 
Business 
. 
Services #
{ 
public 

	interface 
IRateService !
{ 
void		 
AddRate		 
(		 
Rate		 
rate		 
)		 
;		  
void

 

UpdateRate

 
(

 
Rate

 
rate

 !
)

! "
;

" #
Rate !
GetRateByCategoryCode "
(" #
string# )
categoryCode* 6
)6 7
;7 8
DataSet 
GetAllCategories  
(  !
)! "
;" #
} 
public 

class 
RateService 
: 
IRateService +
{ 
private 
readonly 
	IRateData "
	_rateData# ,
;, -
public 
RateService 
( 
	IRateData $
rateData% -
)- .
{ 	
	_rateData 
= 
rateData  
;  !
} 	
public 
void 
AddRate 
( 
Rate  
rate! %
)% &
{ 	
ValidateRate 
( 
rate 
, 
isUpdate '
:' (
false) .
). /
;/ 0
	_rateData 
. 
AddRate 
( 
rate "
)" #
;# $
} 	
public 
void 

UpdateRate 
( 
Rate #
rate$ (
)( )
{ 	
ValidateRate   
(   
rate   
,   
isUpdate   '
:  ' (
true  ) -
)  - .
;  . /
	_rateData!! 
.!! 

UpdateRate!!  
(!!  !
rate!!! %
)!!% &
;!!& '
}"" 	
public$$ 
Rate$$ !
GetRateByCategoryCode$$ )
($$) *
string$$* 0
categoryCode$$1 =
)$$= >
{%% 	
if&& 
(&& 
string&& 
.&& 
IsNullOrEmpty&& $
(&&$ %
categoryCode&&% 1
)&&1 2
)&&2 3
throw'' 
new'' 
ArgumentException'' +
(''+ ,
$str'', H
)''H I
;''I J
return)) 
	_rateData)) 
.)) !
GetRateByCategoryCode)) 2
())2 3
categoryCode))3 ?
)))? @
;))@ A
}** 	
public,, 
DataSet,, 
GetAllCategories,, '
(,,' (
),,( )
{-- 	
return.. 
	_rateData.. 
... 
GetAllCategories.. -
(..- .
)... /
;../ 0
}// 	
private11 
void11 
ValidateRate11 !
(11! "
Rate11" &
rate11' +
,11+ ,
bool11- 1
isUpdate112 :
)11: ;
{22 	
if33 
(33 
string33 
.33 
IsNullOrEmpty33 $
(33$ %
rate33% )
.33) *
categoryCode33* 6
)336 7
||338 :
rate33; ?
.33? @
categoryCode33@ L
.33L M
Length33M S
!=33T V
$num33W X
)33X Y
throw44 
new44 
ArgumentException44 +
(44+ ,
$str44, ^
)44^ _
;44_ `
if66 
(66 
string66 
.66 
IsNullOrEmpty66 $
(66$ %
rate66% )
.66) *
categoryDesc66* 6
)666 7
||668 :
rate66; ?
.66? @
categoryDesc66@ L
.66L M
Length66M S
>66T U
$num66V X
)66X Y
throw77 
new77 
ArgumentException77 +
(77+ ,
$str77, g
)77g h
;77h i
if99 
(99 
rate99 
.99 
rate99 
<=99 
$num99 
)99 
throw:: 
new:: 
ArgumentException:: +
(::+ ,
$str::, J
)::J K
;::K L
if<< 
(<< 
!<< 
rate<< 
.<< 
categoryCode<< "
.<<" #
All<<# &
(<<& '
char<<' +
.<<+ ,
IsLetter<<, 4
)<<4 5
)<<5 6
throw== 
new== 
ArgumentException== +
(==+ ,
$str==, Y
)==Y Z
;==Z [
if?? 
(?? 
!?? 
isUpdate?? 
&&?? 
	_rateData?? &
.??& '!
DoesCategoryCodeExist??' <
(??< =
rate??= A
.??A B
categoryCode??B N
)??N O
)??O P
throw@@ 
new@@ 
ArgumentException@@ +
(@@+ ,
$str@@, W
)@@W X
;@@X Y
}AA 	
}BB 
}CC  /
UC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Services\CustomerService.cs
	namespace 	
ToolSYS
 
. 
Business 
. 
Services #
{ 
public		 

	interface		 
ICustomerService		 %
{

 
int 
GetNextCustomerId 
( 
) 
;  
void 
AddCustomer 
( 
Customer !
customer" *
)* +
;+ ,
void 
UpdateCustomer 
( 
Customer $
customer% -
)- .
;. /
DataSet 
SearchCustomers 
(  
string  &
searchPhrase' 3
)3 4
;4 5
DataSet  
GetFilteredCustomers $
($ %
string% +

customerId, 6
,6 7
string8 >
forename? G
,G H
stringI O
surnameP W
,W X
stringY _
email` e
,e f
stringg m
phonen s
,s t
stringu {
eircode	| É
,
É Ñ
string
Ö ã
phrase
å í
)
í ì
;
ì î
} 
public 

class 
CustomerService  
:! "
ICustomerService# 3
{ 
private 
readonly 
ICustomerData &
_customerData' 4
;4 5
private 
readonly 

IValidator #
<# $
Customer$ ,
>, -
_customerValidator. @
;@ A
public 
CustomerService 
( 
ICustomerData ,
customerData- 9
,9 :

IValidator; E
<E F
CustomerF N
>N O
customerValidatorP a
)a b
{ 	
_customerData 
= 
customerData (
;( )
_customerValidator 
=  
customerValidator! 2
;2 3
} 	
public 
int 
GetNextCustomerId $
($ %
)% &
{ 	
return 
_customerData  
.  !
GetNextCustomerId! 2
(2 3
)3 4
;4 5
}   	
public"" 
void"" 
AddCustomer"" 
(""  
Customer""  (
customer"") 1
)""1 2
{## 	
var$$ 
validationResult$$  
=$$! "
_customerValidator$$# 5
.$$5 6
Validate$$6 >
($$> ?
customer$$? G
)$$G H
;$$H I
if&& 
(&& 
!&& 
validationResult&& !
.&&! "
IsValid&&" )
)&&) *
{'' 
var(( 
errors(( 
=(( 
string(( #
.((# $
Join(($ (
(((( )
$str(() -
,((- .
validationResult((/ ?
.((? @
Errors((@ F
.((F G
Select((G M
(((M N
e((N O
=>((P R
e((S T
.((T U
ErrorMessage((U a
)((a b
)((b c
;((c d
throw)) 
new)) 
ValidationException)) -
())- .
errors)). 4
)))4 5
;))5 6
}** 
_customerData,, 
.,, 
AddCustomer,, %
(,,% &
customer,,& .
),,. /
;,,/ 0
}-- 	
public// 
void// 
UpdateCustomer// "
(//" #
Customer//# +
customer//, 4
)//4 5
{00 	
var11 
validationResult11  
=11! "
_customerValidator11# 5
.115 6
Validate116 >
(11> ?
customer11? G
)11G H
;11H I
if33 
(33 
!33 
validationResult33 !
.33! "
IsValid33" )
)33) *
{44 
var55 
errors55 
=55 
string55 #
.55# $
Join55$ (
(55( )
$str55) -
,55- .
validationResult55/ ?
.55? @
Errors55@ F
.55F G
Select55G M
(55M N
e55N O
=>55P R
e55S T
.55T U
ErrorMessage55U a
)55a b
)55b c
;55c d
throw66 
new66 
ValidationException66 -
(66- .
errors66. 4
)664 5
;665 6
}77 
_customerData99 
.99 
UpdateCustomer99 (
(99( )
customer99) 1
)991 2
;992 3
}:: 	
public<< 
DataSet<< 
SearchCustomers<< &
(<<& '
string<<' -
searchPhrase<<. :
)<<: ;
{== 	
return>> 
_customerData>>  
.>>  !
SearchCustomers>>! 0
(>>0 1
searchPhrase>>1 =
)>>= >
;>>> ?
}?? 	
publicAA 
DataSetAA  
GetFilteredCustomersAA +
(AA+ ,
stringAA, 2

customerIdAA3 =
,AA= >
stringAA? E
forenameAAF N
,AAN O
stringAAP V
surnameAAW ^
,AA^ _
stringAA` f
emailAAg l
,AAl m
stringAAn t
phoneAAu z
,AAz {
string	AA| Ç
eircode
AAÉ ä
,
AAä ã
string
AAå í
phrase
AAì ô
)
AAô ö
{BB 	
returnCC 
_customerDataCC  
.CC  ! 
GetFilteredCustomersCC! 5
(CC5 6

customerIdCC6 @
,CC@ A
forenameCCB J
,CCJ K
surnameCCL S
,CCS T
emailCCU Z
,CCZ [
phoneCC\ a
,CCa b
eircodeCCc j
,CCj k
phraseCCl r
)CCr s
;CCs t
}DD 	
}EE 
}FF å
UC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Services\AnalysisService.cs
	namespace 	
ToolSYS
 
. 
Business 
. 
Services #
{ 
public		 

	interface		 
IAnalysisService		 %
{

 
	DataTable 
GetDistinctYears "
(" #
)# $
;$ %

ReportData 
GetReportData  
(  !
int! $
year% )
,) *
string+ 1

reportType2 <
)< =
;= >
} 
public 

class 
AnalysisService  
:! "
IAnalysisService# 3
{ 
private 
readonly 
IAnalysisData &
_analysisData' 4
;4 5
public 
AnalysisService 
( 
IAnalysisData ,
analysisData- 9
)9 :
{ 	
_analysisData 
= 
analysisData (
;( )
} 	
public 

ReportData 
GetReportData '
(' (
int( +
year, 0
,0 1
string2 8

reportType9 C
)C D
{ 	
IReportStrategy 
strategy $
=% &'
ReportStrategySimpleFactory' B
.B C
GetStrategyC N
(N O

reportTypeO Y
,Y Z
_analysisData[ h
)h i
;i j
return 
strategy 
. 
GenerateReport *
(* +
year+ /
,/ 0

reportType1 ;
); <
;< =
} 	
public 
	DataTable 
GetDistinctYears )
() *
)* +
{   	
return!! 
_analysisData!!  
.!!  !
GetDistinctYears!!! 1
(!!1 2
)!!2 3
;!!3 4
}"" 	
}## 
}$$ èM
QC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Facades\RentalFacade.cs
	namespace 	
ToolSYS
 
. 
Business 
. 
Facades "
;" #
public 
	interface 
IRentalFacade 
{		 
	DataTable

 
SearchCustomers

 
(

 
string

 $

searchTerm

% /
)

/ 0
;

0 1
	DataTable 
GetCategories 
( 
) 
; 
	DataTable 
GetRentableTools 
( 
string %
categoryCode& 2
,2 3
DateTime4 <
fromDate= E
,E F
DateTimeG O
toDateP V
)V W
;W X
void 
StartNewRental	 
( 
int 

customerId &
)& '
;' (
void 
AddToolToRental	 
( 
int 
toolId #
,# $
string% +
categoryCode, 8
,8 9
string: @
descriptionA L
,L M
stringN T
manufacturerU a
,a b
DateTimec k
rentDatel t
,t u
DateTimev ~

returnDate	 â
)
â ä
;
ä ã
decimal 
CalculateTotalFee 
( 
) 
;  
void 
ConfirmRental	 
( 
) 
; 
void 
ResetRental	 
( 
) 
; 
Rental 

GetCurrentRental 
( 
) 
; 
} 
public 
class 
RentalFacade 
: 
IRentalFacade )
{ 
private 
readonly 
IToolService !
_toolService" .
;. /
private 
readonly 
IRateService !
_rateService" .
;. /
private 
readonly 
ICustomerService %
_customerService& 6
;6 7
private 
readonly 
IRentalService #
_rentalService$ 2
;2 3
private 
IRentalBuilder 
? 
_rentalBuilder *
;* +
public 

RentalFacade 
( 
IToolService 
toolService  
,  !
IRateService 
rateService  
,  !
ICustomerService   
customerService   (
,  ( )
IRentalService!! 
rentalService!! $
)!!$ %
{"" 
_toolService## 
=## 
toolService## "
;##" #
_rateService$$ 
=$$ 
rateService$$ "
;$$" #
_customerService%% 
=%% 
customerService%% *
;%%* +
_rentalService&& 
=&& 
rentalService&& &
;&&& '
}'' 
public)) 

	DataTable)) 
SearchCustomers)) $
())$ %
string))% +

searchTerm)), 6
)))6 7
{** 
DataSet++ 
	customers++ 
=++ 
_customerService++ ,
.++, -
SearchCustomers++- <
(++< =

searchTerm++= G
)++G H
;++H I
return,, 
	customers,, 
.,, 
Tables,, 
[,,  
$str,,  *
],,* +
;,,+ ,
}-- 
public// 

	DataTable// 
GetCategories// "
(//" #
)//# $
{00 
DataSet11 

categories11 
=11 
_rateService11 )
.11) *
GetAllCategories11* :
(11: ;
)11; <
;11< =
return22 

categories22 
.22 
Tables22  
[22  !
$num22! "
]22" #
;22# $
}33 
public55 

	DataTable55 
GetRentableTools55 %
(55% &
string55& ,
categoryCode55- 9
,559 :
DateTime55; C
fromDate55D L
,55L M
DateTime55N V
toDate55W ]
)55] ^
{66 
DataSet77 
tools77 
=77 
_toolService77 $
.77$ %
GetRentableTools77% 5
(775 6
categoryCode776 B
,77B C
fromDate77D L
,77L M
toDate77N T
)77T U
;77U V
return88 
tools88 
.88 
Tables88 
[88 
$str88 "
]88" #
;88# $
}99 
public;; 

void;; 
StartNewRental;; 
(;; 
int;; "

customerId;;# -
);;- .
{<< 
int== 
rentalId== 
=== 
_rentalService== %
.==% &
GetNextRentalId==& 5
(==5 6
)==6 7
;==7 8
_rentalBuilder>> 
=>> 
new>> 
RentalBuilder>> *
(>>* +
)>>+ ,
.?? 
SetRentalId?? 
(?? 
rentalId?? !
)??! "
.@@ 
SetCustomerId@@ 
(@@ 

customerId@@ %
)@@% &
.AA 
SetTransactionDateAA 
(AA  
DateTimeAA  (
.AA( )
TodayAA) .
)AA. /
;AA/ 0
}BB 
publicDD 

voidDD 
AddToolToRentalDD 
(DD  
intDD  #
toolIdDD$ *
,DD* +
stringDD, 2
categoryCodeDD3 ?
,DD? @
stringDDA G
descriptionDDH S
,DDS T
stringDDU [
manufacturerDD\ h
,DDh i
DateTimeDDj r
rentDateDDs {
,DD{ |
DateTime	DD} Ö

returnDate
DDÜ ê
)
DDê ë
{EE 
ifFF 

(FF 
_rentalBuilderFF 
==FF 
nullFF "
)FF" #
throwGG 
newGG %
InvalidOperationExceptionGG /
(GG/ 0
$strGG0 N
)GGN O
;GGO P
decimalII 
	rentalFeeII 
=II 
_rentalServiceII *
.II* +
CalculateRentalFeeII+ =
(II= >
_rentalBuilderJJ 
.JJ 
	GetRentalJJ $
(JJ$ %
)JJ% &
.JJ& '

customerIdJJ' 1
,JJ1 2
categoryCodeKK 
,KK 
rentDateLL 
,LL 

returnDateMM 
)MM 
;MM 
varOO 

rentalItemOO 
=OO 
newOO 

RentalItemOO '
{PP 	
rentalIdQQ 
=QQ 
_rentalBuilderQQ %
.QQ% &
	GetRentalQQ& /
(QQ/ 0
)QQ0 1
.QQ1 2
rentalIdQQ2 :
,QQ: ;
toolIdRR 
=RR 
toolIdRR 
,RR 
rentDateSS 
=SS 
rentDateSS 
,SS  

returnDateTT 
=TT 

returnDateTT #
,TT# $
	rentalFeeUU 
=UU 
	rentalFeeUU !
}VV 	
;VV	 

_rentalBuilderXX 
.XX 
AddRentalItemXX $
(XX$ %

rentalItemXX% /
)XX/ 0
;XX0 1
}YY 
public[[ 

decimal[[ 
CalculateTotalFee[[ $
([[$ %
)[[% &
{\\ 
if]] 

(]] 
_rentalBuilder]] 
==]] 
null]] "
)]]" #
return^^ 
$num^^ 
;^^ 
var`` 
rental`` 
=`` 
_rentalBuilder`` #
.``# $
	GetRental``$ -
(``- .
)``. /
;``/ 0
ifbb 

(bb 
rentalbb 
.bb 
rentalItemsbb 
==bb !
nullbb" &
||bb' )
!bb* +
rentalbb+ 1
.bb1 2
rentalItemsbb2 =
.bb= >
Anybb> A
(bbA B
)bbB C
)bbC D
returncc 
$numcc 
;cc 
returnee 
rentalee 
.ee 
rentalItemsee !
.ee! "
Sumee" %
(ee% &
itemee& *
=>ee+ -
itemee. 2
.ee2 3
	rentalFeeee3 <
)ee< =
;ee= >
}ff 
publichh 

voidhh 
ConfirmRentalhh 
(hh 
)hh 
{ii 
ifjj 

(jj 
_rentalBuilderjj 
==jj 
nulljj "
)jj" #
throwkk 
newkk %
InvalidOperationExceptionkk /
(kk/ 0
$strkk0 N
)kkN O
;kkO P
varmm 
rentalmm 
=mm 
_rentalBuildermm #
.nn 
SetTotalFeenn 
(nn 
CalculateTotalFeenn *
(nn* +
)nn+ ,
)nn, -
.oo 
Buildoo 
(oo 
)oo 
;oo 
_rentalServiceqq 
.qq 
ConfirmRentalqq $
(qq$ %
rentalqq% +
)qq+ ,
;qq, -
_rentalBuilderss 
=ss 
nullss 
;ss 
}tt 
publicvv 

voidvv 
ResetRentalvv 
(vv 
)vv 
{ww 
_rentalBuilderxx 
=xx 
nullxx 
;xx 
}yy 
public{{ 

Rental{{ 
GetCurrentRental{{ "
({{" #
){{# $
{|| 
return}} 
_rentalBuilder}} 
.}} 
	GetRental}} '
(}}' (
)}}( )
;}}) *
}~~ 
} Ï,
SC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Builders\RentalBuilder.cs
	namespace 	
ToolSYS
 
. 
Business 
. 
Builders #
{ 
public 

	interface 
IRentalBuilder #
{ 
IRentalBuilder 
SetRentalId "
(" #
int# &
rentalId' /
)/ 0
;0 1
IRentalBuilder 
SetCustomerId $
($ %
int% (

customerId) 3
)3 4
;4 5
IRentalBuilder		 
SetTransactionDate		 )
(		) *
DateTime		* 2
date		3 7
)		7 8
;		8 9
IRentalBuilder

 
SetTotalFee

 "
(

" #
decimal

# *
totalFee

+ 3
)

3 4
;

4 5
IRentalBuilder 
AddRentalItem $
($ %

RentalItem% /

rentalItem0 :
): ;
;; <
Rental 
Build 
( 
) 
; 
Rental 
	GetRental 
( 
) 
; 
} 
public 

class 
RentalBuilder 
:  
IRentalBuilder! /
{ 
private 
readonly 
Rental 
_rental  '
;' (
public 
RentalBuilder 
( 
) 
{ 	
_rental 
= 
new 
Rental  
(  !
)! "
;" #
} 	
public 
IRentalBuilder 
SetRentalId )
() *
int* -
rentalId. 6
)6 7
{ 	
_rental 
. 
rentalId 
= 
rentalId '
;' (
return 
this 
; 
} 	
public 
IRentalBuilder 
SetCustomerId +
(+ ,
int, /

customerId0 :
): ;
{   	
_rental!! 
.!! 

customerId!! 
=!!  

customerId!!! +
;!!+ ,
return"" 
this"" 
;"" 
}## 	
public%% 
IRentalBuilder%% 
SetTransactionDate%% 0
(%%0 1
DateTime%%1 9
date%%: >
)%%> ?
{&& 	
_rental'' 
.'' 
transactionDate'' #
=''$ %
date''& *
;''* +
return(( 
this(( 
;(( 
})) 	
public++ 
IRentalBuilder++ 
SetTotalFee++ )
(++) *
decimal++* 1
totalFee++2 :
)++: ;
{,, 	
_rental-- 
.-- 
totalFee-- 
=-- 
totalFee-- '
;--' (
return.. 
this.. 
;.. 
}// 	
public11 
IRentalBuilder11 
AddRentalItem11 +
(11+ ,

RentalItem11, 6

rentalItem117 A
)11A B
{22 	
_rental33 
.33 
rentalItems33 
??=33  #
new33$ '
List33( ,
<33, -

RentalItem33- 7
>337 8
(338 9
)339 :
;33: ;
_rental44 
.44 
rentalItems44 
.44  
Add44  #
(44# $

rentalItem44$ .
)44. /
;44/ 0
return55 
this55 
;55 
}66 	
public88 
Rental88 
Build88 
(88 
)88 
{99 	
ValidateRental:: 
(:: 
):: 
;:: 
return;; 
_rental;; 
;;; 
}<< 	
public>> 
Rental>> 
	GetRental>> 
(>>  
)>>  !
{?? 	
return@@ 
_rental@@ 
;@@ 
}AA 	
privateCC 
voidCC 
ValidateRentalCC #
(CC# $
)CC$ %
{DD 	
ifEE 
(EE 
_rentalEE 
.EE 
rentalIdEE  
<=EE! #
$numEE$ %
)EE% &
throwFF 
newFF 
ArgumentExceptionFF +
(FF+ ,
$strFF, R
)FFR S
;FFS T
ifHH 
(HH 
_rentalHH 
.HH 

customerIdHH "
<=HH# %
$numHH& '
)HH' (
throwII 
newII 
ArgumentExceptionII +
(II+ ,
$strII, T
)IIT U
;IIU V
ifKK 
(KK 
_rentalKK 
.KK 
transactionDateKK '
==KK( *
DateTimeKK+ 3
.KK3 4
MinValueKK4 <
)KK< =
throwLL 
newLL 
ArgumentExceptionLL +
(LL+ ,
$strLL, J
)LLJ K
;LLK L
ifNN 
(NN 
_rentalNN 
.NN 
totalFeeNN  
<=NN! #
$numNN$ %
)NN% &
throwOO 
newOO 
ArgumentExceptionOO +
(OO+ ,
$strOO, R
)OOR S
;OOS T
ifQQ 
(QQ 
_rentalQQ 
.QQ 
rentalItemsQQ #
==QQ$ &
nullQQ' +
||QQ, .
_rentalQQ/ 6
.QQ6 7
rentalItemsQQ7 B
.QQB C
CountQQC H
==QQI K
$numQQL M
)QQM N
throwRR 
newRR 
ArgumentExceptionRR +
(RR+ ,
$strRR, U
)RRU V
;RRV W
}SS 	
}TT 
}UU 