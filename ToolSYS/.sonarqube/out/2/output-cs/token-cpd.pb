‰"
VC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Strategies\ReportStrategy.cs
	namespace 	
ToolSYS
 
. 
Business 
. 

Strategies %
{ 
public 

	interface 
IReportStrategy $
{ 
string 
GetTitle 
( 
int 
year  
,  !
string" (
?( )
category* 2
=3 4
null5 9
)9 :
;: ;
( 	
string	 
[ 
] 
Labels 
, 
double  
[  !
]! "
Values# )
)) *
GetData+ 2
(2 3
int3 6
year7 ;
,; <
string= C
?C D
categoryE M
=N O
nullP T
)T U
;U V
bool		 
needsCategory		 
{		 
get		  
;		  !
}		" #
}

 
public 

class 
RevenueReport 
:  
IReportStrategy! 0
{ 
private 
readonly 
AnalysisService (
_analysisService) 9
;9 :
public 
RevenueReport 
( 
AnalysisService ,
analysisService- <
)< =
{ 	
_analysisService 
= 
analysisService .
;. /
} 	
public 
bool 
needsCategory !
=>" $
false% *
;* +
public 
string 
GetTitle 
( 
int "
year# '
,' (
string) /
?/ 0
category1 9
=: ;
null< @
)@ A
{ 	
return 
$" 
$str '
{' (
year( ,
}, -
"- .
;. /
} 	
public 
( 
string 
[ 
] 
Labels 
,  
double! '
[' (
]( )
Values* 0
)0 1
GetData2 9
(9 :
int: =
year> B
,B C
stringD J
?J K
categoryL T
=U V
nullW [
)[ \
{ 	
return 
_analysisService #
.# $
GetMonthlyRevenues$ 6
(6 7
year7 ;
); <
;< =
} 	
}   
public"" 

class"" 
ToolRentalReport"" !
:""" #
IReportStrategy""$ 3
{## 
private$$ 
readonly$$ 
AnalysisService$$ (
_analysisService$$) 9
;$$9 :
public&& 
ToolRentalReport&& 
(&&  
AnalysisService&&  /
analysisService&&0 ?
)&&? @
{'' 	
_analysisService(( 
=(( 
analysisService(( .
;((. /
})) 	
public++ 
bool++ 
needsCategory++ !
=>++" $
true++% )
;++) *
public-- 
string-- 
GetTitle-- 
(-- 
int-- "
year--# '
,--' (
string--) /
?--/ 0
category--1 9
)--9 :
{.. 	
return// 
$"// 
$str// %
{//% &
year//& *
}//* +
$str//+ 9
{//9 :
category//: B
}//B C
"//C D
;//D E
}00 	
public22 
(22 
string22 
[22 
]22 
Labels22 
,22  
double22! '
[22' (
]22( )
Values22* 0
)220 1
GetData222 9
(229 :
int22: =
year22> B
,22B C
string22D J
?22J K
category22L T
)22T U
{33 	
return44 
_analysisService44 #
.44# $!
GetMonthlyToolRentals44$ 9
(449 :
year44: >
,44> ?
categoryCode44@ L
:44L M
category44N V
)44V W
;44W X
}55 	
}66 
}77 ¾;
QC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Services\ToolService.cs
	namespace 	
ToolSYS
 
. 
Business 
. 
Services #
{ 
public 

	interface 
IToolService !
{ 
void		 
AddTool		 
(		 
Tool		 
tool		 
)		 
;		  
void

 

UpdateTool

 
(

 
Tool

 
tool

 !
)

! "
;

" #
void 

RemoveTool 
( 
int 
toolId "
)" #
;# $
DataSet 
GetFilteredTools  
(  !
string! '
toolIdAsString( 6
,6 7
string8 >
categoryCode? K
,K L
stringM S
descriptionT _
,_ `
stringa g
manufacturerh t
,t u
stringv |
status	} ƒ
,
ƒ „
string
… ‹
phrase
Œ ’
)
’ “
;
“ ”
DataSet 
GetAvailableTools !
(! "
)" #
;# $
DataSet 
GetRentableTools  
(  !
string! '
categoryCode( 4
,4 5
DateTime6 >
from? C
,C D
DateTimeE M
toN P
)P Q
;Q R
int 
GetNextToolId 
( 
) 
; 
} 
public 

class 
ToolService 
: 
IToolService +
{ 
private 
readonly 
	IToolData "
	_toolData# ,
;, -
public 
ToolService 
( 
	IToolData $
toolData% -
)- .
{ 	
	_toolData 
= 
toolData  
;  !
} 	
public 
void 
AddTool 
( 
Tool  
tool! %
)% &
{ 	
ValidateTool 
( 
tool 
, 
isUpdate '
:' (
false) .
). /
;/ 0
	_toolData 
. 
AddTool 
( 
tool "
)" #
;# $
}   	
public"" 
void"" 

UpdateTool"" 
("" 
Tool"" #
tool""$ (
)""( )
{## 	
ValidateTool$$ 
($$ 
tool$$ 
,$$ 
isUpdate$$ '
:$$' (
true$$) -
)$$- .
;$$. /
	_toolData%% 
.%% 

UpdateTool%%  
(%%  !
tool%%! %
)%%% &
;%%& '
}&& 	
public(( 
void(( 

RemoveTool(( 
((( 
int(( "
toolId((# )
)(() *
{)) 	
if** 
(** 
!** 
	_toolData** 
.** 

ToolExists** %
(**% &
toolId**& ,
)**, -
)**- .
throw++ 
new++ 
ArgumentException++ +
(+++ ,
$str++, >
)++> ?
;++? @
	_toolData-- 
.-- 

RemoveTool--  
(--  !
toolId--! '
)--' (
;--( )
}.. 	
public00 
DataSet00 
GetFilteredTools00 '
(00' (
string00( .
toolIdAsString00/ =
,00= >
string00? E
categoryCode00F R
,00R S
string00T Z
description00[ f
,00f g
string00h n
manufacturer00o {
,00{ |
string	00} ƒ
status
00„ Š
,
00Š ‹
string
00Œ ’
phrase
00“ ™
)
00™ š
{11 	
return22 
	_toolData22 
.22 
GetFilteredTools22 -
(22- .
toolIdAsString22. <
,22< =
categoryCode22> J
,22J K
description22L W
,22W X
manufacturer22Y e
,22e f
status22g m
,22m n
phrase22o u
)22u v
;22v w
}33 	
public55 
DataSet55 
GetAvailableTools55 (
(55( )
)55) *
{66 	
return77 
	_toolData77 
.77 
GetAvailableTools77 .
(77. /
)77/ 0
;770 1
}88 	
public:: 
DataSet:: 
GetRentableTools:: '
(::' (
string::( .
categoryCode::/ ;
,::; <
DateTime::= E
from::F J
,::J K
DateTime::L T
to::U W
)::W X
{;; 	
return<< 
	_toolData<< 
.<< 
GetRentableTools<< -
(<<- .
categoryCode<<. :
,<<: ;
from<<< @
,<<@ A
to<<B D
)<<D E
;<<E F
}== 	
public?? 
int?? 
GetNextToolId??  
(??  !
)??! "
{@@ 	
returnAA 
	_toolDataAA 
.AA 
GetNextToolIdAA *
(AA* +
)AA+ ,
;AA, -
}BB 	
privateDD 
voidDD 
ValidateToolDD !
(DD! "
ToolDD" &
toolDD' +
,DD+ ,
boolDD- 1
isUpdateDD2 :
)DD: ;
{EE 	
ifFF 
(FF 
stringFF 
.FF 
IsNullOrEmptyFF $
(FF$ %
toolFF% )
.FF) *
toolDescriptionFF* 9
)FF9 :
||FF; =
toolFF> B
.FFB C
toolDescriptionFFC R
.FFR S
LengthFFS Y
>FFZ [
$numFF\ ^
)FF^ _
throwGG 
newGG 
ArgumentExceptionGG +
(GG+ ,
$strGG, c
)GGc d
;GGd e
ifII 
(II 
stringII 
.II 
IsNullOrEmptyII $
(II$ %
toolII% )
.II) *
categoryCodeII* 6
)II6 7
)II7 8
throwJJ 
newJJ 
ArgumentExceptionJJ +
(JJ+ ,
$strJJ, H
)JJH I
;JJI J
ifLL 
(LL 
!LL 
toolLL 
.LL 
categoryCodeLL "
.LL" #
AllLL# &
(LL& '
charLL' +
.LL+ ,
IsLetterOrDigitLL, ;
)LL; <
)LL< =
throwMM 
newMM 
ArgumentExceptionMM +
(MM+ ,
$strMM, d
)MMd e
;MMe f
ifOO 
(OO 
stringOO 
.OO 
IsNullOrEmptyOO $
(OO$ %
toolOO% )
.OO) *
toolManufacturerOO* :
)OO: ;
||OO< >
toolOO? C
.OOC D
toolManufacturerOOD T
.OOT U
LengthOOU [
>OO\ ]
$numOO^ `
)OO` a
throwPP 
newPP 
ArgumentExceptionPP +
(PP+ ,
$strPP, d
)PPd e
;PPe f
ifRR 
(RR 
!RR 
isUpdateRR 
&&RR 
	_toolDataRR &
.RR& '

ToolExistsRR' 1
(RR1 2
toolRR2 6
.RR6 7
toolIdRR7 =
)RR= >
)RR> ?
throwSS 
newSS 
ArgumentExceptionSS +
(SS+ ,
$strSS, Q
)SSQ R
;SSR S
}TT 	
}UU 
}VV Å"
SC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Services\RentalService.cs
	namespace 	
ToolSYS
 
. 
Business 
. 
Services #
{ 
public 

class 
RentalService 
{ 
private		 
readonly		 
RentalItemData		 '
_rentalItemData		( 7
;		7 8
private

 
readonly

 
RateData

 !
	_rateData

" +
;

+ ,
public 
RentalService 
( 
) 
{ 	
_rentalItemData 
= 
new !
RentalItemData" 0
(0 1
)1 2
;2 3
	_rateData 
= 
new 
RateData $
($ %
)% &
;& '
} 	
public 
static 
int 
GetNextRentalId )
() *
)* +
{ 	
return 

RentalData 
. 
GetNextRentalId -
(- .
). /
;/ 0
} 	
public 
decimal 
CalculateRentalFee )
() *
int* -

customerId. 8
,8 9
string: @
categoryCodeA M
,M N
DateTimeO W
rentDateX `
,` a
DateTimeb j

returnDatek u
)u v
{ 	
if 
( 
rentDate 
> 

returnDate %
)% &
throw 
new 
ArgumentException +
(+ ,
$str, Y
)Y Z
;Z [
int 

daysRented 
= 
( 

returnDate (
-) *
rentDate+ 3
)3 4
.4 5
Days5 9
+: ;
$num< =
;= >
Rate 
rate 
= 
	_rateData !
.! "!
GetRateByCategoryCode" 7
(7 8
categoryCode8 D
)D E
;E F
decimal 
	dailyRate 
= 
rate  $
.$ %
rate% )
;) *
decimal 
fee 
= 
	dailyRate #
*$ %

daysRented& 0
;0 1
return!! 
fee!! 
;!! 
}"" 	
public$$ 
void$$ 
ConfirmRental$$ !
($$! "
Rental$$" (
rental$$) /
)$$/ 0
{%% 	

RentalData&& 
.&& 
	AddRental&&  
(&&  !
rental&&! '
)&&' (
;&&( )
foreach(( 
((( 
var(( 

rentalItem(( #
in(($ &
rental((' -
.((- .
rentalItems((. 9
)((9 :
{)) 
_rentalItemData** 
.**  
AddRentalItem**  -
(**- .

rentalItem**. 8
)**8 9
;**9 :
}++ 
},, 	
public.. 
static.. 
	DataTable.. 
GetRentalItems..  .
(... /
int../ 2
rentalId..3 ;
)..; <
{// 	
if00 
(00 
rentalId00 
<=00 
$num00 
)00 
throw11 
new11 
ArgumentException11 +
(11+ ,
$str11, @
)11@ A
;11A B
return33 

RentalData33 
.33 $
GetRentalItemsByRentalId33 6
(336 7
rentalId337 ?
)33? @
;33@ A
}44 	
public66 
static66 
void66 

ReturnTool66 %
(66% &
int66& )
rentalId66* 2
,662 3
int664 7
toolId668 >
)66> ?
{77 	
if88 
(88 
rentalId88 
<=88 
$num88 
||88  
toolId88! '
<=88( *
$num88+ ,
)88, -
throw99 
new99 
ArgumentException99 +
(99+ ,
$str99, Z
)99Z [
;99[ \

RentalData;; 
.;; 

ReturnTool;; !
(;;! "
rentalId;;" *
,;;* +
toolId;;, 2
);;2 3
;;;3 4
}<< 	
}?? 
}@@ ý#
QC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Services\RateService.cs
	namespace 	
ToolSYS
 
. 
Business 
. 
Services #
{ 
public 

class 
RateService 
{ 
private		 
readonly		 
RateData		 !
	_rateData		" +
;		+ ,
public 
RateService 
( 
) 
{ 	
	_rateData 
= 
new 
RateData $
($ %
)% &
;& '
} 	
public 
void 
AddRate 
( 
Rate  
rate! %
)% &
{ 	
ValidateRate 
( 
rate 
, 
isUpdate '
:' (
false) .
). /
;/ 0
	_rateData 
. 
AddRate 
( 
rate "
)" #
;# $
} 	
public 
void 

UpdateRate 
( 
Rate #
rate$ (
)( )
{ 	
ValidateRate 
( 
rate 
, 
isUpdate '
:' (
true) -
)- .
;. /
	_rateData 
. 

UpdateRate  
(  !
rate! %
)% &
;& '
} 	
public 
Rate !
GetRateByCategoryCode )
() *
string* 0
categoryCode1 =
)= >
{ 	
if 
( 
string 
. 
IsNullOrEmpty $
($ %
categoryCode% 1
)1 2
)2 3
throw 
new 
ArgumentException +
(+ ,
$str, H
)H I
;I J
return!! 
	_rateData!! 
.!! !
GetRateByCategoryCode!! 2
(!!2 3
categoryCode!!3 ?
)!!? @
;!!@ A
}"" 	
public$$ 
DataSet$$ 
GetAllCategories$$ '
($$' (
)$$( )
{%% 	
return&& 
	_rateData&& 
.&& 
GetAllCategories&& -
(&&- .
)&&. /
;&&/ 0
}'' 	
private)) 
void)) 
ValidateRate)) !
())! "
Rate))" &
rate))' +
,))+ ,
bool))- 1
isUpdate))2 :
))): ;
{** 	
if++ 
(++ 
string++ 
.++ 
IsNullOrEmpty++ $
(++$ %
rate++% )
.++) *
categoryCode++* 6
)++6 7
||++8 :
rate++; ?
.++? @
categoryCode++@ L
.++L M
Length++M S
!=++T V
$num++W X
)++X Y
throw,, 
new,, 
ArgumentException,, +
(,,+ ,
$str,,, ^
),,^ _
;,,_ `
if.. 
(.. 
string.. 
... 
IsNullOrEmpty.. $
(..$ %
rate..% )
...) *
categoryDesc..* 6
)..6 7
||..8 :
rate..; ?
...? @
categoryDesc..@ L
...L M
Length..M S
>..T U
$num..V X
)..X Y
throw// 
new// 
ArgumentException// +
(//+ ,
$str//, g
)//g h
;//h i
if11 
(11 
rate11 
.11 
rate11 
<=11 
$num11 
)11 
throw22 
new22 
ArgumentException22 +
(22+ ,
$str22, J
)22J K
;22K L
if44 
(44 
!44 
rate44 
.44 
categoryCode44 "
.44" #
All44# &
(44& '
char44' +
.44+ ,
IsLetter44, 4
)444 5
)445 6
throw55 
new55 
ArgumentException55 +
(55+ ,
$str55, Y
)55Y Z
;55Z [
if77 
(77 
!77 
isUpdate77 
&&77 
	_rateData77 &
.77& '!
DoesCategoryCodeExist77' <
(77< =
rate77= A
.77A B
categoryCode77B N
)77N O
)77O P
throw88 
new88 
ArgumentException88 +
(88+ ,
$str88, W
)88W X
;88X Y
}99 	
}:: 
};; ²3
UC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Services\CustomerService.cs
	namespace 	
ToolSYS
 
. 
Business 
. 
Services #
{ 
public 

class 
CustomerService  
{		 
private

 
readonly

 
CustomerData

 %
_customerData

& 3
;

3 4
public 
CustomerService 
( 
)  
{ 	
_customerData 
= 
new 
CustomerData  ,
(, -
)- .
;. /
} 	
public 
int 
GetNextCustomerId $
($ %
)% &
{ 	
return 
_customerData  
.  !
GetNextCustomerId! 2
(2 3
)3 4
;4 5
} 	
public 
void 
AddCustomer 
(  
Customer  (
customer) 1
)1 2
{ 	
ValidateCustomer 
( 
customer %
)% &
;& '
_customerData 
. 
AddCustomer %
(% &
customer& .
). /
;/ 0
} 	
public 
void 
UpdateCustomer "
(" #
Customer# +
customer, 4
)4 5
{ 	
ValidateCustomer 
( 
customer %
)% &
;& '
_customerData 
. 
UpdateCustomer (
(( )
customer) 1
)1 2
;2 3
}   	
public"" 
DataSet"" 
SearchCustomers"" &
(""& '
string""' -
searchPhrase"". :
)"": ;
{## 	
return$$ 
_customerData$$  
.$$  !
SearchCustomers$$! 0
($$0 1
searchPhrase$$1 =
)$$= >
;$$> ?
}%% 	
public'' 
DataSet''  
GetFilteredCustomers'' +
(''+ ,
string'', 2

customerId''3 =
,''= >
string''? E
forename''F N
,''N O
string''P V
surname''W ^
,''^ _
string''` f
email''g l
,''l m
string''n t
phone''u z
,''z {
string	''| ‚
eircode
''ƒ Š
,
''Š ‹
string
''Œ ’
phrase
''“ ™
)
''™ š
{(( 	
return)) 
_customerData))  
.))  ! 
GetFilteredCustomers))! 5
())5 6

customerId))6 @
,))@ A
forename))B J
,))J K
surname))L S
,))S T
email))U Z
,))Z [
phone))\ a
,))a b
eircode))c j
,))j k
phrase))l r
)))r s
;))s t
}** 	
private,, 
static,, 
void,, 
ValidateCustomer,, ,
(,,, -
Customer,,- 5
customer,,6 >
),,> ?
{-- 	
if.. 
(.. 
string.. 
... 
IsNullOrWhiteSpace.. )
(..) *
customer..* 2
...2 3
forename..3 ;
)..; <
||..= ?
customer..@ H
...H I
forename..I Q
...Q R
Length..R X
>..Y Z
$num..[ ]
)..] ^
throw// 
new// 
ArgumentException// +
(//+ ,
$str//, w
)//w x
;//x y
if00 
(00 
!00 
customer00 
.00 
forename00 "
.00" #
All00# &
(00& '
char00' +
.00+ ,
IsLetter00, 4
)004 5
)005 6
throw11 
new11 
ArgumentException11 +
(11+ ,
$str11, T
)11T U
;11U V
if33 
(33 
string33 
.33 
IsNullOrWhiteSpace33 )
(33) *
customer33* 2
.332 3
surname333 :
)33: ;
||33< >
customer33? G
.33G H
surname33H O
.33O P
Length33P V
>33W X
$num33Y [
)33[ \
throw44 
new44 
ArgumentException44 +
(44+ ,
$str44, v
)44v w
;44w x
if55 
(55 
!55 
customer55 
.55 
surname55 !
.55! "
All55" %
(55% &
char55& *
.55* +
IsLetter55+ 3
)553 4
)554 5
throw66 
new66 
ArgumentException66 +
(66+ ,
$str66, S
)66S T
;66T U
Regex88 

emailRegex88 
=88 
new88 "
Regex88# (
(88( )
$str88) S
)88S T
;88T U
if99 
(99 
!99 

emailRegex99 
.99 
IsMatch99 #
(99# $
customer99$ ,
.99, -
email99- 2
)992 3
)993 4
throw:: 
new:: 
ArgumentException:: +
(::+ ,
$str::, D
)::D E
;::E F
if<< 
(<< 
!<< 
customer<< 
.<< 
phone<< 
.<<  
All<<  #
(<<# $
char<<$ (
.<<( )
IsDigit<<) 0
)<<0 1
||<<2 4
customer<<5 =
.<<= >
phone<<> C
.<<C D
Length<<D J
<<<K L
$num<<M N
||<<O Q
customer<<R Z
.<<Z [
phone<<[ `
.<<` a
Length<<a g
><<h i
$num<<j l
)<<l m
throw== 
new== 
ArgumentException== +
(==+ ,
$str==, [
)==[ \
;==\ ]
Regex?? 
eircodeRegex?? 
=??  
new??! $
Regex??% *
(??* +
$str??+ i
,??i j
RegexOptions??k w
.??w x

IgnoreCase	??x ‚
)
??‚ ƒ
;
??ƒ „
if@@ 
(@@ 
!@@ 
eircodeRegex@@ 
.@@ 
IsMatch@@ %
(@@% &
customer@@& .
.@@. /
eircode@@/ 6
)@@6 7
)@@7 8
throwAA 
newAA 
ArgumentExceptionAA +
(AA+ ,
$strAA, >
)AA> ?
;AA? @
}BB 	
}CC 
}DD ù5
UC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Services\AnalysisService.cs
	namespace 	
ToolSYS
 
. 
Business 
. 
Services #
{ 
public 

class 
AnalysisService  
{ 
private 
readonly 
AnalysisData %
_analysisData& 3
;3 4
public

 
AnalysisService

 
(

 
)

  
{ 	
_analysisData 
= 
new 
AnalysisData  ,
(, -
)- .
;. /
} 	
public 
	DataTable 
GetDistinctYears )
() *
)* +
{ 	
return 
_analysisData  
.  !
GetDistinctYears! 1
(1 2
)2 3
;3 4
} 	
public 
( 
string 
[ 
] 
Months 
,  
double! '
[' (
]( )
Revenues* 2
)2 3
GetMonthlyRevenues4 F
(F G
intG J
yearK O
)O P
{ 	
	DataTable 
revenueTable "
=# $
_analysisData% 2
.2 3
GetMonthlyRevenues3 E
(E F
yearF J
)J K
;K L
string 
[ 
] 
months 
= 
new !
string" (
[( )
$num) +
]+ ,
;, -
double 
[ 
] 
revenues 
= 
new  #
double$ *
[* +
$num+ -
]- .
;. /
for 
( 
int 
i 
= 
$num 
; 
i 
< 
$num  "
;" #
i$ %
++% '
)' (
{ 
months 
[ 
i 
] 
= 
GetMonthName (
(( )
i) *
++ ,
$num- .
). /
;/ 0
revenues 
[ 
i 
] 
= 
$num 
;  
} 
foreach!! 
(!! 
DataRow!! 
row!!  
in!!! #
revenueTable!!$ 0
.!!0 1
Rows!!1 5
)!!5 6
{"" 
int## 

monthIndex## 
=##  
int##! $
.##$ %
Parse##% *
(##* +
row##+ .
[##. /
$str##/ 6
]##6 7
.##7 8
ToString##8 @
(##@ A
)##A B
)##B C
-##D E
$num##F G
;##G H
revenues$$ 
[$$ 

monthIndex$$ #
]$$# $
=$$% &
Convert$$' .
.$$. /
ToDouble$$/ 7
($$7 8
row$$8 ;
[$$; <
$str$$< E
]$$E F
)$$F G
;$$G H
}%% 
return'' 
('' 
months'' 
,'' 
revenues'' $
)''$ %
;''% &
}(( 	
public** 
(** 
string** 
[** 
]** 
Months** 
,**  
double**! '
[**' (
]**( )
Rentals*** 1
)**1 2!
GetMonthlyToolRentals**3 H
(**H I
int**I L
year**M Q
,**Q R
string**S Y
categoryCode**Z f
)**f g
{++ 	
	DataTable,, 
dt,, 
=,, 
_analysisData,, (
.,,( )'
GetMonthlyRentalsByCategory,,) D
(,,D E
year,,E I
,,,I J
categoryCode,,K W
),,W X
;,,X Y
string.. 
[.. 
].. 
months.. 
=.. 
new.. !
string.." (
[..( )
$num..) +
]..+ ,
;.., -
double// 
[// 
]// 
rentals// 
=// 
new// "
double//# )
[//) *
$num//* ,
]//, -
;//- .
for11 
(11 
int11 
i11 
=11 
$num11 
;11 
i11 
<11 
$num11  "
;11" #
i11$ %
++11% '
)11' (
{22 
months33 
[33 
i33 
]33 
=33 
GetMonthName33 (
(33( )
i33) *
+33+ ,
$num33- .
)33. /
;33/ 0
rentals44 
[44 
i44 
]44 
=44 
$num44 
;44 
}55 
foreach77 
(77 
DataRow77 
row77  
in77! #
dt77$ &
.77& '
Rows77' +
)77+ ,
{88 
int99 

monthIndex99 
=99  
int99! $
.99$ %
Parse99% *
(99* +
row99+ .
[99. /
$str99/ 6
]996 7
.997 8
ToString998 @
(99@ A
)99A B
.99B C
	Substring99C L
(99L M
$num99M N
,99N O
$num99P Q
)99Q R
)99R S
-99T U
$num99V W
;99W X
rentals:: 
[:: 

monthIndex:: "
]::" #
=::$ %
Convert::& -
.::- .
ToDouble::. 6
(::6 7
row::7 :
[::: ;
$str::; G
]::G H
)::H I
;::I J
};; 
return== 
(== 
months== 
,== 
rentals== #
)==# $
;==$ %
}>> 	
private@@ 
static@@ 
string@@ 
GetMonthName@@ *
(@@* +
int@@+ .
month@@/ 4
)@@4 5
{AA 	
stringBB 
[BB 
]BB 

monthNamesBB 
=BB  !
{BB" #
$strBB$ -
,BB- .
$strBB/ 9
,BB9 :
$strBB; B
,BBB C
$strBBD K
,BBK L
$strBBM R
,BBR S
$strBBT Z
,BBZ [
$strBB\ b
,BBb c
$strBBd l
,BBl m
$strBBn y
,BBy z
$str	BB{ „
,
BB„ …
$str
BB† 
,
BB ‘
$str
BB’ œ
}
BB ž
;
BBž Ÿ
returnCC 
monthCC 
>=CC 
$numCC 
&&CC  
monthCC! &
<=CC' )
$numCC* ,
?CC- .

monthNamesCC/ 9
[CC9 :
monthCC: ?
-CC@ A
$numCCB C
]CCC D
:CCE F
$strCCG P
;CCP Q
}DD 	
}EE 
}FF ì+
SC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Builders\RentalBuilder.cs
	namespace 	
ToolSYS
 
. 
Business 
. 
Builders #
{ 
public 

	interface 
IRentalBuilder #
{ 
IRentalBuilder 
SetRentalId "
(" #
int# &
rentalId' /
)/ 0
;0 1
IRentalBuilder 
SetCustomerId $
($ %
int% (

customerId) 3
)3 4
;4 5
IRentalBuilder		 
SetTransactionDate		 )
(		) *
DateTime		* 2
date		3 7
)		7 8
;		8 9
IRentalBuilder

 
SetTotalFee

 "
(

" #
decimal

# *
totalFee

+ 3
)

3 4
;

4 5
IRentalBuilder 
AddRentalItem $
($ %

RentalItem% /

rentalItem0 :
): ;
;; <
Rental 
Build 
( 
) 
; 
} 
public 

class 
RentalBuilder 
:  
IRentalBuilder! /
{ 
private 
readonly 
Rental 
_rental  '
;' (
public 
RentalBuilder 
( 
) 
{ 	
_rental 
= 
new 
Rental  
(  !
)! "
;" #
} 	
public 
IRentalBuilder 
SetRentalId )
() *
int* -
rentalId. 6
)6 7
{ 	
_rental 
. 
rentalId 
= 
rentalId '
;' (
return 
this 
; 
} 	
public 
IRentalBuilder 
SetCustomerId +
(+ ,
int, /

customerId0 :
): ;
{   	
_rental!! 
.!! 

customerId!! 
=!!  

customerId!!! +
;!!+ ,
return"" 
this"" 
;"" 
}## 	
public%% 
IRentalBuilder%% 
SetTransactionDate%% 0
(%%0 1
DateTime%%1 9
date%%: >
)%%> ?
{&& 	
_rental'' 
.'' 
transactionDate'' #
=''$ %
date''& *
;''* +
return(( 
this(( 
;(( 
})) 	
public++ 
IRentalBuilder++ 
SetTotalFee++ )
(++) *
decimal++* 1
totalFee++2 :
)++: ;
{,, 	
_rental-- 
.-- 
totalFee-- 
=-- 
totalFee-- '
;--' (
return.. 
this.. 
;.. 
}// 	
public11 
IRentalBuilder11 
AddRentalItem11 +
(11+ ,

RentalItem11, 6

rentalItem117 A
)11A B
{22 	
if33 
(33 
_rental33 
.33 
rentalItems33 #
==33$ &
null33' +
)33+ ,
_rental44 
.44 
rentalItems44 #
=44$ %
new44& )
List44* .
<44. /

RentalItem44/ 9
>449 :
(44: ;
)44; <
;44< =
_rental66 
.66 
rentalItems66 
.66  
Add66  #
(66# $

rentalItem66$ .
)66. /
;66/ 0
return77 
this77 
;77 
}88 	
public:: 
Rental:: 
Build:: 
(:: 
):: 
{;; 	
ValidateRental<< 
(<< 
)<< 
;<< 
return== 
_rental== 
;== 
}>> 	
private@@ 
void@@ 
ValidateRental@@ #
(@@# $
)@@$ %
{AA 	
ifBB 
(BB 
_rentalBB 
.BB 
rentalIdBB  
<=BB! #
$numBB$ %
)BB% &
throwCC 
newCC 
ArgumentExceptionCC +
(CC+ ,
$strCC, R
)CCR S
;CCS T
ifEE 
(EE 
_rentalEE 
.EE 

customerIdEE "
<=EE# %
$numEE& '
)EE' (
throwFF 
newFF 
ArgumentExceptionFF +
(FF+ ,
$strFF, T
)FFT U
;FFU V
ifHH 
(HH 
_rentalHH 
.HH 
transactionDateHH '
==HH( *
DateTimeHH+ 3
.HH3 4
MinValueHH4 <
)HH< =
throwII 
newII 
ArgumentExceptionII +
(II+ ,
$strII, J
)IIJ K
;IIK L
ifKK 
(KK 
_rentalKK 
.KK 
totalFeeKK  
<=KK! #
$numKK$ %
)KK% &
throwLL 
newLL 
ArgumentExceptionLL +
(LL+ ,
$strLL, R
)LLR S
;LLS T
ifNN 
(NN 
_rentalNN 
.NN 
rentalItemsNN #
==NN$ &
nullNN' +
||NN, .
_rentalNN/ 6
.NN6 7
rentalItemsNN7 B
.NNB C
CountNNC H
==NNI K
$numNNL M
)NNM N
throwOO 
newOO 
ArgumentExceptionOO +
(OO+ ,
$strOO, U
)OOU V
;OOV W
}PP 	
}QQ 
}RR 