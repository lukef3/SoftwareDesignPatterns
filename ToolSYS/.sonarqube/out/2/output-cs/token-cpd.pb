†!
VC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Strategies\ReportStrategy.cs
	namespace 	
ToolSYS
 
. 
Business 
. 

Strategies %
{ 
public 

	interface 
IReportStrategy $
{ 
string 
GetTitle 
( 
int 
year  
,  !
string" (
category) 1
=2 3
null4 8
)8 9
;9 :
( 	
string	 
[ 
] 
Labels 
, 
double  
[  !
]! "
Values# )
)) *
GetData+ 2
(2 3
int3 6
year7 ;
,; <
string= C
categoryD L
=M N
nullO S
)S T
;T U
bool		 
NeedsCategory		 
{		 
get		  
;		  !
}		" #
}

 
public 

class 
RevenueReport 
:  
IReportStrategy! 0
{ 
private 
readonly 
AnalysisService (
_analysisService) 9
;9 :
public 
RevenueReport 
( 
AnalysisService ,
analysisService- <
)< =
{ 	
_analysisService 
= 
analysisService .
;. /
} 	
public 
bool 
NeedsCategory !
=>" $
false% *
;* +
public 
string 
GetTitle 
( 
int "
year# '
,' (
string) /
category0 8
=9 :
null; ?
)? @
{ 	
return 
$" 
$str '
{' (
year( ,
}, -
"- .
;. /
} 	
public 
( 
string 
[ 
] 
Labels 
,  
double! '
[' (
]( )
Values* 0
)0 1
GetData2 9
(9 :
int: =
year> B
,B C
stringD J
categoryK S
=T U
nullV Z
)Z [
{ 	
return 
_analysisService #
.# $
GetMonthlyRevenues$ 6
(6 7
year7 ;
); <
;< =
} 	
}   
public"" 

class"" 
ToolRentalReport"" !
:""" #
IReportStrategy""$ 3
{## 
private$$ 
readonly$$ 
AnalysisService$$ (
_analysisService$$) 9
;$$9 :
public&& 
ToolRentalReport&& 
(&&  
AnalysisService&&  /
analysisService&&0 ?
)&&? @
{'' 	
_analysisService(( 
=(( 
analysisService(( .
;((. /
})) 	
public++ 
bool++ 
NeedsCategory++ !
=>++" $
true++% )
;++) *
public-- 
string-- 
GetTitle-- 
(-- 
int-- "
year--# '
,--' (
string--) /
category--0 8
)--8 9
{.. 	
return// 
$"// 
$str// %
{//% &
year//& *
}//* +
$str//+ 9
{//9 :
category//: B
}//B C
"//C D
;//D E
}00 	
public22 
(22 
string22 
[22 
]22 
Labels22 
,22  
double22! '
[22' (
]22( )
Values22* 0
)220 1
GetData222 9
(229 :
int22: =
year22> B
,22B C
string22D J
category22K S
)22S T
{33 	
return44 
_analysisService44 #
.44# $!
GetMonthlyToolRentals44$ 9
(449 :
year44: >
,44> ?
category44@ H
)44H I
;44I J
}55 	
}66 
}77 ¾;
QC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Services\ToolService.cs
	namespace 	
ToolSYS
 
. 
Business 
. 
Services #
{ 
public 

	interface 
IToolService !
{		 
void

 
AddTool

 
(

 
Tool

 
tool

 
)

 
;

  
void 

UpdateTool 
( 
Tool 
tool !
)! "
;" #
void 

RemoveTool 
( 
int 
toolID "
)" #
;# $
DataSet 
GetFilteredTools  
(  !
string! '
toolIDAsString( 6
,6 7
string8 >
categoryCode? K
,K L
stringM S
descriptionT _
,_ `
stringa g
manufacturerh t
,t u
stringv |
status	} ƒ
,
ƒ „
string
… ‹
phrase
Œ ’
)
’ “
;
“ ”
DataSet 
GetAvailableTools !
(! "
)" #
;# $
DataSet 
GetRentableTools  
(  !
string! '
categoryCode( 4
,4 5
DateTime6 >
from? C
,C D
DateTimeE M
toN P
)P Q
;Q R
int 
GetNextToolID 
( 
) 
; 
} 
public 

class 
ToolService 
: 
IToolService +
{ 
private 
readonly 
	IToolData "
	_toolData# ,
;, -
public 
ToolService 
( 
	IToolData $
toolData% -
)- .
{ 	
	_toolData 
= 
toolData  
;  !
} 	
public 
void 
AddTool 
( 
Tool  
tool! %
)% &
{ 	
ValidateTool 
( 
tool 
, 
isUpdate '
:' (
false) .
). /
;/ 0
	_toolData   
.   
AddTool   
(   
tool   "
)  " #
;  # $
}!! 	
public## 
void## 

UpdateTool## 
(## 
Tool## #
tool##$ (
)##( )
{$$ 	
ValidateTool%% 
(%% 
tool%% 
,%% 
isUpdate%% '
:%%' (
true%%) -
)%%- .
;%%. /
	_toolData&& 
.&& 

UpdateTool&&  
(&&  !
tool&&! %
)&&% &
;&&& '
}'' 	
public)) 
void)) 

RemoveTool)) 
()) 
int)) "
toolID))# )
)))) *
{** 	
if++ 
(++ 
!++ 
	_toolData++ 
.++ 

ToolExists++ %
(++% &
toolID++& ,
)++, -
)++- .
throw,, 
new,, 
ArgumentException,, +
(,,+ ,
$str,,, >
),,> ?
;,,? @
	_toolData.. 
... 

RemoveTool..  
(..  !
toolID..! '
)..' (
;..( )
}// 	
public11 
DataSet11 
GetFilteredTools11 '
(11' (
string11( .
toolIDAsString11/ =
,11= >
string11? E
categoryCode11F R
,11R S
string11T Z
description11[ f
,11f g
string11h n
manufacturer11o {
,11{ |
string	11} ƒ
status
11„ Š
,
11Š ‹
string
11Œ ’
phrase
11“ ™
)
11™ š
{22 	
return33 
	_toolData33 
.33 
GetFilteredTools33 -
(33- .
toolIDAsString33. <
,33< =
categoryCode33> J
,33J K
description33L W
,33W X
manufacturer33Y e
,33e f
status33g m
,33m n
phrase33o u
)33u v
;33v w
}44 	
public66 
DataSet66 
GetAvailableTools66 (
(66( )
)66) *
{77 	
return88 
	_toolData88 
.88 
GetAvailableTools88 .
(88. /
)88/ 0
;880 1
}99 	
public;; 
DataSet;; 
GetRentableTools;; '
(;;' (
string;;( .
categoryCode;;/ ;
,;;; <
DateTime;;= E
from;;F J
,;;J K
DateTime;;L T
to;;U W
);;W X
{<< 	
return== 
	_toolData== 
.== 
GetRentableTools== -
(==- .
categoryCode==. :
,==: ;
from==< @
,==@ A
to==B D
)==D E
;==E F
}>> 	
public@@ 
int@@ 
GetNextToolID@@  
(@@  !
)@@! "
{AA 	
returnBB 
	_toolDataBB 
.BB 
GetNextToolIDBB *
(BB* +
)BB+ ,
;BB, -
}CC 	
privateEE 
voidEE 
ValidateToolEE !
(EE! "
ToolEE" &
toolEE' +
,EE+ ,
boolEE- 1
isUpdateEE2 :
)EE: ;
{FF 	
ifGG 
(GG 
stringGG 
.GG 
IsNullOrEmptyGG $
(GG$ %
toolGG% )
.GG) *
toolDescriptionGG* 9
)GG9 :
||GG; =
toolGG> B
.GGB C
toolDescriptionGGC R
.GGR S
LengthGGS Y
>GGZ [
$numGG\ ^
)GG^ _
throwHH 
newHH 
ArgumentExceptionHH +
(HH+ ,
$strHH, c
)HHc d
;HHd e
ifJJ 
(JJ 
stringJJ 
.JJ 
IsNullOrEmptyJJ $
(JJ$ %
toolJJ% )
.JJ) *
categoryCodeJJ* 6
)JJ6 7
)JJ7 8
throwKK 
newKK 
ArgumentExceptionKK +
(KK+ ,
$strKK, H
)KKH I
;KKI J
ifMM 
(MM 
!MM 
toolMM 
.MM 
categoryCodeMM "
.MM" #
AllMM# &
(MM& '
charMM' +
.MM+ ,
IsLetterOrDigitMM, ;
)MM; <
)MM< =
throwNN 
newNN 
ArgumentExceptionNN +
(NN+ ,
$strNN, d
)NNd e
;NNe f
ifPP 
(PP 
stringPP 
.PP 
IsNullOrEmptyPP $
(PP$ %
toolPP% )
.PP) *
toolManufacturerPP* :
)PP: ;
||PP< >
toolPP? C
.PPC D
toolManufacturerPPD T
.PPT U
LengthPPU [
>PP\ ]
$numPP^ `
)PP` a
throwQQ 
newQQ 
ArgumentExceptionQQ +
(QQ+ ,
$strQQ, d
)QQd e
;QQe f
ifSS 
(SS 
!SS 
isUpdateSS 
&&SS 
	_toolDataSS &
.SS& '

ToolExistsSS' 1
(SS1 2
toolSS2 6
.SS6 7
toolIDSS7 =
)SS= >
)SS> ?
throwTT 
newTT 
ArgumentExceptionTT +
(TT+ ,
$strTT, Q
)TTQ R
;TTR S
}UU 	
}VV 
}WW Â$
SC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Services\RentalService.cs
	namespace 	
ToolSYS
 
. 
Business 
. 
Services #
{		 
public

 

class

 
RentalService

 
{ 
private 
readonly 
RentalItemData '
_rentalItemData( 7
;7 8
private 
readonly 
RateData !
	_rateData" +
;+ ,
private 
readonly 
CustomerService (
_customerService) 9
;9 :
public 
RentalService 
( 
) 
{ 	
_rentalItemData 
= 
new !
RentalItemData" 0
(0 1
)1 2
;2 3
	_rateData 
= 
new 
RateData $
($ %
)% &
;& '
_customerService 
= 
new "
CustomerService# 2
(2 3
)3 4
;4 5
} 	
public 
static 
int 
GetNextRentalID )
() *
)* +
{ 	
return 

RentalData 
. 
GetNextRentalID -
(- .
). /
;/ 0
} 	
public 
decimal 
CalculateRentalFee )
() *
int* -

customerID. 8
,8 9
string: @
categoryCodeA M
,M N
DateTimeO W
rentDateX `
,` a
DateTimeb j

returnDatek u
)u v
{ 	
if 
( 
rentDate 
> 

returnDate %
)% &
throw 
new 
ArgumentException +
(+ ,
$str, Y
)Y Z
;Z [
int!! 

daysRented!! 
=!! 
(!! 

returnDate!! (
-!!) *
rentDate!!+ 3
)!!3 4
.!!4 5
Days!!5 9
+!!: ;
$num!!< =
;!!= >
Rate"" 
rate"" 
="" 
	_rateData"" !
.""! "!
GetRateByCategoryCode""" 7
(""7 8
categoryCode""8 D
)""D E
;""E F
decimal## 
	dailyRate## 
=## 
rate##  $
.##$ %
rate##% )
;##) *
decimal$$ 
fee$$ 
=$$ 
	dailyRate$$ #
*$$$ %

daysRented$$& 0
;$$0 1
return&& 
fee&& 
;&& 
}'' 	
public)) 
void)) 
ConfirmRental)) !
())! "
Rental))" (
rental))) /
)))/ 0
{** 	

RentalData++ 
.++ 
	AddRental++  
(++  !
rental++! '
)++' (
;++( )
foreach-- 
(-- 
var-- 

rentalItem-- #
in--$ &
rental--' -
.--- .
RentalItems--. 9
)--9 :
{.. 
_rentalItemData// 
.//  
AddRentalItem//  -
(//- .

rentalItem//. 8
)//8 9
;//9 :
}00 
}11 	
public33 
static33 
	DataTable33 
GetRentalItems33  .
(33. /
int33/ 2
rentalID333 ;
)33; <
{44 	
if55 
(55 
rentalID55 
<=55 
$num55 
)55 
throw66 
new66 
ArgumentException66 +
(66+ ,
$str66, @
)66@ A
;66A B
return88 

RentalData88 
.88 $
GetRentalItemsByRentalID88 6
(886 7
rentalID887 ?
)88? @
;88@ A
}99 	
public;; 
static;; 
void;; 

ReturnTool;; %
(;;% &
int;;& )
rentalID;;* 2
,;;2 3
int;;4 7
toolID;;8 >
);;> ?
{<< 	
if== 
(== 
rentalID== 
<=== 
$num== 
||==  
toolID==! '
<===( *
$num==+ ,
)==, -
throw>> 
new>> 
ArgumentException>> +
(>>+ ,
$str>>, Z
)>>Z [
;>>[ \

RentalData@@ 
.@@ 

ReturnTool@@ !
(@@! "
rentalID@@" *
,@@* +
toolID@@, 2
)@@2 3
;@@3 4
}AA 	
}DD 
}EE ý#
QC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Services\RateService.cs
	namespace 	
ToolSYS
 
. 
Business 
. 
Services #
{ 
public 

class 
RateService 
{		 
private

 
readonly

 
RateData

 !
	_rateData

" +
;

+ ,
public 
RateService 
( 
) 
{ 	
	_rateData 
= 
new 
RateData $
($ %
)% &
;& '
} 	
public 
void 
AddRate 
( 
Rate  
rate! %
)% &
{ 	
ValidateRate 
( 
rate 
, 
isUpdate '
:' (
false) .
). /
;/ 0
	_rateData 
. 
AddRate 
( 
rate "
)" #
;# $
} 	
public 
void 

UpdateRate 
( 
Rate #
rate$ (
)( )
{ 	
ValidateRate 
( 
rate 
, 
isUpdate '
:' (
true) -
)- .
;. /
	_rateData 
. 

UpdateRate  
(  !
rate! %
)% &
;& '
} 	
public 
Rate !
GetRateByCategoryCode )
() *
string* 0
categoryCode1 =
)= >
{ 	
if 
( 
string 
. 
IsNullOrEmpty $
($ %
categoryCode% 1
)1 2
)2 3
throw   
new   
ArgumentException   +
(  + ,
$str  , H
)  H I
;  I J
return"" 
	_rateData"" 
."" !
GetRateByCategoryCode"" 2
(""2 3
categoryCode""3 ?
)""? @
;""@ A
}## 	
public%% 
DataSet%% 
GetAllCategories%% '
(%%' (
)%%( )
{&& 	
return'' 
	_rateData'' 
.'' 
GetAllCategories'' -
(''- .
)''. /
;''/ 0
}(( 	
private** 
void** 
ValidateRate** !
(**! "
Rate**" &
rate**' +
,**+ ,
bool**- 1
isUpdate**2 :
)**: ;
{++ 	
if,, 
(,, 
string,, 
.,, 
IsNullOrEmpty,, $
(,,$ %
rate,,% )
.,,) *
categoryCode,,* 6
),,6 7
||,,8 :
rate,,; ?
.,,? @
categoryCode,,@ L
.,,L M
Length,,M S
!=,,T V
$num,,W X
),,X Y
throw-- 
new-- 
ArgumentException-- +
(--+ ,
$str--, ^
)--^ _
;--_ `
if// 
(// 
string// 
.// 
IsNullOrEmpty// $
(//$ %
rate//% )
.//) *
categoryDesc//* 6
)//6 7
||//8 :
rate//; ?
.//? @
categoryDesc//@ L
.//L M
Length//M S
>//T U
$num//V X
)//X Y
throw00 
new00 
ArgumentException00 +
(00+ ,
$str00, g
)00g h
;00h i
if22 
(22 
rate22 
.22 
rate22 
<=22 
$num22 
)22 
throw33 
new33 
ArgumentException33 +
(33+ ,
$str33, J
)33J K
;33K L
if55 
(55 
!55 
rate55 
.55 
categoryCode55 "
.55" #
All55# &
(55& '
char55' +
.55+ ,
IsLetter55, 4
)554 5
)555 6
throw66 
new66 
ArgumentException66 +
(66+ ,
$str66, Y
)66Y Z
;66Z [
if88 
(88 
!88 
isUpdate88 
&&88 
	_rateData88 &
.88& '!
DoesCategoryCodeExist88' <
(88< =
rate88= A
.88A B
categoryCode88B N
)88N O
)88O P
throw99 
new99 
ArgumentException99 +
(99+ ,
$str99, W
)99W X
;99X Y
}:: 	
};; 
}<< ²3
UC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Services\CustomerService.cs
	namespace 	
ToolSYS
 
. 
Business 
. 
Services #
{ 
public 

class 
CustomerService  
{ 
private 
readonly 
CustomerData %
_customerData& 3
;3 4
public 
CustomerService 
( 
)  
{ 	
_customerData 
= 
new 
CustomerData  ,
(, -
)- .
;. /
} 	
public 
int 
GetNextCustomerID $
($ %
)% &
{ 	
return 
_customerData  
.  !
GetNextCustomerID! 2
(2 3
)3 4
;4 5
} 	
public 
void 
AddCustomer 
(  
Customer  (
customer) 1
)1 2
{ 	
ValidateCustomer 
( 
customer %
)% &
;& '
_customerData 
. 
AddCustomer %
(% &
customer& .
). /
;/ 0
} 	
public!! 
void!! 
UpdateCustomer!! "
(!!" #
Customer!!# +
customer!!, 4
)!!4 5
{"" 	
ValidateCustomer## 
(## 
customer## %
)##% &
;##& '
_customerData$$ 
.$$ 
UpdateCustomer$$ (
($$( )
customer$$) 1
)$$1 2
;$$2 3
}%% 	
public'' 
DataSet'' 
SearchCustomers'' &
(''& '
string''' -
searchPhrase''. :
)'': ;
{(( 	
return)) 
_customerData))  
.))  !
SearchCustomers))! 0
())0 1
searchPhrase))1 =
)))= >
;))> ?
}** 	
public,, 
DataSet,,  
GetFilteredCustomers,, +
(,,+ ,
string,,, 2

customerID,,3 =
,,,= >
string,,? E
forename,,F N
,,,N O
string,,P V
surname,,W ^
,,,^ _
string,,` f
email,,g l
,,,l m
string,,n t
phone,,u z
,,,z {
string	,,| ‚
eircode
,,ƒ Š
,
,,Š ‹
string
,,Œ ’
phrase
,,“ ™
)
,,™ š
{-- 	
return.. 
_customerData..  
...  ! 
GetFilteredCustomers..! 5
(..5 6

customerID..6 @
,..@ A
forename..B J
,..J K
surname..L S
,..S T
email..U Z
,..Z [
phone..\ a
,..a b
eircode..c j
,..j k
phrase..l r
)..r s
;..s t
}// 	
private11 
static11 
void11 
ValidateCustomer11 ,
(11, -
Customer11- 5
customer116 >
)11> ?
{22 	
if33 
(33 
string33 
.33 
IsNullOrWhiteSpace33 )
(33) *
customer33* 2
.332 3
forename333 ;
)33; <
||33= ?
customer33@ H
.33H I
forename33I Q
.33Q R
Length33R X
>33Y Z
$num33[ ]
)33] ^
throw44 
new44 
ArgumentException44 +
(44+ ,
$str44, w
)44w x
;44x y
if55 
(55 
!55 
customer55 
.55 
forename55 "
.55" #
All55# &
(55& '
char55' +
.55+ ,
IsLetter55, 4
)554 5
)555 6
throw66 
new66 
ArgumentException66 +
(66+ ,
$str66, T
)66T U
;66U V
if88 
(88 
string88 
.88 
IsNullOrWhiteSpace88 )
(88) *
customer88* 2
.882 3
surname883 :
)88: ;
||88< >
customer88? G
.88G H
surname88H O
.88O P
Length88P V
>88W X
$num88Y [
)88[ \
throw99 
new99 
ArgumentException99 +
(99+ ,
$str99, v
)99v w
;99w x
if:: 
(:: 
!:: 
customer:: 
.:: 
surname:: !
.::! "
All::" %
(::% &
char::& *
.::* +
IsLetter::+ 3
)::3 4
)::4 5
throw;; 
new;; 
ArgumentException;; +
(;;+ ,
$str;;, S
);;S T
;;;T U
Regex== 

emailRegex== 
=== 
new== "
Regex==# (
(==( )
$str==) S
)==S T
;==T U
if>> 
(>> 
!>> 

emailRegex>> 
.>> 
IsMatch>> #
(>># $
customer>>$ ,
.>>, -
email>>- 2
)>>2 3
)>>3 4
throw?? 
new?? 
ArgumentException?? +
(??+ ,
$str??, D
)??D E
;??E F
ifAA 
(AA 
!AA 
customerAA 
.AA 
phoneAA 
.AA  
AllAA  #
(AA# $
charAA$ (
.AA( )
IsDigitAA) 0
)AA0 1
||AA2 4
customerAA5 =
.AA= >
phoneAA> C
.AAC D
LengthAAD J
<AAK L
$numAAM N
||AAO Q
customerAAR Z
.AAZ [
phoneAA[ `
.AA` a
LengthAAa g
>AAh i
$numAAj l
)AAl m
throwBB 
newBB 
ArgumentExceptionBB +
(BB+ ,
$strBB, [
)BB[ \
;BB\ ]
RegexDD 
eircodeRegexDD 
=DD  
newDD! $
RegexDD% *
(DD* +
$strDD+ i
,DDi j
RegexOptionsDDk w
.DDw x

IgnoreCase	DDx ‚
)
DD‚ ƒ
;
DDƒ „
ifEE 
(EE 
!EE 
eircodeRegexEE 
.EE 
IsMatchEE %
(EE% &
customerEE& .
.EE. /
eircodeEE/ 6
)EE6 7
)EE7 8
throwFF 
newFF 
ArgumentExceptionFF +
(FF+ ,
$strFF, >
)FF> ?
;FF? @
}GG 	
}HH 
}II ù5
UC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Services\AnalysisService.cs
	namespace 	
ToolSYS
 
. 
Business 
. 
Services #
{ 
public 

class 
AnalysisService  
{ 
private		 
readonly		 
AnalysisData		 %
_analysisData		& 3
;		3 4
public 
AnalysisService 
( 
)  
{ 	
_analysisData 
= 
new 
AnalysisData  ,
(, -
)- .
;. /
} 	
public 
	DataTable 
GetDistinctYears )
() *
)* +
{ 	
return 
_analysisData  
.  !
GetDistinctYears! 1
(1 2
)2 3
;3 4
} 	
public 
( 
string 
[ 
] 
Months 
,  
double! '
[' (
]( )
Revenues* 2
)2 3
GetMonthlyRevenues4 F
(F G
intG J
yearK O
)O P
{ 	
	DataTable 
revenueTable "
=# $
_analysisData% 2
.2 3
GetMonthlyRevenues3 E
(E F
yearF J
)J K
;K L
string 
[ 
] 
months 
= 
new !
string" (
[( )
$num) +
]+ ,
;, -
double 
[ 
] 
revenues 
= 
new  #
double$ *
[* +
$num+ -
]- .
;. /
for 
( 
int 
i 
= 
$num 
; 
i 
< 
$num  "
;" #
i$ %
++% '
)' (
{ 
months 
[ 
i 
] 
= 
GetMonthName (
(( )
i) *
++ ,
$num- .
). /
;/ 0
revenues 
[ 
i 
] 
= 
$num 
;  
}   
foreach"" 
("" 
DataRow"" 
row""  
in""! #
revenueTable""$ 0
.""0 1
Rows""1 5
)""5 6
{## 
int$$ 

monthIndex$$ 
=$$  
int$$! $
.$$$ %
Parse$$% *
($$* +
row$$+ .
[$$. /
$str$$/ 6
]$$6 7
.$$7 8
ToString$$8 @
($$@ A
)$$A B
)$$B C
-$$D E
$num$$F G
;$$G H
revenues%% 
[%% 

monthIndex%% #
]%%# $
=%%% &
Convert%%' .
.%%. /
ToDouble%%/ 7
(%%7 8
row%%8 ;
[%%; <
$str%%< E
]%%E F
)%%F G
;%%G H
}&& 
return(( 
((( 
months(( 
,(( 
revenues(( $
)(($ %
;((% &
})) 	
public++ 
(++ 
string++ 
[++ 
]++ 
Months++ 
,++  
double++! '
[++' (
]++( )
Rentals++* 1
)++1 2!
GetMonthlyToolRentals++3 H
(++H I
int++I L
year++M Q
,++Q R
string++S Y
categoryCode++Z f
)++f g
{,, 	
	DataTable-- 
dt-- 
=-- 
_analysisData-- (
.--( )'
GetMonthlyRentalsByCategory--) D
(--D E
year--E I
,--I J
categoryCode--K W
)--W X
;--X Y
string// 
[// 
]// 
months// 
=// 
new// !
string//" (
[//( )
$num//) +
]//+ ,
;//, -
double00 
[00 
]00 
rentals00 
=00 
new00 "
double00# )
[00) *
$num00* ,
]00, -
;00- .
for22 
(22 
int22 
i22 
=22 
$num22 
;22 
i22 
<22 
$num22  "
;22" #
i22$ %
++22% '
)22' (
{33 
months44 
[44 
i44 
]44 
=44 
GetMonthName44 (
(44( )
i44) *
+44+ ,
$num44- .
)44. /
;44/ 0
rentals55 
[55 
i55 
]55 
=55 
$num55 
;55 
}66 
foreach88 
(88 
DataRow88 
row88  
in88! #
dt88$ &
.88& '
Rows88' +
)88+ ,
{99 
int:: 

monthIndex:: 
=::  
int::! $
.::$ %
Parse::% *
(::* +
row::+ .
[::. /
$str::/ 6
]::6 7
.::7 8
ToString::8 @
(::@ A
)::A B
.::B C
	Substring::C L
(::L M
$num::M N
,::N O
$num::P Q
)::Q R
)::R S
-::T U
$num::V W
;::W X
rentals;; 
[;; 

monthIndex;; "
];;" #
=;;$ %
Convert;;& -
.;;- .
ToDouble;;. 6
(;;6 7
row;;7 :
[;;: ;
$str;;; G
];;G H
);;H I
;;;I J
}<< 
return>> 
(>> 
months>> 
,>> 
rentals>> #
)>># $
;>>$ %
}?? 	
privateAA 
staticAA 
stringAA 
GetMonthNameAA *
(AA* +
intAA+ .
monthAA/ 4
)AA4 5
{BB 	
stringCC 
[CC 
]CC 

monthNamesCC 
=CC  !
{CC" #
$strCC$ -
,CC- .
$strCC/ 9
,CC9 :
$strCC; B
,CCB C
$strCCD K
,CCK L
$strCCM R
,CCR S
$strCCT Z
,CCZ [
$strCC\ b
,CCb c
$strCCd l
,CCl m
$strCCn y
,CCy z
$str	CC{ „
,
CC„ …
$str
CC† 
,
CC ‘
$str
CC’ œ
}
CC ž
;
CCž Ÿ
returnDD 
monthDD 
>=DD 
$numDD 
&&DD  
monthDD! &
<=DD' )
$numDD* ,
?DD- .

monthNamesDD/ 9
[DD9 :
monthDD: ?
-DD@ A
$numDDB C
]DDC D
:DDE F
$strDDG P
;DDP Q
}EE 	
}FF 
}GG ì+
SC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Business\Builders\RentalBuilder.cs
	namespace 	
ToolSYS
 
. 
Business 
. 
Builders #
{ 
public 

	interface 
IRentalBuilder #
{ 
IRentalBuilder		 
SetRentalID		 "
(		" #
int		# &
rentalID		' /
)		/ 0
;		0 1
IRentalBuilder

 
SetCustomerID

 $
(

$ %
int

% (

customerID

) 3
)

3 4
;

4 5
IRentalBuilder 
SetTransactionDate )
() *
DateTime* 2
date3 7
)7 8
;8 9
IRentalBuilder 
SetTotalFee "
(" #
decimal# *
totalFee+ 3
)3 4
;4 5
IRentalBuilder 
AddRentalItem $
($ %

RentalItem% /

rentalItem0 :
): ;
;; <
Rental 
Build 
( 
) 
; 
} 
public 

class 
RentalBuilder 
:  
IRentalBuilder! /
{ 
private 
readonly 
Rental 
_rental  '
;' (
public 
RentalBuilder 
( 
) 
{ 	
_rental 
= 
new 
Rental  
(  !
)! "
;" #
} 	
public 
IRentalBuilder 
SetRentalID )
() *
int* -
rentalID. 6
)6 7
{ 	
_rental 
. 
rentalID 
= 
rentalID '
;' (
return 
this 
; 
} 	
public!! 
IRentalBuilder!! 
SetCustomerID!! +
(!!+ ,
int!!, /

customerID!!0 :
)!!: ;
{"" 	
_rental## 
.## 

customerID## 
=##  

customerID##! +
;##+ ,
return$$ 
this$$ 
;$$ 
}%% 	
public'' 
IRentalBuilder'' 
SetTransactionDate'' 0
(''0 1
DateTime''1 9
date'': >
)''> ?
{(( 	
_rental)) 
.)) 
transactionDate)) #
=))$ %
date))& *
;))* +
return** 
this** 
;** 
}++ 	
public-- 
IRentalBuilder-- 
SetTotalFee-- )
(--) *
decimal--* 1
totalFee--2 :
)--: ;
{.. 	
_rental// 
.// 
totalFee// 
=// 
totalFee// '
;//' (
return00 
this00 
;00 
}11 	
public33 
IRentalBuilder33 
AddRentalItem33 +
(33+ ,

RentalItem33, 6

rentalItem337 A
)33A B
{44 	
if55 
(55 
_rental55 
.55 
RentalItems55 #
==55$ &
null55' +
)55+ ,
_rental66 
.66 
RentalItems66 #
=66$ %
new66& )
List66* .
<66. /

RentalItem66/ 9
>669 :
(66: ;
)66; <
;66< =
_rental88 
.88 
RentalItems88 
.88  
Add88  #
(88# $

rentalItem88$ .
)88. /
;88/ 0
return99 
this99 
;99 
}:: 	
public<< 
Rental<< 
Build<< 
(<< 
)<< 
{== 	
ValidateRental>> 
(>> 
)>> 
;>> 
return?? 
_rental?? 
;?? 
}@@ 	
privateBB 
voidBB 
ValidateRentalBB #
(BB# $
)BB$ %
{CC 	
ifDD 
(DD 
_rentalDD 
.DD 
rentalIDDD  
<=DD! #
$numDD$ %
)DD% &
throwEE 
newEE 
ArgumentExceptionEE +
(EE+ ,
$strEE, R
)EER S
;EES T
ifGG 
(GG 
_rentalGG 
.GG 

customerIDGG "
<=GG# %
$numGG& '
)GG' (
throwHH 
newHH 
ArgumentExceptionHH +
(HH+ ,
$strHH, T
)HHT U
;HHU V
ifJJ 
(JJ 
_rentalJJ 
.JJ 
transactionDateJJ '
==JJ( *
DateTimeJJ+ 3
.JJ3 4
MinValueJJ4 <
)JJ< =
throwKK 
newKK 
ArgumentExceptionKK +
(KK+ ,
$strKK, J
)KKJ K
;KKK L
ifMM 
(MM 
_rentalMM 
.MM 
totalFeeMM  
<=MM! #
$numMM$ %
)MM% &
throwNN 
newNN 
ArgumentExceptionNN +
(NN+ ,
$strNN, R
)NNR S
;NNS T
ifPP 
(PP 
_rentalPP 
.PP 
RentalItemsPP #
==PP$ &
nullPP' +
||PP, .
_rentalPP/ 6
.PP6 7
RentalItemsPP7 B
.PPB C
CountPPC H
==PPI K
$numPPL M
)PPM N
throwQQ 
newQQ 
ArgumentExceptionQQ +
(QQ+ ,
$strQQ, U
)QQU V
;QQV W
}RR 	
}SS 
}TT 