‚ù
AC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\ToolData.cs
	namespace 	
ToolSYS
 
. 
Data 
{ 
public 

class 
ToolData 
{ 
private		 
readonly		 
string		 
connectionString		  0
=		1 2
	DBConnect		3 <
.		< =
oradb		= B
;		B C
public 
void 
AddTool 
( 
Tool  
tool! %
)% &
{ 	
using 
( 
OracleConnection #
conn$ (
=) *
new+ .
OracleConnection/ ?
(? @
connectionString@ P
)P Q
)Q R
{ 
string 
sqlQuery 
=  !
$str" |
+} ~
$str$ w
;w x
OracleCommand 
cmd !
=" #
new$ '
OracleCommand( 5
(5 6
sqlQuery6 >
,> ?
conn@ D
)D E
;E F
cmd 
. 

Parameters 
. 
Add "
(" #
$str# ,
,, -
tool. 2
.2 3
toolID3 9
)9 :
;: ;
cmd 
. 

Parameters 
. 
Add "
(" #
$str# 2
,2 3
tool4 8
.8 9
categoryCode9 E
.E F
	SubstringF O
(O P
$numP Q
,Q R
$numS T
)T U
)U V
;V W
cmd 
. 

Parameters 
. 
Add "
(" #
$str# 5
,5 6
tool7 ;
.; <
toolDescription< K
)K L
;L M
cmd 
. 

Parameters 
. 
Add "
(" #
$str# 6
,6 7
tool8 <
.< =
toolManufacturer= M
)M N
;N O
cmd 
. 

Parameters 
. 
Add "
(" #
$str# 0
,0 1
tool2 6
.6 7

toolStatus7 A
)A B
;B C
conn 
. 
Open 
( 
) 
; 
cmd 
. 
ExecuteNonQuery #
(# $
)$ %
;% &
} 
} 	
public 
void 

UpdateTool 
( 
Tool #
tool$ (
)( )
{ 	
using   
(   
OracleConnection   #
conn  $ (
=  ) *
new  + .
OracleConnection  / ?
(  ? @
connectionString  @ P
)  P Q
)  Q R
{!! 
string"" 
sqlQuery"" 
=""  !
$str""" 5
+""6 7
$str##$ D
+##E F
$str$$$ J
+$$K L
$str%%$ L
+%%M N
$str&&$ ?
+&&@ A
$str''$ <
;''< =
OracleCommand)) 
cmd)) !
=))" #
new))$ '
OracleCommand))( 5
())5 6
sqlQuery))6 >
,))> ?
conn))@ D
)))D E
;))E F
cmd** 
.** 

Parameters** 
.** 
Add** "
(**" #
$str**# 2
,**2 3
tool**4 8
.**8 9
categoryCode**9 E
)**E F
;**F G
cmd++ 
.++ 

Parameters++ 
.++ 
Add++ "
(++" #
$str++# 5
,++5 6
tool++7 ;
.++; <
toolDescription++< K
)++K L
;++L M
cmd,, 
.,, 

Parameters,, 
.,, 
Add,, "
(,," #
$str,,# 6
,,,6 7
tool,,8 <
.,,< =
toolManufacturer,,= M
),,M N
;,,N O
cmd-- 
.-- 

Parameters-- 
.-- 
Add-- "
(--" #
$str--# 0
,--0 1
tool--2 6
.--6 7

toolStatus--7 A
)--A B
;--B C
cmd.. 
... 

Parameters.. 
... 
Add.. "
(.." #
$str..# ,
,.., -
tool... 2
...2 3
toolID..3 9
)..9 :
;..: ;
conn00 
.00 
Open00 
(00 
)00 
;00 
cmd11 
.11 
ExecuteNonQuery11 #
(11# $
)11$ %
;11% &
}22 
}33 	
public55 
void55 

RemoveTool55 
(55 
int55 "
toolID55# )
)55) *
{66 	
using77 
(77 
OracleConnection77 #
conn77$ (
=77) *
new77+ .
OracleConnection77/ ?
(77? @
connectionString77@ P
)77P Q
)77Q R
{88 
string99 
sqlQuery99 
=99  !
$str99" \
;99\ ]
OracleCommand:: 
cmd:: !
=::" #
new::$ '
OracleCommand::( 5
(::5 6
sqlQuery::6 >
,::> ?
conn::@ D
)::D E
;::E F
cmd;; 
.;; 

Parameters;; 
.;; 
Add;; "
(;;" #
$str;;# ,
,;;, -
toolID;;. 4
);;4 5
;;;5 6
conn== 
.== 
Open== 
(== 
)== 
;== 
cmd>> 
.>> 
ExecuteNonQuery>> #
(>># $
)>>$ %
;>>% &
}?? 
}@@ 	
publicBB 
intBB 
GetNextToolIDBB  
(BB  !
)BB! "
{CC 	
usingDD 
(DD 
OracleConnectionDD #
connDD$ (
=DD) *
newDD+ .
OracleConnectionDD/ ?
(DD? @
connectionStringDD@ P
)DDP Q
)DDQ R
{EE 
stringFF 
sqlQueryFF 
=FF  !
$strFF" A
;FFA B
OracleCommandGG 
cmdGG !
=GG" #
newGG$ '
OracleCommandGG( 5
(GG5 6
sqlQueryGG6 >
,GG> ?
connGG@ D
)GGD E
;GGE F
connHH 
.HH 
OpenHH 
(HH 
)HH 
;HH 
objectJJ 
resultJJ 
=JJ 
cmdJJ  #
.JJ# $
ExecuteScalarJJ$ 1
(JJ1 2
)JJ2 3
;JJ3 4
returnKK 
(KK 
resultKK 
==KK !
DBNullKK" (
.KK( )
ValueKK) .
)KK. /
?KK0 1
$numKK2 3
:KK4 5
ConvertKK6 =
.KK= >
ToInt32KK> E
(KKE F
resultKKF L
)KKL M
+KKN O
$numKKP Q
;KKQ R
}LL 
}MM 	
publicOO 
DataSetOO 
GetFilteredToolsOO '
(OO' (
stringOO( .
toolIDAsStringOO/ =
,OO= >
stringOO? E
categoryCodeOOF R
,OOR S
stringOOT Z
descriptionOO[ f
,OOf g
stringOOh n
manufacturerOOo {
,OO{ |
string	OO} É
status
OOÑ ä
,
OOä ã
string
OOå í
phrase
OOì ô
)
OOô ö
{PP 	
usingQQ 
(QQ 
OracleConnectionQQ #
connQQ$ (
=QQ) *
newQQ+ .
OracleConnectionQQ/ ?
(QQ? @
connectionStringQQ@ P
)QQP Q
)QQQ R
{RR 
stringSS 
sqlQuerySS 
=SS  !
DetermineSQLQuerySS" 3
(SS3 4
toolIDAsStringSS4 B
,SSB C
categoryCodeSSD P
,SSP Q
descriptionSSR ]
,SS] ^
manufacturerSS_ k
,SSk l
statusSSm s
,SSs t
phraseSSu {
)SS{ |
;SS| }
OracleCommandUU 
cmdUU !
=UU" #
newUU$ '
OracleCommandUU( 5
(UU5 6
sqlQueryUU6 >
,UU> ?
connUU@ D
)UUD E
;UUE F
OracleDataAdapterVV !
daVV" $
=VV% &
newVV' *
OracleDataAdapterVV+ <
(VV< =
cmdVV= @
)VV@ A
;VVA B
DataSetXX 
dsXX 
=XX 
newXX  
DataSetXX! (
(XX( )
)XX) *
;XX* +
daYY 
.YY 
FillYY 
(YY 
dsYY 
,YY 
$strYY "
)YY" #
;YY# $
return[[ 
ds[[ 
;[[ 
}\\ 
}]] 	
private__ 
static__ 
String__ 
DetermineSQLQuery__ /
(__/ 0
String__0 6
toolIDAsString__7 E
,__E F
String__G M
categoryCode__N Z
,__Z [
String__\ b
description__c n
,__n o
String__p v
manufacturer	__w É
,
__É Ñ
String
__Ö ã
status
__å í
,
__í ì
String
__î ö
phrase
__õ °
)
__° ¢
{`` 	
Stringaa 
sqlQueryaa 
=aa 
$straa  
;aa  !
ifcc 
(cc 
stringcc 
.cc 
IsNullOrEmptycc $
(cc$ %
toolIDAsStringcc% 3
)cc3 4
&&cc5 7
Stringcc8 >
.cc> ?
IsNullOrEmptycc? L
(ccL M
categoryCodeccM Y
)ccY Z
&&cc[ ]
stringcc^ d
.ccd e
IsNullOrEmptycce r
(ccr s
descriptionccs ~
)cc~ 
&&
ccÄ Ç
string
ccÉ â
.
ccâ ä
IsNullOrEmpty
ccä ó
(
ccó ò
manufacturer
ccò §
)
cc§ •
&&
cc¶ ®
string
cc© Ø
.
ccØ ∞
IsNullOrEmpty
cc∞ Ω
(
ccΩ æ
status
ccæ ƒ
)
ccƒ ≈
&&
cc∆ »
string
cc… œ
.
ccœ –
IsNullOrEmpty
cc– ›
(
cc› ﬁ
phrase
ccﬁ ‰
)
cc‰ Â
)
ccÂ Ê
{dd 
sqlQueryee 
=ee 
$stree r
;eer s
}ff 
elsegg 
ifgg 
(gg 
!gg 
stringgg 
.gg 
IsNullOrEmptygg *
(gg* +
toolIDAsStringgg+ 9
)gg9 :
||gg; =
!gg> ?
stringgg? E
.ggE F
IsNullOrEmptyggF S
(ggS T
categoryCodeggT `
)gg` a
||ggb d
!gge f
stringggf l
.ggl m
IsNullOrEmptyggm z
(ggz {
description	gg{ Ü
)
ggÜ á
||
ggà ä
!
ggã å
string
ggå í
.
ggí ì
IsNullOrEmpty
ggì †
(
gg† °
manufacturer
gg° ≠
)
gg≠ Æ
||
ggØ ±
!
gg≤ ≥
string
gg≥ π
.
ggπ ∫
IsNullOrEmpty
gg∫ «
(
gg« »
status
gg» Œ
)
ggŒ œ
||
gg– “
!
gg” ‘
string
gg‘ ⁄
.
gg⁄ €
IsNullOrEmpty
gg€ Ë
(
ggË È
phrase
ggÈ Ô
)
ggÔ 
)
gg Ò
{hh 
sqlQueryii 
=ii 
$strii ~
;ii~ 
ifkk 
(kk 
!kk 
stringkk 
.kk 
IsNullOrEmptykk )
(kk) *
toolIDAsStringkk* 8
)kk8 9
)kk9 :
{ll 
intmm 
toolIDmm 
=mm  
Convertmm! (
.mm( )
ToInt32mm) 0
(mm0 1
toolIDAsStringmm1 ?
)mm? @
;mm@ A
sqlQuerynn 
+=nn 
$strnn  0
+nn1 2
toolIDnn3 9
;nn9 :
}oo 
ifqq 
(qq 
!qq 
stringqq 
.qq 
IsNullOrEmptyqq )
(qq) *
categoryCodeqq* 6
)qq6 7
)qq7 8
{rr 
categoryCodess  
=ss! "
categoryCodess# /
.ss/ 0
	Substringss0 9
(ss9 :
$numss: ;
,ss; <
$numss= >
)ss> ?
;ss? @
sqlQuerytt 
+=tt 
$strtt  G
+ttH I
categoryCodettJ V
+ttW X
$strttY ]
;tt] ^
}uu 
ifww 
(ww 
!ww 
stringww 
.ww 
IsNullOrEmptyww )
(ww) *
descriptionww* 5
)ww5 6
)ww6 7
{xx 
sqlQueryyy 
+=yy 
$stryy  K
+yyL M
descriptionyyN Y
+yyZ [
$stryy\ a
;yya b
}zz 
if|| 
(|| 
!|| 
string|| 
.|| 
IsNullOrEmpty|| )
(||) *
manufacturer||* 6
)||6 7
)||7 8
{}} 
sqlQuery~~ 
+=~~ 
$str~~  L
+~~M N
manufacturer~~O [
+~~\ ]
$str~~^ c
;~~c d
} 
if
ÅÅ 
(
ÅÅ 
!
ÅÅ 
string
ÅÅ 
.
ÅÅ 
IsNullOrEmpty
ÅÅ )
(
ÅÅ) *
status
ÅÅ* 0
)
ÅÅ0 1
)
ÅÅ1 2
{
ÇÇ 
status
ÉÉ 
=
ÉÉ 
status
ÉÉ #
.
ÉÉ# $
	Substring
ÉÉ$ -
(
ÉÉ- .
$num
ÉÉ. /
,
ÉÉ/ 0
$num
ÉÉ1 2
)
ÉÉ2 3
;
ÉÉ3 4
sqlQuery
ÑÑ 
+=
ÑÑ 
$str
ÑÑ  5
+
ÑÑ6 7
status
ÑÑ8 >
+
ÑÑ? @
$str
ÑÑA D
;
ÑÑD E
}
ÖÖ 
if
áá 
(
áá 
!
áá 
string
áá 
.
áá 
IsNullOrEmpty
áá )
(
áá) *
phrase
áá* 0
)
áá0 1
)
áá1 2
{
àà 
sqlQuery
ââ 
+=
ââ 
$str
ââ  I
+
ââJ K
phrase
ââL R
+
ââS T
$str
ââU [
+
ââ\ ]
$str
ää A
+
ääB C
phrase
ääD J
+
ääK L
$str
ääM S
+
ääT U
$str
ãã B
+
ããC D
phrase
ããE K
+
ããL M
$str
ããN T
;
ããT U
}
åå 
}
çç 
return
éé 
sqlQuery
éé 
;
éé 
}
èè 	
public
íí 
DataSet
íí 
GetAvailableTools
íí (
(
íí( )
)
íí) *
{
ìì 	
using
îî 
(
îî 
OracleConnection
îî #
conn
îî$ (
=
îî) *
new
îî+ .
OracleConnection
îî/ ?
(
îî? @
connectionString
îî@ P
)
îîP Q
)
îîQ R
{
ïï 
string
ññ 
sqlQuery
ññ 
=
ññ  !
$str
ññ" n
+
ñño p
$str
óó (
;
óó( )
OracleCommand
ôô 
cmd
ôô !
=
ôô" #
new
ôô$ '
OracleCommand
ôô( 5
(
ôô5 6
sqlQuery
ôô6 >
,
ôô> ?
conn
ôô@ D
)
ôôD E
;
ôôE F
OracleDataAdapter
öö !
da
öö" $
=
öö% &
new
öö' *
OracleDataAdapter
öö+ <
(
öö< =
cmd
öö= @
)
öö@ A
;
ööA B
DataSet
úú 
ds
úú 
=
úú 
new
úú  
DataSet
úú! (
(
úú( )
)
úú) *
;
úú* +
da
ùù 
.
ùù 
Fill
ùù 
(
ùù 
ds
ùù 
,
ùù 
$str
ùù "
)
ùù" #
;
ùù# $
return
üü 
ds
üü 
;
üü 
}
†† 
}
°° 	
public
££ 
DataSet
££ 
GetRentableTools
££ '
(
££' (
string
££( .
categoryCode
££/ ;
,
££; <
DateTime
££= E
from
££F J
,
££J K
DateTime
££L T
to
££U W
)
££W X
{
§§ 	
using
•• 
(
•• 
OracleConnection
•• #
conn
••$ (
=
••) *
new
••+ .
OracleConnection
••/ ?
(
••? @
connectionString
••@ P
)
••P Q
)
••Q R
{
¶¶ 
string
ßß 
sqlQuery
ßß 
=
ßß  !
$str
ß±" 
;
±± 
using
≥≥ 
(
≥≥ 
OracleCommand
≥≥ $
cmd
≥≥% (
=
≥≥) *
new
≥≥+ .
OracleCommand
≥≥/ <
(
≥≥< =
sqlQuery
≥≥= E
,
≥≥E F
conn
≥≥G K
)
≥≥K L
)
≥≥L M
{
¥¥ 
cmd
µµ 
.
µµ 

Parameters
µµ "
.
µµ" #
Add
µµ# &
(
µµ& '
new
µµ' *
OracleParameter
µµ+ :
(
µµ: ;
$str
µµ; J
,
µµJ K
categoryCode
µµL X
)
µµX Y
)
µµY Z
;
µµZ [
cmd
∂∂ 
.
∂∂ 

Parameters
∂∂ "
.
∂∂" #
Add
∂∂# &
(
∂∂& '
new
∂∂' *
OracleParameter
∂∂+ :
(
∂∂: ;
$str
∂∂; F
,
∂∂F G
from
∂∂H L
.
∂∂L M
ToString
∂∂M U
(
∂∂U V
$str
∂∂V a
)
∂∂a b
)
∂∂b c
)
∂∂c d
;
∂∂d e
cmd
∑∑ 
.
∑∑ 

Parameters
∑∑ "
.
∑∑" #
Add
∑∑# &
(
∑∑& '
new
∑∑' *
OracleParameter
∑∑+ :
(
∑∑: ;
$str
∑∑; D
,
∑∑D E
to
∑∑F H
.
∑∑H I
ToString
∑∑I Q
(
∑∑Q R
$str
∑∑R ]
)
∑∑] ^
)
∑∑^ _
)
∑∑_ `
;
∑∑` a
OracleDataAdapter
ππ %
da
ππ& (
=
ππ) *
new
ππ+ .
OracleDataAdapter
ππ/ @
(
ππ@ A
cmd
ππA D
)
ππD E
;
ππE F
DataSet
∫∫ 
ds
∫∫ 
=
∫∫  
new
∫∫! $
DataSet
∫∫% ,
(
∫∫, -
)
∫∫- .
;
∫∫. /
da
ªª 
.
ªª 
Fill
ªª 
(
ªª 
ds
ªª 
,
ªª 
$str
ªª  &
)
ªª& '
;
ªª' (
return
ΩΩ 
ds
ΩΩ 
;
ΩΩ 
}
ææ 
}
øø 
}
¿¿ 	
public
√√ 
static
√√ 
bool
√√ 
DoesToolIDExist
√√ *
(
√√* +
int
√√+ .
toolID
√√/ 5
)
√√5 6
{
ƒƒ 	
using
≈≈ 
(
≈≈ 
var
≈≈ 
conn
≈≈ 
=
≈≈ 
new
≈≈ !
OracleConnection
≈≈" 2
(
≈≈2 3
	DBConnect
≈≈3 <
.
≈≈< =
oradb
≈≈= B
)
≈≈B C
)
≈≈C D
{
∆∆ 
string
«« 
sqlQuery
«« 
=
««  !
$str
««" j
;
««j k
OracleCommand
»» 
cmd
»» !
=
»»" #
new
»»$ '
OracleCommand
»»( 5
(
»»5 6
sqlQuery
»»6 >
,
»»> ?
conn
»»@ D
)
»»D E
;
»»E F
cmd
…… 
.
…… 

Parameters
…… 
.
…… 
Add
…… "
(
……" #
$str
……# ,
,
……, -
toolID
……. 4
)
……4 5
;
……5 6
conn
ÀÀ 
.
ÀÀ 
Open
ÀÀ 
(
ÀÀ 
)
ÀÀ 
;
ÀÀ 
int
ÃÃ 
count
ÃÃ 
=
ÃÃ 
Convert
ÃÃ #
.
ÃÃ# $
ToInt32
ÃÃ$ +
(
ÃÃ+ ,
cmd
ÃÃ, /
.
ÃÃ/ 0
ExecuteScalar
ÃÃ0 =
(
ÃÃ= >
)
ÃÃ> ?
)
ÃÃ? @
;
ÃÃ@ A
conn
ÕÕ 
.
ÕÕ 
Close
ÕÕ 
(
ÕÕ 
)
ÕÕ 
;
ÕÕ 
return
œœ 
count
œœ 
>
œœ 
$num
œœ  
;
œœ  !
}
–– 
}
—— 	
}
”” 
}‘‘ ¶
GC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\RentalItemData.cs
	namespace 	
ToolSYS
 
. 
Data 
{ 
public 

class 
RentalItemData 
{ 
private		 
readonly		 
string		 
_connectionString		  1
=		2 3
	DBConnect		4 =
.		= >
oradb		> C
;		C D
public 
void 
AddRentalItem !
(! "

RentalItem" ,

rentalItem- 7
)7 8
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
_connectionString3 D
)D E
)E F
{ 
conn 
. 
Open 
( 
) 
; 
string 
	sqlInsert  
=! "
$str# T
;T U
var 
cmd 
= 
new 
OracleCommand +
(+ ,
	sqlInsert, 5
,5 6
conn7 ;
); <
;< =
cmd 
. 

Parameters 
. 
Add "
(" #
$str# .
,. /
OracleDbType0 <
.< =
Int32= B
)B C
.C D
ValueD I
=J K

rentalItemL V
.V W
rentalIDW _
;_ `
cmd 
. 

Parameters 
. 
Add "
(" #
$str# ,
,, -
OracleDbType. :
.: ;
Int32; @
)@ A
.A B
ValueB G
=H I

rentalItemJ T
.T U
toolIDU [
;[ \
cmd 
. 

Parameters 
. 
Add "
(" #
$str# .
,. /
OracleDbType0 <
.< =
Date= A
)A B
.B C
ValueC H
=I J

rentalItemK U
.U V
rentDateV ^
;^ _
cmd 
. 

Parameters 
. 
Add "
(" #
$str# 0
,0 1
OracleDbType2 >
.> ?
Date? C
)C D
.D E
ValueE J
=K L

rentalItemM W
.W X

returnDateX b
;b c
cmd 
. 

Parameters 
. 
Add "
(" #
$str# /
,/ 0
OracleDbType1 =
.= >
Decimal> E
)E F
.F G
ValueG L
=M N

rentalItemO Y
.Y Z
	rentalFeeZ c
;c d
cmd 
. 
ExecuteNonQuery #
(# $
)$ %
;% &
string 
sqlUpdateStatus &
=' (
$str) c
;c d
cmd!! 
=!! 
new!! 
OracleCommand!! '
(!!' (
sqlUpdateStatus!!( 7
,!!7 8
conn!!9 =
)!!= >
;!!> ?
cmd"" 
."" 

Parameters"" 
."" 
Add"" "
(""" #
$str""# ,
,"", -
OracleDbType"". :
."": ;
Int32""; @
)""@ A
.""A B
Value""B G
=""H I

rentalItem""J T
.""T U
toolID""U [
;""[ \
cmd$$ 
.$$ 
ExecuteNonQuery$$ #
($$# $
)$$$ %
;$$% &
}%% 
}&& 	
}'' 
}(( »3
CC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\RentalData.cs
	namespace

 	
ToolSYS


 
.

 
Data

 
{ 
public 

static 
class 

RentalData "
{ 
public 
static 
int 
GetNextRentalID )
() *
)* +
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
	DBConnect3 <
.< =
oradb= B
)B C
)C D
{ 
conn 
. 
Open 
( 
) 
; 
string 
sqlQuery 
=  !
$str" Q
;Q R
var 
cmd 
= 
new 
OracleCommand +
(+ ,
sqlQuery, 4
,4 5
conn6 :
): ;
;; <
return 
Convert 
. 
ToInt32 &
(& '
cmd' *
.* +
ExecuteScalar+ 8
(8 9
)9 :
): ;
;; <
} 
} 	
public 
static 
void 
	AddRental $
($ %
Rental% +
rental, 2
)2 3
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
	DBConnect3 <
.< =
oradb= B
)B C
)C D
{ 
conn 
. 
Open 
( 
) 
; 
string 
sqlQuery 
=  !
$str " Q
;  Q R
var"" 
cmd"" 
="" 
new"" 
OracleCommand"" +
(""+ ,
sqlQuery"", 4
,""4 5
conn""6 :
)"": ;
;""; <
cmd## 
.## 

Parameters## 
.## 
Add## "
(##" #
$str### .
,##. /
rental##0 6
.##6 7
rentalID##7 ?
)##? @
;##@ A
cmd$$ 
.$$ 

Parameters$$ 
.$$ 
Add$$ "
($$" #
$str$$# 0
,$$0 1
rental$$2 8
.$$8 9

customerID$$9 C
)$$C D
;$$D E
cmd%% 
.%% 

Parameters%% 
.%% 
Add%% "
(%%" #
$str%%# 5
,%%5 6
rental%%7 =
.%%= >
transactionDate%%> M
)%%M N
;%%N O
cmd&& 
.&& 

Parameters&& 
.&& 
Add&& "
(&&" #
$str&&# .
,&&. /
rental&&0 6
.&&6 7
totalFee&&7 ?
)&&? @
;&&@ A
cmd'' 
.'' 
ExecuteNonQuery'' #
(''# $
)''$ %
;''% &
}(( 
})) 	
public++ 
static++ 
	DataTable++ $
GetRentalItemsByRentalID++  8
(++8 9
int++9 <
rentalID++= E
)++E F
{,, 	
using-- 
(-- 
var-- 
conn-- 
=-- 
new-- !
OracleConnection--" 2
(--2 3
	DBConnect--3 <
.--< =
oradb--= B
)--B C
)--C D
{.. 
string// 
query// 
=// 
$str/4 V
;44V W
OracleCommand66 
cmd66 !
=66" #
new66$ '
OracleCommand66( 5
(665 6
query666 ;
,66; <
conn66= A
)66A B
;66B C
cmd77 
.77 

Parameters77 
.77 
Add77 "
(77" #
$str77# .
,77. /
rentalID770 8
)778 9
;779 :
OracleDataAdapter99 !
adapter99" )
=99* +
new99, /
OracleDataAdapter990 A
(99A B
cmd99B E
)99E F
;99F G
	DataTable:: 
dt:: 
=:: 
new:: "
	DataTable::# ,
(::, -
)::- .
;::. /
adapter;; 
.;; 
Fill;; 
(;; 
dt;; 
);;  
;;;  !
return== 
dt== 
;== 
}>> 
}?? 	
publicAA 
staticAA 
voidAA 

ReturnToolAA %
(AA% &
intAA& )
rentalIDAA* 2
,AA2 3
intAA4 7
toolIDAA8 >
)AA> ?
{BB 	
usingCC 
(CC 
varCC 
connCC 
=CC 
newCC !
OracleConnectionCC" 2
(CC2 3
	DBConnectCC3 <
.CC< =
oradbCC= B
)CCB C
)CCC D
{DD 
connEE 
.EE 
OpenEE 
(EE 
)EE 
;EE 
stringGG 
updateToolQueryGG &
=GG' (
$strGG) c
;GGc d
OracleCommandHH 
updateToolCmdHH +
=HH, -
newHH. 1
OracleCommandHH2 ?
(HH? @
updateToolQueryHH@ O
,HHO P
connHHQ U
)HHU V
;HHV W
updateToolCmdII 
.II 

ParametersII (
.II( )
AddII) ,
(II, -
$strII- 6
,II6 7
toolIDII8 >
)II> ?
;II? @
updateToolCmdJJ 
.JJ 
ExecuteNonQueryJJ -
(JJ- .
)JJ. /
;JJ/ 0
stringLL !
updateRentalItemQueryLL ,
=LL- .
$strLO/ D
;OOD E
OracleCommandPP 
updateRentalCmdPP -
=PP. /
newPP0 3
OracleCommandPP4 A
(PPA B!
updateRentalItemQueryPPB W
,PPW X
connPPY ]
)PP] ^
;PP^ _
updateRentalCmdQQ 
.QQ  

ParametersQQ  *
.QQ* +
AddQQ+ .
(QQ. /
$strQQ/ :
,QQ: ;
rentalIDQQ< D
)QQD E
;QQE F
updateRentalCmdRR 
.RR  

ParametersRR  *
.RR* +
AddRR+ .
(RR. /
$strRR/ 8
,RR8 9
toolIDRR: @
)RR@ A
;RRA B
updateRentalCmdSS 
.SS  
ExecuteNonQuerySS  /
(SS/ 0
)SS0 1
;SS1 2
}TT 
}UU 	
}VV 
}WW ûI
AC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\RateData.cs
	namespace 	
ToolSYS
 
. 
Data 
{ 
public 

class 
RateData 
{ 
private		 
readonly		 
string		 
_connectionString		  1
=		2 3
	DBConnect		4 =
.		= >
oradb		> C
;		C D
public 
void 
AddRate 
( 
Rate  
rate! %
)% &
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
_connectionString3 D
)D E
)E F
{ 
string 
sqlQuery 
=  !
$str	" Ö
;
Ö Ü
OracleCommand 
cmd !
=" #
new$ '
OracleCommand( 5
(5 6
sqlQuery6 >
,> ?
conn@ D
)D E
;E F
cmd 
. 

Parameters 
. 
Add "
(" #
$str# 2
,2 3
rate4 8
.8 9
categoryCode9 E
)E F
;F G
cmd 
. 

Parameters 
. 
Add "
(" #
$str# 2
,2 3
rate4 8
.8 9
categoryDesc9 E
)E F
;F G
cmd 
. 

Parameters 
. 
Add "
(" #
$str# *
,* +
rate, 0
.0 1
rate1 5
)5 6
;6 7
conn 
. 
Open 
( 
) 
; 
cmd 
. 
ExecuteNonQuery #
(# $
)$ %
;% &
} 
} 	
public 
Rate !
GetRateByCategoryCode )
() *
string* 0
categoryCode1 =
)= >
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
_connectionString3 D
)D E
)E F
{ 
string 
sqlQuery 
=  !
$str" y
;y z
OracleCommand 
cmd !
=" #
new$ '
OracleCommand( 5
(5 6
sqlQuery6 >
,> ?
conn@ D
)D E
;E F
cmd   
.   

Parameters   
.   
Add   "
(  " #
$str  # 2
,  2 3
categoryCode  4 @
)  @ A
;  A B
conn"" 
."" 
Open"" 
("" 
)"" 
;"" 
OracleDataReader##  
dr##! #
=##$ %
cmd##& )
.##) *
ExecuteReader##* 7
(##7 8
)##8 9
;##9 :
if%% 
(%% 
dr%% 
.%% 
Read%% 
(%% 
)%% 
)%% 
{&& 
return'' 
new'' 
Rate'' #
{(( 
categoryCode)) $
=))% &
dr))' )
.))) *
	GetString))* 3
())3 4
$num))4 5
)))5 6
,))6 7
categoryDesc** $
=**% &
dr**' )
.**) *
	GetString*** 3
(**3 4
$num**4 5
)**5 6
,**6 7
rate++ 
=++ 
dr++ !
.++! "

GetDecimal++" ,
(++, -
$num++- .
)++. /
},, 
;,, 
}-- 
else.. 
{// 
return00 
null00 
;00  
}11 
}22 
}33 	
public55 
void55 

UpdateRate55 
(55 
Rate55 #
rate55$ (
)55( )
{66 	
using77 
(77 
var77 
conn77 
=77 
new77 !
OracleConnection77" 2
(772 3
_connectionString773 D
)77D E
)77E F
{88 
string99 
sqlQuery99 
=99  !
$str	99" Ç
;
99Ç É
OracleCommand:: 
cmd:: !
=::" #
new::$ '
OracleCommand::( 5
(::5 6
sqlQuery::6 >
,::> ?
conn::@ D
)::D E
;::E F
cmd;; 
.;; 

Parameters;; 
.;; 
Add;; "
(;;" #
$str;;# 2
,;;2 3
rate;;4 8
.;;8 9
categoryDesc;;9 E
);;E F
;;;F G
cmd<< 
.<< 

Parameters<< 
.<< 
Add<< "
(<<" #
$str<<# *
,<<* +
rate<<, 0
.<<0 1
rate<<1 5
)<<5 6
;<<6 7
cmd== 
.== 

Parameters== 
.== 
Add== "
(==" #
$str==# 2
,==2 3
rate==4 8
.==8 9
categoryCode==9 E
)==E F
;==F G
conn?? 
.?? 
Open?? 
(?? 
)?? 
;?? 
cmd@@ 
.@@ 
ExecuteNonQuery@@ #
(@@# $
)@@$ %
;@@% &
}AA 
}BB 	
publicDD 
DataSetDD 
GetAllCategoriesDD '
(DD' (
)DD( )
{EE 	
usingFF 
(FF 
varFF 
connFF 
=FF 
newFF !
OracleConnectionFF" 2
(FF2 3
_connectionStringFF3 D
)FFD E
)FFE F
{GG 
stringHH 
sqlQueryHH 
=HH  !
$strHH" M
;HHM N
OracleDataAdapterII !
daII" $
=II% &
newII' *
OracleDataAdapterII+ <
(II< =
sqlQueryII= E
,IIE F
connIIG K
)IIK L
;IIL M
DataSetKK 
dsKK 
=KK 
newKK  
DataSetKK! (
(KK( )
)KK) *
;KK* +
daLL 
.LL 
FillLL 
(LL 
dsLL 
,LL 
$strLL #
)LL# $
;LL$ %
returnNN 
dsNN 
;NN 
}OO 
}PP 	
publicRR 
boolRR  
IsCategoryCodeExistsRR (
(RR( )
stringRR) /
categoryCodeRR0 <
)RR< =
{SS 	
usingTT 
(TT 
varTT 
connTT 
=TT 
newTT !
OracleConnectionTT" 2
(TT2 3
_connectionStringTT3 D
)TTD E
)TTE F
{UU 
stringVV 
sqlQueryVV 
=VV  !
$strVV" a
;VVa b
OracleCommandWW 
cmdWW !
=WW" #
newWW$ '
OracleCommandWW( 5
(WW5 6
sqlQueryWW6 >
,WW> ?
connWW@ D
)WWD E
;WWE F
cmdXX 
.XX 

ParametersXX 
.XX 
AddXX "
(XX" #
$strXX# 2
,XX2 3
categoryCodeXX4 @
)XX@ A
;XXA B
connZZ 
.ZZ 
OpenZZ 
(ZZ 
)ZZ 
;ZZ 
int[[ 
count[[ 
=[[ 
Convert[[ #
.[[# $
ToInt32[[$ +
([[+ ,
cmd[[, /
.[[/ 0
ExecuteScalar[[0 =
([[= >
)[[> ?
)[[? @
;[[@ A
return]] 
count]] 
>]] 
$num]]  
;]]  !
}^^ 
}__ 	
publicaa 
boolaa !
DoesCategoryCodeExistaa )
(aa) *
stringaa* 0
categoryCodeaa1 =
)aa= >
{bb 	
usingcc 
(cc 
varcc 
conncc 
=cc 
newcc !
OracleConnectioncc" 2
(cc2 3
_connectionStringcc3 D
)ccD E
)ccE F
{dd 
stringee 
sqlQueryee 
=ee  !
$stree" a
;eea b
varff 
cmdff 
=ff 
newff 
OracleCommandff +
(ff+ ,
sqlQueryff, 4
,ff4 5
connff6 :
)ff: ;
;ff; <
cmdgg 
.gg 

Parametersgg 
.gg 
Addgg "
(gg" #
$strgg# 2
,gg2 3
OracleDbTypegg4 @
.gg@ A
Varchar2ggA I
)ggI J
.ggJ K
ValueggK P
=ggQ R
categoryCodeggS _
;gg_ `
connii 
.ii 
Openii 
(ii 
)ii 
;ii 
intjj 
countjj 
=jj 
Convertjj #
.jj# $
ToInt32jj$ +
(jj+ ,
cmdjj, /
.jj/ 0
ExecuteScalarjj0 =
(jj= >
)jj> ?
)jj? @
;jj@ A
connkk 
.kk 
Closekk 
(kk 
)kk 
;kk 
returnmm 
countmm 
>mm 
$nummm  
;mm  !
}nn 
}oo 	
}pp 
}qq ˆ
BC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\DBConnect.cs
	namespace 	
ToolSYS
 
{ 
public 

static 
class 
	DBConnect !
{ 
public 
const 
String 
oradb !
=" #
$str$ y
;y z
} 
} ˇ≠
EC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\CustomerData.cs
	namespace

 	
ToolSYS


 
.

 
Data

 
{ 
public 

class 
CustomerData 
{ 
private 
readonly 
string 
_connectionString  1
=2 3
	DBConnect4 =
.= >
oradb> C
;C D
public 
int 
GetNextCustomerID $
($ %
)% &
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
_connectionString3 D
)D E
)E F
{ 
string 
sqlQuery 
=  !
$str" I
;I J
var 
cmd 
= 
new 
OracleCommand +
(+ ,
sqlQuery, 4
,4 5
conn6 :
): ;
;; <
conn 
. 
Open 
( 
) 
; 
int 
nextCustomerID "
=# $
cmd% (
.( )
ExecuteScalar) 6
(6 7
)7 8
==9 ;
DBNull< B
.B C
ValueC H
?I J
$numK L
:M N
ConvertO V
.V W
ToInt32W ^
(^ _
cmd_ b
.b c
ExecuteScalarc p
(p q
)q r
)r s
+t u
$numv w
;w x
conn 
. 
Close 
( 
) 
; 
return 
nextCustomerID %
;% &
} 
} 	
public 
void 
AddCustomer 
(  
Customer  (
customer) 1
)1 2
{   	
using!! 
(!! 
var!! 
conn!! 
=!! 
new!! !
OracleConnection!!" 2
(!!2 3
_connectionString!!3 D
)!!D E
)!!E F
{"" 
string## 
sqlQuery## 
=##  !
$str##" q
+##r s
$str$$" g
;$$g h
var&& 
cmd&& 
=&& 
new&& 
OracleCommand&& +
(&&+ ,
sqlQuery&&, 4
,&&4 5
conn&&6 :
)&&: ;
;&&; <
cmd'' 
.'' 

Parameters'' 
.'' 
Add'' "
(''" #
$str''# 0
,''0 1
OracleDbType''2 >
.''> ?
Int32''? D
)''D E
.''E F
Value''F K
=''L M
customer''N V
.''V W

customerID''W a
;''a b
cmd(( 
.(( 

Parameters(( 
.(( 
Add(( "
(((" #
$str((# .
,((. /
OracleDbType((0 <
.((< =
Varchar2((= E
)((E F
.((F G
Value((G L
=((M N
customer((O W
.((W X
forename((X `
;((` a
cmd)) 
.)) 

Parameters)) 
.)) 
Add)) "
())" #
$str))# -
,))- .
OracleDbType))/ ;
.)); <
Varchar2))< D
)))D E
.))E F
Value))F K
=))L M
customer))N V
.))V W
surname))W ^
;))^ _
cmd** 
.** 

Parameters** 
.** 
Add** "
(**" #
$str**# +
,**+ ,
OracleDbType**- 9
.**9 :
Varchar2**: B
)**B C
.**C D
Value**D I
=**J K
customer**L T
.**T U
email**U Z
;**Z [
cmd++ 
.++ 

Parameters++ 
.++ 
Add++ "
(++" #
$str++# +
,+++ ,
OracleDbType++- 9
.++9 :
Varchar2++: B
)++B C
.++C D
Value++D I
=++J K
customer++L T
.++T U
phone++U Z
;++Z [
cmd,, 
.,, 

Parameters,, 
.,, 
Add,, "
(,," #
$str,,# -
,,,- .
OracleDbType,,/ ;
.,,; <
Varchar2,,< D
),,D E
.,,E F
Value,,F K
=,,L M
customer,,N V
.,,V W
eircode,,W ^
;,,^ _
conn.. 
... 
Open.. 
(.. 
).. 
;.. 
cmd// 
.// 
ExecuteNonQuery// #
(//# $
)//$ %
;//% &
conn00 
.00 
Close00 
(00 
)00 
;00 
}11 
}22 	
public44 
void44 
UpdateCustomer44 "
(44" #
Customer44# +
customer44, 4
)444 5
{55 	
using66 
(66 
var66 
conn66 
=66 
new66 !
OracleConnection66" 2
(662 3
_connectionString663 D
)66D E
)66E F
{77 
string88 
sqlQuery88 
=88  !
$str	88" ñ
+
88ó ò
$str99" B
;99B C
var;; 
cmd;; 
=;; 
new;; 
OracleCommand;; +
(;;+ ,
sqlQuery;;, 4
,;;4 5
conn;;6 :
);;: ;
;;;; <
cmd<< 
.<< 

Parameters<< 
.<< 
Add<< "
(<<" #
$str<<# 0
,<<0 1
OracleDbType<<2 >
.<<> ?
Int32<<? D
)<<D E
.<<E F
Value<<F K
=<<L M
customer<<N V
.<<V W

customerID<<W a
;<<a b
cmd== 
.== 

Parameters== 
.== 
Add== "
(==" #
$str==# .
,==. /
OracleDbType==0 <
.==< =
Varchar2=== E
)==E F
.==F G
Value==G L
===M N
customer==O W
.==W X
forename==X `
;==` a
cmd>> 
.>> 

Parameters>> 
.>> 
Add>> "
(>>" #
$str>># -
,>>- .
OracleDbType>>/ ;
.>>; <
Varchar2>>< D
)>>D E
.>>E F
Value>>F K
=>>L M
customer>>N V
.>>V W
surname>>W ^
;>>^ _
cmd?? 
.?? 

Parameters?? 
.?? 
Add?? "
(??" #
$str??# +
,??+ ,
OracleDbType??- 9
.??9 :
Varchar2??: B
)??B C
.??C D
Value??D I
=??J K
customer??L T
.??T U
email??U Z
;??Z [
cmd@@ 
.@@ 

Parameters@@ 
.@@ 
Add@@ "
(@@" #
$str@@# +
,@@+ ,
OracleDbType@@- 9
.@@9 :
Varchar2@@: B
)@@B C
.@@C D
Value@@D I
=@@J K
customer@@L T
.@@T U
phone@@U Z
;@@Z [
cmdAA 
.AA 

ParametersAA 
.AA 
AddAA "
(AA" #
$strAA# -
,AA- .
OracleDbTypeAA/ ;
.AA; <
Varchar2AA< D
)AAD E
.AAE F
ValueAAF K
=AAL M
customerAAN V
.AAV W
eircodeAAW ^
;AA^ _
connCC 
.CC 
OpenCC 
(CC 
)CC 
;CC 
cmdDD 
.DD 
ExecuteNonQueryDD #
(DD# $
)DD$ %
;DD% &
connEE 
.EE 
CloseEE 
(EE 
)EE 
;EE 
}FF 
}GG 	
publicII 
DataSetII 
SearchCustomersII &
(II& '
stringII' -
searchPhraseII. :
)II: ;
{JJ 	
usingKK 
(KK 
varKK 
connKK 
=KK 
newKK !
OracleConnectionKK" 2
(KK2 3
_connectionStringKK3 D
)KKD E
)KKE F
{LL 
stringMM 
sqlQueryMM 
=MM  !
$strMM" `
+MMa b
$str	NN" É
+
NNÑ Ö
$str	OO" ë
;
OOë í
varQQ 
cmdQQ 
=QQ 
newQQ 
OracleCommandQQ +
(QQ+ ,
sqlQueryQQ, 4
,QQ4 5
connQQ6 :
)QQ: ;
;QQ; <
cmdRR 
.RR 

ParametersRR 
.RR 
AddRR "
(RR" #
$strRR# ,
,RR, -
OracleDbTypeRR. :
.RR: ;
Varchar2RR; C
)RRC D
.RRD E
ValueRRE J
=RRK L
$"RRM O
$strRRO P
{RRP Q
searchPhraseRRQ ]
}RR] ^
$strRR^ _
"RR_ `
;RR` a
OracleDataAdapterTT !
daTT" $
=TT% &
newTT' *
OracleDataAdapterTT+ <
(TT< =
cmdTT= @
)TT@ A
;TTA B
DataSetUU 
dsUU 
=UU 
newUU  
DataSetUU! (
(UU( )
)UU) *
;UU* +
daVV 
.VV 
FillVV 
(VV 
dsVV 
,VV 
$strVV &
)VV& '
;VV' (
returnWW 
dsWW 
;WW 
}XX 
}YY 	
public\\ 
static\\ 
DataSet\\  
GetFilteredCustomers\\ 2
(\\2 3
String\\3 9
custIDAsString\\: H
,\\H I
String\\J P
forename\\Q Y
,\\Y Z
String\\[ a
surname\\b i
,\\i j
String\\k q
email\\r w
,\\w x
String\\y 
phone
\\Ä Ö
,
\\Ö Ü
String
\\á ç
eircode
\\é ï
,
\\ï ñ
String
\\ó ù
phrase
\\û §
)
\\§ •
{]] 	
OracleConnection^^ 
conn^^ !
=^^" #
new^^$ '
OracleConnection^^( 8
(^^8 9
	DBConnect^^9 B
.^^B C
oradb^^C H
)^^H I
;^^I J
String`` 
sqlQuery`` 
=`` 
DetermineSQLQuery`` /
(``/ 0
custIDAsString``0 >
,``> ?
forename``@ H
,``H I
surname``J Q
,``Q R
email``S X
,``X Y
phone``Z _
,``_ `
eircode``a h
,``h i
phrase``j p
)``p q
;``q r
OracleCommandbb 
cmdbb 
=bb 
newbb  #
OracleCommandbb$ 1
(bb1 2
sqlQuerybb2 :
,bb: ;
connbb< @
)bb@ A
;bbA B
OracleDataAdapterdd 
dadd  
=dd! "
newdd# &
OracleDataAdapterdd' 8
(dd8 9
cmddd9 <
)dd< =
;dd= >
DataSetff 
dsff 
=ff 
newff 
DataSetff $
(ff$ %
)ff% &
;ff& '
dagg 
.gg 
Fillgg 
(gg 
dsgg 
,gg 
$strgg "
)gg" #
;gg# $
connii 
.ii 
Closeii 
(ii 
)ii 
;ii 
returnkk 
dskk 
;kk 
}mm 	
privatenn 
staticnn 
Stringnn 
DetermineSQLQuerynn /
(nn/ 0
Stringnn0 6
custIDAsStringnn7 E
,nnE F
StringnnG M
forenamennN V
,nnV W
StringnnX ^
surnamenn_ f
,nnf g
Stringnnh n
emailnno t
,nnt u
Stringnnv |
phone	nn} Ç
,
nnÇ É
String
nnÑ ä
eircode
nnã í
,
nní ì
String
nnî ö
phrase
nnõ °
)
nn° ¢
{oo 	
Stringpp 
sqlQuerypp 
=pp 
$strpp  
;pp  !
ifrr 
(rr 
stringrr 
.rr 
IsNullOrEmptyrr $
(rr$ %
custIDAsStringrr% 3
)rr3 4
&&rr5 7
Stringrr8 >
.rr> ?
IsNullOrEmptyrr? L
(rrL M
forenamerrM U
)rrU V
&&rrW Y
stringrrZ `
.rr` a
IsNullOrEmptyrra n
(rrn o
surnamerro v
)rrv w
&&rrx z
string	rr{ Å
.
rrÅ Ç
IsNullOrEmpty
rrÇ è
(
rrè ê
email
rrê ï
)
rrï ñ
&&
rró ô
string
rrö †
.
rr† °
IsNullOrEmpty
rr° Æ
(
rrÆ Ø
phone
rrØ ¥
)
rr¥ µ
&&
rr∂ ∏
string
rrπ ø
.
rrø ¿
IsNullOrEmpty
rr¿ Õ
(
rrÕ Œ
eircode
rrŒ ’
)
rr’ ÷
&&
rr◊ Ÿ
string
rr⁄ ‡
.
rr‡ ·
IsNullOrEmpty
rr· Ó
(
rrÓ Ô
phrase
rrÔ ı
)
rrı ˆ
)
rrˆ ˜
{ss 
sqlQuerytt 
=tt 
$strtt g
;ttg h
}uu 
elsevv 
ifvv 
(vv 
!vv 
stringvv 
.vv 
IsNullOrEmptyvv *
(vv* +
custIDAsStringvv+ 9
)vv9 :
||vv; =
!vv> ?
stringvv? E
.vvE F
IsNullOrEmptyvvF S
(vvS T
forenamevvT \
)vv\ ]
||vv^ `
!vva b
stringvvb h
.vvh i
IsNullOrEmptyvvi v
(vvv w
surnamevvw ~
)vv~ 
||
vvÄ Ç
!
vvÉ Ñ
string
vvÑ ä
.
vvä ã
IsNullOrEmpty
vvã ò
(
vvò ô
email
vvô û
)
vvû ü
||
vv† ¢
!
vv£ §
string
vv§ ™
.
vv™ ´
IsNullOrEmpty
vv´ ∏
(
vv∏ π
phone
vvπ æ
)
vvæ ø
||
vv¿ ¬
!
vv√ ƒ
string
vvƒ  
.
vv  À
IsNullOrEmpty
vvÀ ÿ
(
vvÿ Ÿ
eircode
vvŸ ‡
)
vv‡ ·
||
vv‚ ‰
!
vvÂ Ê
string
vvÊ Ï
.
vvÏ Ì
IsNullOrEmpty
vvÌ ˙
(
vv˙ ˚
phrase
vv˚ Å
)
vvÅ Ç
)
vvÇ É
{ww 
sqlQueryxx 
=xx 
$strxx s
;xxs t
ifzz 
(zz 
!zz 
stringzz 
.zz 
IsNullOrEmptyzz )
(zz) *
custIDAsStringzz* 8
)zz8 9
)zz9 :
{{{ 
int|| 
custID|| 
;|| 
if}} 
(}} 
Decimal}} 
.}}  
TryParse}}  (
(}}( )
custIDAsString}}) 7
,}}7 8
out}}9 <
_}}= >
)}}> ?
)}}? @
{~~ 
custID 
=  
Convert! (
.( )
ToInt32) 0
(0 1
custIDAsString1 ?
)? @
;@ A
sqlQuery
ÄÄ  
+=
ÄÄ! #
$str
ÄÄ$ 8
+
ÄÄ9 :
custID
ÄÄ; A
;
ÄÄA B
}
ÅÅ 
}
ÇÇ 
if
ÑÑ 
(
ÑÑ 
!
ÑÑ 
string
ÑÑ 
.
ÑÑ 
IsNullOrEmpty
ÑÑ )
(
ÑÑ) *
forename
ÑÑ* 2
)
ÑÑ2 3
)
ÑÑ3 4
{
ÖÖ 
sqlQuery
ÜÜ 
+=
ÜÜ 
$str
ÜÜ  D
+
ÜÜE F
forename
ÜÜG O
+
ÜÜP Q
$str
ÜÜR W
;
ÜÜW X
}
áá 
if
ââ 
(
ââ 
!
ââ 
string
ââ 
.
ââ 
IsNullOrEmpty
ââ )
(
ââ) *
surname
ââ* 1
)
ââ1 2
)
ââ2 3
{
ää 
sqlQuery
ãã 
+=
ãã 
$str
ãã  C
+
ããD E
surname
ããF M
+
ããN O
$str
ããP U
;
ããU V
}
åå 
if
éé 
(
éé 
!
éé 
string
éé 
.
éé 
IsNullOrEmpty
éé )
(
éé) *
email
éé* /
)
éé/ 0
)
éé0 1
{
èè 
sqlQuery
êê 
+=
êê 
$str
êê  A
+
êêB C
email
êêD I
+
êêJ K
$str
êêL Q
;
êêQ R
}
ëë 
if
ìì 
(
ìì 
!
ìì 
string
ìì 
.
ìì 
IsNullOrEmpty
ìì )
(
ìì) *
phone
ìì* /
)
ìì/ 0
)
ìì0 1
{
îî 
sqlQuery
ïï 
+=
ïï 
$str
ïï  1
+
ïï2 3
phone
ïï4 9
+
ïï: ;
$str
ïï< @
;
ïï@ A
}
ññ 
if
óó 
(
óó 
!
óó 
string
óó 
.
óó 
IsNullOrEmpty
óó )
(
óó) *
eircode
óó* 1
)
óó1 2
)
óó2 3
{
òò 
sqlQuery
ôô 
+=
ôô 
$str
ôô  C
+
ôôD E
eircode
ôôF M
+
ôôN O
$str
ôôP U
;
ôôU V
}
öö 
if
õõ 
(
õõ 
!
õõ 
string
õõ 
.
õõ 
IsNullOrEmpty
õõ )
(
õõ) *
phrase
õõ* 0
)
õõ0 1
)
õõ1 2
{
úú 
sqlQuery
ùù 
+=
ùù 
$str
ùù  E
+
ùùF G
phrase
ùùH N
+
ùùO P
$str
ùùQ W
+
ùùX Y
$str
ûû 9
+
ûû: ;
phrase
ûû< B
+
ûûC D
$str
ûûE K
+
ûûL M
$str
üü 7
+
üü8 9
phrase
üü: @
+
üüA B
$str
üüC I
+
üüJ K
$str
†† 7
+
††8 9
phrase
††: @
+
††A B
$str
††C I
+
††J K
$str
°° 9
+
°°: ;
phrase
°°< B
+
°°C D
$str
°°E K
;
°°K L
}
¢¢ 
}
££ 
return
§§ 
sqlQuery
§§ 
;
§§ 
}
•• 	
public
ßß 
Customer
ßß 
GetCustomerData
ßß '
(
ßß' (
int
ßß( +

customerID
ßß, 6
)
ßß6 7
{
®® 	
using
©© 
(
©© 
var
©© 
conn
©© 
=
©© 
new
©© !
OracleConnection
©©" 2
(
©©2 3
_connectionString
©©3 D
)
©©D E
)
©©E F
{
™™ 
string
´´ 
sqlQuery
´´ 
=
´´  !
$str
´´" Z
;
´´Z [
OracleCommand
¨¨ 
cmd
¨¨ !
=
¨¨" #
new
¨¨$ '
OracleCommand
¨¨( 5
(
¨¨5 6
sqlQuery
¨¨6 >
,
¨¨> ?
conn
¨¨@ D
)
¨¨D E
;
¨¨E F
cmd
≠≠ 
.
≠≠ 

Parameters
≠≠ 
.
≠≠ 
Add
≠≠ "
(
≠≠" #
name
≠≠# '
:
≠≠' (
$str
≠≠) 6
,
≠≠6 7

customerID
≠≠8 B
)
≠≠B C
;
≠≠C D
conn
ØØ 
.
ØØ 
Open
ØØ 
(
ØØ 
)
ØØ 
;
ØØ 
using
∞∞ 
(
∞∞ 
var
∞∞ 
reader
∞∞ !
=
∞∞" #
cmd
∞∞$ '
.
∞∞' (
ExecuteReader
∞∞( 5
(
∞∞5 6
)
∞∞6 7
)
∞∞7 8
{
±± 
if
≤≤ 
(
≤≤ 
reader
≤≤ 
.
≤≤ 
Read
≤≤ #
(
≤≤# $
)
≤≤$ %
)
≤≤% &
{
≥≥ 
return
¥¥ 
new
¥¥ "
RegularCustomer
¥¥# 2
{
µµ 

customerID
∂∂ &
=
∂∂' (
reader
∂∂) /
.
∂∂/ 0
GetInt32
∂∂0 8
(
∂∂8 9
$num
∂∂9 :
)
∂∂: ;
,
∂∂; <
forename
∑∑ $
=
∑∑% &
reader
∑∑' -
.
∑∑- .
	GetString
∑∑. 7
(
∑∑7 8
$num
∑∑8 9
)
∑∑9 :
,
∑∑: ;
surname
∏∏ #
=
∏∏$ %
reader
∏∏& ,
.
∏∏, -
	GetString
∏∏- 6
(
∏∏6 7
$num
∏∏7 8
)
∏∏8 9
,
∏∏9 :
email
ππ !
=
ππ" #
reader
ππ$ *
.
ππ* +
	GetString
ππ+ 4
(
ππ4 5
$num
ππ5 6
)
ππ6 7
,
ππ7 8
phone
∫∫ !
=
∫∫" #
reader
∫∫$ *
.
∫∫* +
	GetString
∫∫+ 4
(
∫∫4 5
$num
∫∫5 6
)
∫∫6 7
,
∫∫7 8
eircode
ªª #
=
ªª$ %
reader
ªª& ,
.
ªª, -
	GetString
ªª- 6
(
ªª6 7
$num
ªª7 8
)
ªª8 9
}
ºº 
;
ºº 
}
ΩΩ 
}
ææ 
}
øø 
throw
¿¿ 
new
¿¿ 
ArgumentException
¿¿ '
(
¿¿' (
$str
¿¿( =
)
¿¿= >
;
¿¿> ?
}
¡¡ 	
public
√√ 
int
√√  
GetRentalFrequency
√√ %
(
√√% &
int
√√& )

customerID
√√* 4
)
√√4 5
{
ƒƒ 	
using
≈≈ 
(
≈≈ 
var
≈≈ 
conn
≈≈ 
=
≈≈ 
new
≈≈ !
OracleConnection
≈≈" 2
(
≈≈2 3
_connectionString
≈≈3 D
)
≈≈D E
)
≈≈E F
{
∆∆ 
string
«« 
sqlQuery
«« 
=
««  !
$str
««" _
;
««_ `
OracleCommand
»» 
cmd
»» !
=
»»" #
new
»»$ '
OracleCommand
»»( 5
(
»»5 6
sqlQuery
»»6 >
,
»»> ?
conn
»»@ D
)
»»D E
;
»»E F
cmd
…… 
.
…… 

Parameters
…… 
.
…… 
Add
…… "
(
……" #
$str
……# 0
,
……0 1

customerID
……2 <
)
……< =
;
……= >
conn
ÀÀ 
.
ÀÀ 
Open
ÀÀ 
(
ÀÀ 
)
ÀÀ 
;
ÀÀ 
return
ÃÃ 
Convert
ÃÃ 
.
ÃÃ 
ToInt32
ÃÃ &
(
ÃÃ& '
cmd
ÃÃ' *
.
ÃÃ* +
ExecuteScalar
ÃÃ+ 8
(
ÃÃ8 9
)
ÃÃ9 :
)
ÃÃ: ;
;
ÃÃ; <
}
ÕÕ 
}
ŒŒ 	
}
œœ 
}–– Í'
EC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\AnalysisData.cs
	namespace 	
ToolSYS
 
. 
Data 
{ 
public 

class 
AnalysisData 
{ 
private 
readonly 
string 
_connectionString  1
=2 3
	DBConnect4 =
.= >
oradb> C
;C D
public

 
	DataTable

 
GetDistinctYears

 )
(

) *
)

* +
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
_connectionString3 D
)D E
)E F
{ 
string 
sqlQuery 
=  !
$str" w
;w x
OracleCommand 
cmd !
=" #
new$ '
OracleCommand( 5
(5 6
sqlQuery6 >
,> ?
conn@ D
)D E
;E F
conn 
. 
Open 
( 
) 
; 
	DataTable 

yearsTable $
=% &
new' *
	DataTable+ 4
(4 5
)5 6
;6 7
using 
( 
OracleDataReader '
reader( .
=/ 0
cmd1 4
.4 5
ExecuteReader5 B
(B C
)C D
)D E
{ 

yearsTable 
. 
Load #
(# $
reader$ *
)* +
;+ ,
} 
return 

yearsTable !
;! "
} 
} 	
public 
	DataTable 
GetMonthlyRevenues +
(+ ,
int, /
year0 4
)4 5
{ 	
string 
sqlQuery 
= 
$str# <
;##< =
using%% 
(%% 
var%% 
conn%% 
=%% 
new%% !
OracleConnection%%" 2
(%%2 3
_connectionString%%3 D
)%%D E
)%%E F
{&& 
OracleCommand'' 
cmd'' !
=''" #
new''$ '
OracleCommand''( 5
(''5 6
sqlQuery''6 >
,''> ?
conn''@ D
)''D E
;''E F
cmd(( 
.(( 

Parameters(( 
.(( 
Add(( "
(((" #
$str((# *
,((* +
year((, 0
.((0 1
ToString((1 9
(((9 :
)((: ;
)((; <
;((< =
	DataTable** 
revenueTable** &
=**' (
new**) ,
	DataTable**- 6
(**6 7
)**7 8
;**8 9
OracleDataAdapter++ !
da++" $
=++% &
new++' *
OracleDataAdapter+++ <
(++< =
cmd++= @
)++@ A
;++A B
conn-- 
.-- 
Open-- 
(-- 
)-- 
;-- 
da.. 
... 
Fill.. 
(.. 
revenueTable.. $
)..$ %
;..% &
return00 
revenueTable00 #
;00# $
}11 
}22 	
public44 
	DataTable44 '
GetMonthlyRentalsByCategory44 4
(444 5
int445 8
year449 =
,44= >
string44? E
categoryCode44F R
)44R S
{55 	
string66 
sqlQuery66 
=66 
$str6= 
;==  
using?? 
(?? 
var?? 
conn?? 
=?? 
new?? !
OracleConnection??" 2
(??2 3
_connectionString??3 D
)??D E
)??E F
{@@ 
OracleCommandAA 
cmdAA !
=AA" #
newAA$ '
OracleCommandAA( 5
(AA5 6
sqlQueryAA6 >
,AA> ?
connAA@ D
)AAD E
;AAE F
cmdBB 
.BB 

ParametersBB 
.BB 
AddBB "
(BB" #
$strBB# *
,BB* +
yearBB, 0
.BB0 1
ToStringBB1 9
(BB9 :
)BB: ;
)BB; <
;BB< =
cmdCC 
.CC 

ParametersCC 
.CC 
AddCC "
(CC" #
$strCC# 2
,CC2 3
categoryCodeCC4 @
)CC@ A
;CCA B
OracleDataAdapterEE !
daEE" $
=EE% &
newEE' *
OracleDataAdapterEE+ <
(EE< =
cmdEE= @
)EE@ A
;EEA B
	DataTableFF 
dtFF 
=FF 
newFF "
	DataTableFF# ,
(FF, -
)FF- .
;FF. /
connHH 
.HH 
OpenHH 
(HH 
)HH 
;HH 
daII 
.II 
FillII 
(II 
dtII 
)II 
;II 
returnKK 
dtKK 
;KK 
}LL 
}MM 	
}NN 
}OO 