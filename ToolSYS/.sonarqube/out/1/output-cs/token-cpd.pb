û©
AC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\ToolData.cs
	namespace 	
ToolSYS
 
. 
Data 
{ 
public 

	interface 
	IToolData 
{ 
void		 
AddTool		 
(		 
Tool		 
tool		 
)		 
;		  
void

 

UpdateTool

 
(

 
Tool

 
tool

 !
)

! "
;

" #
void 

RemoveTool 
( 
int 
toolID "
)" #
;# $
int 
GetNextToolID 
( 
) 
; 
DataSet 
GetFilteredTools  
(  !
string! '
toolIDAsString( 6
,6 7
string8 >
categoryCode? K
,K L
stringM S
descriptionT _
,_ `
stringa g
manufacturerh t
,t u
stringv |
status	} ƒ
,
ƒ „
string
… ‹
phrase
Œ ’
)
’ “
;
“ ”
DataSet 
GetAvailableTools !
(! "
)" #
;# $
DataSet 
GetRentableTools  
(  !
string! '
categoryCode( 4
,4 5
DateTime6 >
from? C
,C D
DateTimeE M
toN P
)P Q
;Q R
bool 

ToolExists 
( 
int 
toolID #
)# $
;$ %
} 
public 

class 
ToolData 
: 
	IToolData %
{ 
private 
readonly 
string 
connectionString  0
=1 2
	DBConnect3 <
.< =
oradb= B
;B C
public 
void 
AddTool 
( 
Tool  
tool! %
)% &
{ 	
using 
( 
OracleConnection #
conn$ (
=) *
new+ .
OracleConnection/ ?
(? @
connectionString@ P
)P Q
)Q R
{ 
string 
sqlQuery 
=  !
$str" |
+} ~
$str$ w
;w x
OracleCommand 
cmd !
=" #
new$ '
OracleCommand( 5
(5 6
sqlQuery6 >
,> ?
conn@ D
)D E
;E F
cmd 
. 

Parameters 
. 
Add "
(" #
$str# ,
,, -
tool. 2
.2 3
toolID3 9
)9 :
;: ;
cmd   
.   

Parameters   
.   
Add   "
(  " #
$str  # 2
,  2 3
tool  4 8
.  8 9
categoryCode  9 E
.  E F
	Substring  F O
(  O P
$num  P Q
,  Q R
$num  S T
)  T U
)  U V
;  V W
cmd!! 
.!! 

Parameters!! 
.!! 
Add!! "
(!!" #
$str!!# 5
,!!5 6
tool!!7 ;
.!!; <
toolDescription!!< K
)!!K L
;!!L M
cmd"" 
."" 

Parameters"" 
."" 
Add"" "
(""" #
$str""# 6
,""6 7
tool""8 <
.""< =
toolManufacturer""= M
)""M N
;""N O
cmd## 
.## 

Parameters## 
.## 
Add## "
(##" #
$str### 0
,##0 1
tool##2 6
.##6 7

toolStatus##7 A
)##A B
;##B C
conn%% 
.%% 
Open%% 
(%% 
)%% 
;%% 
cmd&& 
.&& 
ExecuteNonQuery&& #
(&&# $
)&&$ %
;&&% &
}'' 
}(( 	
public** 
void** 

UpdateTool** 
(** 
Tool** #
tool**$ (
)**( )
{++ 	
using,, 
(,, 
OracleConnection,, #
conn,,$ (
=,,) *
new,,+ .
OracleConnection,,/ ?
(,,? @
connectionString,,@ P
),,P Q
),,Q R
{-- 
string.. 
sqlQuery.. 
=..  !
$str.." 5
+..6 7
$str//$ D
+//E F
$str00$ J
+00K L
$str11$ L
+11M N
$str22$ ?
+22@ A
$str33$ <
;33< =
OracleCommand55 
cmd55 !
=55" #
new55$ '
OracleCommand55( 5
(555 6
sqlQuery556 >
,55> ?
conn55@ D
)55D E
;55E F
cmd66 
.66 

Parameters66 
.66 
Add66 "
(66" #
$str66# 2
,662 3
tool664 8
.668 9
categoryCode669 E
)66E F
;66F G
cmd77 
.77 

Parameters77 
.77 
Add77 "
(77" #
$str77# 5
,775 6
tool777 ;
.77; <
toolDescription77< K
)77K L
;77L M
cmd88 
.88 

Parameters88 
.88 
Add88 "
(88" #
$str88# 6
,886 7
tool888 <
.88< =
toolManufacturer88= M
)88M N
;88N O
cmd99 
.99 

Parameters99 
.99 
Add99 "
(99" #
$str99# 0
,990 1
tool992 6
.996 7

toolStatus997 A
)99A B
;99B C
cmd:: 
.:: 

Parameters:: 
.:: 
Add:: "
(::" #
$str::# ,
,::, -
tool::. 2
.::2 3
toolID::3 9
)::9 :
;::: ;
conn<< 
.<< 
Open<< 
(<< 
)<< 
;<< 
cmd== 
.== 
ExecuteNonQuery== #
(==# $
)==$ %
;==% &
}>> 
}?? 	
publicAA 
voidAA 

RemoveToolAA 
(AA 
intAA "
toolIDAA# )
)AA) *
{BB 	
usingCC 
(CC 
OracleConnectionCC #
connCC$ (
=CC) *
newCC+ .
OracleConnectionCC/ ?
(CC? @
connectionStringCC@ P
)CCP Q
)CCQ R
{DD 
stringEE 
sqlQueryEE 
=EE  !
$strEE" \
;EE\ ]
OracleCommandFF 
cmdFF !
=FF" #
newFF$ '
OracleCommandFF( 5
(FF5 6
sqlQueryFF6 >
,FF> ?
connFF@ D
)FFD E
;FFE F
cmdGG 
.GG 

ParametersGG 
.GG 
AddGG "
(GG" #
$strGG# ,
,GG, -
toolIDGG. 4
)GG4 5
;GG5 6
connII 
.II 
OpenII 
(II 
)II 
;II 
cmdJJ 
.JJ 
ExecuteNonQueryJJ #
(JJ# $
)JJ$ %
;JJ% &
}KK 
}LL 	
publicNN 
intNN 
GetNextToolIDNN  
(NN  !
)NN! "
{OO 	
usingPP 
(PP 
OracleConnectionPP #
connPP$ (
=PP) *
newPP+ .
OracleConnectionPP/ ?
(PP? @
connectionStringPP@ P
)PPP Q
)PPQ R
{QQ 
stringRR 
sqlQueryRR 
=RR  !
$strRR" A
;RRA B
OracleCommandSS 
cmdSS !
=SS" #
newSS$ '
OracleCommandSS( 5
(SS5 6
sqlQuerySS6 >
,SS> ?
connSS@ D
)SSD E
;SSE F
connTT 
.TT 
OpenTT 
(TT 
)TT 
;TT 
objectVV 
resultVV 
=VV 
cmdVV  #
.VV# $
ExecuteScalarVV$ 1
(VV1 2
)VV2 3
;VV3 4
returnWW 
(WW 
resultWW 
==WW !
DBNullWW" (
.WW( )
ValueWW) .
)WW. /
?WW0 1
$numWW2 3
:WW4 5
ConvertWW6 =
.WW= >
ToInt32WW> E
(WWE F
resultWWF L
)WWL M
+WWN O
$numWWP Q
;WWQ R
}XX 
}YY 	
public[[ 
DataSet[[ 
GetFilteredTools[[ '
([[' (
string[[( .
toolIDAsString[[/ =
,[[= >
string[[? E
categoryCode[[F R
,[[R S
string[[T Z
description[[[ f
,[[f g
string[[h n
manufacturer[[o {
,[[{ |
string	[[} ƒ
status
[[„ Š
,
[[Š ‹
string
[[Œ ’
phrase
[[“ ™
)
[[™ š
{\\ 	
using]] 
(]] 
OracleConnection]] #
conn]]$ (
=]]) *
new]]+ .
OracleConnection]]/ ?
(]]? @
connectionString]]@ P
)]]P Q
)]]Q R
{^^ 
string__ 
sqlQuery__ 
=__  !
DetermineSQLQuery__" 3
(__3 4
toolIDAsString__4 B
,__B C
categoryCode__D P
,__P Q
description__R ]
,__] ^
manufacturer___ k
,__k l
status__m s
,__s t
phrase__u {
)__{ |
;__| }
OracleCommandaa 
cmdaa !
=aa" #
newaa$ '
OracleCommandaa( 5
(aa5 6
sqlQueryaa6 >
,aa> ?
connaa@ D
)aaD E
;aaE F
OracleDataAdapterbb !
dabb" $
=bb% &
newbb' *
OracleDataAdapterbb+ <
(bb< =
cmdbb= @
)bb@ A
;bbA B
DataSetdd 
dsdd 
=dd 
newdd  
DataSetdd! (
(dd( )
)dd) *
;dd* +
daee 
.ee 
Fillee 
(ee 
dsee 
,ee 
$stree "
)ee" #
;ee# $
returngg 
dsgg 
;gg 
}hh 
}ii 	
privatekk 
statickk 
Stringkk 
DetermineSQLQuerykk /
(kk/ 0
Stringkk0 6
toolIDAsStringkk7 E
,kkE F
StringkkG M
categoryCodekkN Z
,kkZ [
Stringkk\ b
descriptionkkc n
,kkn o
Stringkkp v
manufacturer	kkw ƒ
,
kkƒ „
String
kk… ‹
status
kkŒ ’
,
kk’ “
String
kk” š
phrase
kk› ¡
)
kk¡ ¢
{ll 	
Stringmm 
sqlQuerymm 
=mm 
$strmm  
;mm  !
ifoo 
(oo 
stringoo 
.oo 
IsNullOrEmptyoo $
(oo$ %
toolIDAsStringoo% 3
)oo3 4
&&oo5 7
Stringoo8 >
.oo> ?
IsNullOrEmptyoo? L
(ooL M
categoryCodeooM Y
)ooY Z
&&oo[ ]
stringoo^ d
.ood e
IsNullOrEmptyooe r
(oor s
descriptionoos ~
)oo~ 
&&
oo€ ‚
string
ooƒ ‰
.
oo‰ Š
IsNullOrEmpty
ooŠ —
(
oo— ˜
manufacturer
oo˜ ¤
)
oo¤ ¥
&&
oo¦ ¨
string
oo© ¯
.
oo¯ °
IsNullOrEmpty
oo° ½
(
oo½ ¾
status
oo¾ Ä
)
ooÄ Å
&&
ooÆ È
string
ooÉ Ï
.
ooÏ Ð
IsNullOrEmpty
ooÐ Ý
(
ooÝ Þ
phrase
ooÞ ä
)
ooä å
)
ooå æ
{pp 
sqlQueryqq 
=qq 
$strqq r
;qqr s
}rr 
elsess 
ifss 
(ss 
!ss 
stringss 
.ss 
IsNullOrEmptyss *
(ss* +
toolIDAsStringss+ 9
)ss9 :
||ss; =
!ss> ?
stringss? E
.ssE F
IsNullOrEmptyssF S
(ssS T
categoryCodessT `
)ss` a
||ssb d
!sse f
stringssf l
.ssl m
IsNullOrEmptyssm z
(ssz {
description	ss{ †
)
ss† ‡
||
ssˆ Š
!
ss‹ Œ
string
ssŒ ’
.
ss’ “
IsNullOrEmpty
ss“  
(
ss  ¡
manufacturer
ss¡ ­
)
ss­ ®
||
ss¯ ±
!
ss² ³
string
ss³ ¹
.
ss¹ º
IsNullOrEmpty
ssº Ç
(
ssÇ È
status
ssÈ Î
)
ssÎ Ï
||
ssÐ Ò
!
ssÓ Ô
string
ssÔ Ú
.
ssÚ Û
IsNullOrEmpty
ssÛ è
(
ssè é
phrase
ssé ï
)
ssï ð
)
ssð ñ
{tt 
sqlQueryuu 
=uu 
$struu ~
;uu~ 
ifww 
(ww 
!ww 
stringww 
.ww 
IsNullOrEmptyww )
(ww) *
toolIDAsStringww* 8
)ww8 9
)ww9 :
{xx 
intyy 
toolIDyy 
=yy  
Convertyy! (
.yy( )
ToInt32yy) 0
(yy0 1
toolIDAsStringyy1 ?
)yy? @
;yy@ A
sqlQueryzz 
+=zz 
$strzz  0
+zz1 2
toolIDzz3 9
;zz9 :
}{{ 
if}} 
(}} 
!}} 
string}} 
.}} 
IsNullOrEmpty}} )
(}}) *
categoryCode}}* 6
)}}6 7
)}}7 8
{~~ 
categoryCode  
=! "
categoryCode# /
./ 0
	Substring0 9
(9 :
$num: ;
,; <
$num= >
)> ?
;? @
sqlQuery
€€ 
+=
€€ 
$str
€€  G
+
€€H I
categoryCode
€€J V
+
€€W X
$str
€€Y ]
;
€€] ^
}
 
if
ƒƒ 
(
ƒƒ 
!
ƒƒ 
string
ƒƒ 
.
ƒƒ 
IsNullOrEmpty
ƒƒ )
(
ƒƒ) *
description
ƒƒ* 5
)
ƒƒ5 6
)
ƒƒ6 7
{
„„ 
sqlQuery
…… 
+=
…… 
$str
……  K
+
……L M
description
……N Y
+
……Z [
$str
……\ a
;
……a b
}
†† 
if
ˆˆ 
(
ˆˆ 
!
ˆˆ 
string
ˆˆ 
.
ˆˆ 
IsNullOrEmpty
ˆˆ )
(
ˆˆ) *
manufacturer
ˆˆ* 6
)
ˆˆ6 7
)
ˆˆ7 8
{
‰‰ 
sqlQuery
ŠŠ 
+=
ŠŠ 
$str
ŠŠ  L
+
ŠŠM N
manufacturer
ŠŠO [
+
ŠŠ\ ]
$str
ŠŠ^ c
;
ŠŠc d
}
‹‹ 
if
 
(
 
!
 
string
 
.
 
IsNullOrEmpty
 )
(
) *
status
* 0
)
0 1
)
1 2
{
ŽŽ 
status
 
=
 
status
 #
.
# $
	Substring
$ -
(
- .
$num
. /
,
/ 0
$num
1 2
)
2 3
;
3 4
sqlQuery
 
+=
 
$str
  5
+
6 7
status
8 >
+
? @
$str
A D
;
D E
}
‘‘ 
if
““ 
(
““ 
!
““ 
string
““ 
.
““ 
IsNullOrEmpty
““ )
(
““) *
phrase
““* 0
)
““0 1
)
““1 2
{
”” 
sqlQuery
•• 
+=
•• 
$str
••  I
+
••J K
phrase
••L R
+
••S T
$str
••U [
+
••\ ]
$str
–– A
+
––B C
phrase
––D J
+
––K L
$str
––M S
+
––T U
$str
—— B
+
——C D
phrase
——E K
+
——L M
$str
——N T
;
——T U
}
˜˜ 
}
™™ 
return
šš 
sqlQuery
šš 
;
šš 
}
›› 	
public
žž 
DataSet
žž 
GetAvailableTools
žž (
(
žž( )
)
žž) *
{
ŸŸ 	
using
   
(
   
OracleConnection
   #
conn
  $ (
=
  ) *
new
  + .
OracleConnection
  / ?
(
  ? @
connectionString
  @ P
)
  P Q
)
  Q R
{
¡¡ 
string
¢¢ 
sqlQuery
¢¢ 
=
¢¢  !
$str
¢¢" n
+
¢¢o p
$str
££ (
;
££( )
OracleCommand
¥¥ 
cmd
¥¥ !
=
¥¥" #
new
¥¥$ '
OracleCommand
¥¥( 5
(
¥¥5 6
sqlQuery
¥¥6 >
,
¥¥> ?
conn
¥¥@ D
)
¥¥D E
;
¥¥E F
OracleDataAdapter
¦¦ !
da
¦¦" $
=
¦¦% &
new
¦¦' *
OracleDataAdapter
¦¦+ <
(
¦¦< =
cmd
¦¦= @
)
¦¦@ A
;
¦¦A B
DataSet
¨¨ 
ds
¨¨ 
=
¨¨ 
new
¨¨  
DataSet
¨¨! (
(
¨¨( )
)
¨¨) *
;
¨¨* +
da
©© 
.
©© 
Fill
©© 
(
©© 
ds
©© 
,
©© 
$str
©© "
)
©©" #
;
©©# $
return
«« 
ds
«« 
;
«« 
}
¬¬ 
}
­­ 	
public
¯¯ 
DataSet
¯¯ 
GetRentableTools
¯¯ '
(
¯¯' (
string
¯¯( .
categoryCode
¯¯/ ;
,
¯¯; <
DateTime
¯¯= E
from
¯¯F J
,
¯¯J K
DateTime
¯¯L T
to
¯¯U W
)
¯¯W X
{
°° 	
using
±± 
(
±± 
OracleConnection
±± #
conn
±±$ (
=
±±) *
new
±±+ .
OracleConnection
±±/ ?
(
±±? @
connectionString
±±@ P
)
±±P Q
)
±±Q R
{
²² 
string
³³ 
sqlQuery
³³ 
=
³³  !
$str
³½" 
;
½½ 
using
¿¿ 
(
¿¿ 
OracleCommand
¿¿ $
cmd
¿¿% (
=
¿¿) *
new
¿¿+ .
OracleCommand
¿¿/ <
(
¿¿< =
sqlQuery
¿¿= E
,
¿¿E F
conn
¿¿G K
)
¿¿K L
)
¿¿L M
{
ÀÀ 
cmd
ÁÁ 
.
ÁÁ 

Parameters
ÁÁ "
.
ÁÁ" #
Add
ÁÁ# &
(
ÁÁ& '
new
ÁÁ' *
OracleParameter
ÁÁ+ :
(
ÁÁ: ;
$str
ÁÁ; J
,
ÁÁJ K
categoryCode
ÁÁL X
)
ÁÁX Y
)
ÁÁY Z
;
ÁÁZ [
cmd
ÂÂ 
.
ÂÂ 

Parameters
ÂÂ "
.
ÂÂ" #
Add
ÂÂ# &
(
ÂÂ& '
new
ÂÂ' *
OracleParameter
ÂÂ+ :
(
ÂÂ: ;
$str
ÂÂ; F
,
ÂÂF G
from
ÂÂH L
.
ÂÂL M
ToString
ÂÂM U
(
ÂÂU V
$str
ÂÂV a
)
ÂÂa b
)
ÂÂb c
)
ÂÂc d
;
ÂÂd e
cmd
ÃÃ 
.
ÃÃ 

Parameters
ÃÃ "
.
ÃÃ" #
Add
ÃÃ# &
(
ÃÃ& '
new
ÃÃ' *
OracleParameter
ÃÃ+ :
(
ÃÃ: ;
$str
ÃÃ; D
,
ÃÃD E
to
ÃÃF H
.
ÃÃH I
ToString
ÃÃI Q
(
ÃÃQ R
$str
ÃÃR ]
)
ÃÃ] ^
)
ÃÃ^ _
)
ÃÃ_ `
;
ÃÃ` a
OracleDataAdapter
ÅÅ %
da
ÅÅ& (
=
ÅÅ) *
new
ÅÅ+ .
OracleDataAdapter
ÅÅ/ @
(
ÅÅ@ A
cmd
ÅÅA D
)
ÅÅD E
;
ÅÅE F
DataSet
ÆÆ 
ds
ÆÆ 
=
ÆÆ  
new
ÆÆ! $
DataSet
ÆÆ% ,
(
ÆÆ, -
)
ÆÆ- .
;
ÆÆ. /
da
ÇÇ 
.
ÇÇ 
Fill
ÇÇ 
(
ÇÇ 
ds
ÇÇ 
,
ÇÇ 
$str
ÇÇ  &
)
ÇÇ& '
;
ÇÇ' (
return
ÉÉ 
ds
ÉÉ 
;
ÉÉ 
}
ÊÊ 
}
ËË 
}
ÌÌ 	
public
ÍÍ 
bool
ÍÍ 

ToolExists
ÍÍ 
(
ÍÍ 
int
ÍÍ "
toolID
ÍÍ# )
)
ÍÍ) *
{
ÎÎ 	
using
ÏÏ 
(
ÏÏ 
OracleConnection
ÏÏ #
conn
ÏÏ$ (
=
ÏÏ) *
new
ÏÏ+ .
OracleConnection
ÏÏ/ ?
(
ÏÏ? @
connectionString
ÏÏ@ P
)
ÏÏP Q
)
ÏÏQ R
{
ÐÐ 
string
ÑÑ 
sqlQuery
ÑÑ 
=
ÑÑ  !
$str
ÑÑ" j
;
ÑÑj k
OracleCommand
ÒÒ 
cmd
ÒÒ !
=
ÒÒ" #
new
ÒÒ$ '
OracleCommand
ÒÒ( 5
(
ÒÒ5 6
sqlQuery
ÒÒ6 >
,
ÒÒ> ?
conn
ÒÒ@ D
)
ÒÒD E
;
ÒÒE F
cmd
ÓÓ 
.
ÓÓ 

Parameters
ÓÓ 
.
ÓÓ 
Add
ÓÓ "
(
ÓÓ" #
$str
ÓÓ# ,
,
ÓÓ, -
toolID
ÓÓ. 4
)
ÓÓ4 5
;
ÓÓ5 6
conn
ÕÕ 
.
ÕÕ 
Open
ÕÕ 
(
ÕÕ 
)
ÕÕ 
;
ÕÕ 
int
ÖÖ 
count
ÖÖ 
=
ÖÖ 
Convert
ÖÖ #
.
ÖÖ# $
ToInt32
ÖÖ$ +
(
ÖÖ+ ,
cmd
ÖÖ, /
.
ÖÖ/ 0
ExecuteScalar
ÖÖ0 =
(
ÖÖ= >
)
ÖÖ> ?
)
ÖÖ? @
;
ÖÖ@ A
conn
×× 
.
×× 
Close
×× 
(
×× 
)
×× 
;
×× 
return
ÙÙ 
count
ÙÙ 
>
ÙÙ 
$num
ÙÙ  
;
ÙÙ  !
}
ÚÚ 
}
ÛÛ 	
}
ÝÝ 
}ÞÞ ¦
GC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\RentalItemData.cs
	namespace 	
ToolSYS
 
. 
Data 
{ 
public 

class 
RentalItemData 
{ 
private		 
readonly		 
string		 
_connectionString		  1
=		2 3
	DBConnect		4 =
.		= >
oradb		> C
;		C D
public 
void 
AddRentalItem !
(! "

RentalItem" ,

rentalItem- 7
)7 8
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
_connectionString3 D
)D E
)E F
{ 
conn 
. 
Open 
( 
) 
; 
string 
	sqlInsert  
=! "
$str# T
;T U
var 
cmd 
= 
new 
OracleCommand +
(+ ,
	sqlInsert, 5
,5 6
conn7 ;
); <
;< =
cmd 
. 

Parameters 
. 
Add "
(" #
$str# .
,. /
OracleDbType0 <
.< =
Int32= B
)B C
.C D
ValueD I
=J K

rentalItemL V
.V W
rentalIDW _
;_ `
cmd 
. 

Parameters 
. 
Add "
(" #
$str# ,
,, -
OracleDbType. :
.: ;
Int32; @
)@ A
.A B
ValueB G
=H I

rentalItemJ T
.T U
toolIDU [
;[ \
cmd 
. 

Parameters 
. 
Add "
(" #
$str# .
,. /
OracleDbType0 <
.< =
Date= A
)A B
.B C
ValueC H
=I J

rentalItemK U
.U V
rentDateV ^
;^ _
cmd 
. 

Parameters 
. 
Add "
(" #
$str# 0
,0 1
OracleDbType2 >
.> ?
Date? C
)C D
.D E
ValueE J
=K L

rentalItemM W
.W X

returnDateX b
;b c
cmd 
. 

Parameters 
. 
Add "
(" #
$str# /
,/ 0
OracleDbType1 =
.= >
Decimal> E
)E F
.F G
ValueG L
=M N

rentalItemO Y
.Y Z
	rentalFeeZ c
;c d
cmd 
. 
ExecuteNonQuery #
(# $
)$ %
;% &
string 
sqlUpdateStatus &
=' (
$str) c
;c d
cmd!! 
=!! 
new!! 
OracleCommand!! '
(!!' (
sqlUpdateStatus!!( 7
,!!7 8
conn!!9 =
)!!= >
;!!> ?
cmd"" 
."" 

Parameters"" 
."" 
Add"" "
(""" #
$str""# ,
,"", -
OracleDbType"". :
."": ;
Int32""; @
)""@ A
.""A B
Value""B G
=""H I

rentalItem""J T
.""T U
toolID""U [
;""[ \
cmd$$ 
.$$ 
ExecuteNonQuery$$ #
($$# $
)$$$ %
;$$% &
}%% 
}&& 	
}'' 
}(( ´3
CC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\RentalData.cs
	namespace

 	
ToolSYS


 
.

 
Data

 
{ 
public 

class 

RentalData 
{ 
public 
static 
int 
GetNextRentalID )
() *
)* +
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
	DBConnect3 <
.< =
oradb= B
)B C
)C D
{ 
conn 
. 
Open 
( 
) 
; 
string 
sqlQuery 
=  !
$str" Q
;Q R
var 
cmd 
= 
new 
OracleCommand +
(+ ,
sqlQuery, 4
,4 5
conn6 :
): ;
;; <
return 
Convert 
. 
ToInt32 &
(& '
cmd' *
.* +
ExecuteScalar+ 8
(8 9
)9 :
): ;
;; <
} 
} 	
public 
static 
void 
	AddRental $
($ %
Rental% +
rental, 2
)2 3
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
	DBConnect3 <
.< =
oradb= B
)B C
)C D
{ 
conn 
. 
Open 
( 
) 
; 
string 
sqlQuery 
=  !
$str " Q
;  Q R
var"" 
cmd"" 
="" 
new"" 
OracleCommand"" +
(""+ ,
sqlQuery"", 4
,""4 5
conn""6 :
)"": ;
;""; <
cmd## 
.## 

Parameters## 
.## 
Add## "
(##" #
$str### .
,##. /
rental##0 6
.##6 7
rentalID##7 ?
)##? @
;##@ A
cmd$$ 
.$$ 

Parameters$$ 
.$$ 
Add$$ "
($$" #
$str$$# 0
,$$0 1
rental$$2 8
.$$8 9

customerID$$9 C
)$$C D
;$$D E
cmd%% 
.%% 

Parameters%% 
.%% 
Add%% "
(%%" #
$str%%# 5
,%%5 6
rental%%7 =
.%%= >
transactionDate%%> M
)%%M N
;%%N O
cmd&& 
.&& 

Parameters&& 
.&& 
Add&& "
(&&" #
$str&&# .
,&&. /
rental&&0 6
.&&6 7
totalFee&&7 ?
)&&? @
;&&@ A
cmd'' 
.'' 
ExecuteNonQuery'' #
(''# $
)''$ %
;''% &
}(( 
})) 	
public++ 
static++ 
	DataTable++ $
GetRentalItemsByRentalID++  8
(++8 9
int++9 <
rentalID++= E
)++E F
{,, 	
using-- 
(-- 
var-- 
conn-- 
=-- 
new-- !
OracleConnection--" 2
(--2 3
	DBConnect--3 <
.--< =
oradb--= B
)--B C
)--C D
{.. 
string// 
query// 
=// 
$str/4 V
;44V W
OracleCommand66 
cmd66 !
=66" #
new66$ '
OracleCommand66( 5
(665 6
query666 ;
,66; <
conn66= A
)66A B
;66B C
cmd77 
.77 

Parameters77 
.77 
Add77 "
(77" #
$str77# .
,77. /
rentalID770 8
)778 9
;779 :
OracleDataAdapter99 !
adapter99" )
=99* +
new99, /
OracleDataAdapter990 A
(99A B
cmd99B E
)99E F
;99F G
	DataTable:: 
dt:: 
=:: 
new:: "
	DataTable::# ,
(::, -
)::- .
;::. /
adapter;; 
.;; 
Fill;; 
(;; 
dt;; 
);;  
;;;  !
return== 
dt== 
;== 
}>> 
}?? 	
publicAA 
staticAA 
voidAA 

ReturnToolAA %
(AA% &
intAA& )
rentalIDAA* 2
,AA2 3
intAA4 7
toolIDAA8 >
)AA> ?
{BB 	
usingCC 
(CC 
varCC 
connCC 
=CC 
newCC !
OracleConnectionCC" 2
(CC2 3
	DBConnectCC3 <
.CC< =
oradbCC= B
)CCB C
)CCC D
{DD 
connEE 
.EE 
OpenEE 
(EE 
)EE 
;EE 
stringGG 
updateToolQueryGG &
=GG' (
$strGG) c
;GGc d
OracleCommandHH 
updateToolCmdHH +
=HH, -
newHH. 1
OracleCommandHH2 ?
(HH? @
updateToolQueryHH@ O
,HHO P
connHHQ U
)HHU V
;HHV W
updateToolCmdII 
.II 

ParametersII (
.II( )
AddII) ,
(II, -
$strII- 6
,II6 7
toolIDII8 >
)II> ?
;II? @
updateToolCmdJJ 
.JJ 
ExecuteNonQueryJJ -
(JJ- .
)JJ. /
;JJ/ 0
stringLL !
updateRentalItemQueryLL ,
=LL- .
$strLO/ D
;OOD E
OracleCommandPP 
updateRentalCmdPP -
=PP. /
newPP0 3
OracleCommandPP4 A
(PPA B!
updateRentalItemQueryPPB W
,PPW X
connPPY ]
)PP] ^
;PP^ _
updateRentalCmdQQ 
.QQ  

ParametersQQ  *
.QQ* +
AddQQ+ .
(QQ. /
$strQQ/ :
,QQ: ;
rentalIDQQ< D
)QQD E
;QQE F
updateRentalCmdRR 
.RR  

ParametersRR  *
.RR* +
AddRR+ .
(RR. /
$strRR/ 8
,RR8 9
toolIDRR: @
)RR@ A
;RRA B
updateRentalCmdSS 
.SS  
ExecuteNonQuerySS  /
(SS/ 0
)SS0 1
;SS1 2
}TT 
}UU 	
}VV 
}WW Ï=
AC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\RateData.cs
	namespace 	
ToolSYS
 
. 
Data 
{ 
public 

class 
RateData 
{ 
private		 
readonly		 
string		 
_connectionString		  1
=		2 3
	DBConnect		4 =
.		= >
oradb		> C
;		C D
public 
void 
AddRate 
( 
Rate  
rate! %
)% &
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
_connectionString3 D
)D E
)E F
{ 
string 
sqlQuery 
=  !
$str	" …
;
… †
OracleCommand 
cmd !
=" #
new$ '
OracleCommand( 5
(5 6
sqlQuery6 >
,> ?
conn@ D
)D E
;E F
cmd 
. 

Parameters 
. 
Add "
(" #
$str# 2
,2 3
rate4 8
.8 9
categoryCode9 E
)E F
;F G
cmd 
. 

Parameters 
. 
Add "
(" #
$str# 2
,2 3
rate4 8
.8 9
categoryDesc9 E
)E F
;F G
cmd 
. 

Parameters 
. 
Add "
(" #
$str# *
,* +
rate, 0
.0 1
rate1 5
)5 6
;6 7
conn 
. 
Open 
( 
) 
; 
cmd 
. 
ExecuteNonQuery #
(# $
)$ %
;% &
} 
} 	
public 
Rate !
GetRateByCategoryCode )
() *
string* 0
categoryCode1 =
)= >
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
_connectionString3 D
)D E
)E F
{ 
string 
sqlQuery 
=  !
$str k
;k l
OracleCommand   
cmd   !
=  " #
new  $ '
OracleCommand  ( 5
(  5 6
sqlQuery  6 >
,  > ?
conn  @ D
)  D E
;  E F
cmd!! 
.!! 

Parameters!! 
.!! 
Add!! "
(!!" #
$str!!# 2
,!!2 3
categoryCode!!4 @
)!!@ A
;!!A B
conn## 
.## 
Open## 
(## 
)## 
;## 
OracleDataReader$$  
dr$$! #
=$$$ %
cmd$$& )
.$$) *
ExecuteReader$$* 7
($$7 8
)$$8 9
;$$9 :
dr&& 
.&& 
Read&& 
(&& 
)&& 
;&& 
return'' 
new'' 
Rate'' 
{(( 
categoryCode))  
=))! "
dr))# %
.))% &
	GetString))& /
())/ 0
$num))0 1
)))1 2
,))2 3
categoryDesc**  
=**! "
dr**# %
.**% &
	GetString**& /
(**/ 0
$num**0 1
)**1 2
,**2 3
rate++ 
=++ 
dr++ 
.++ 

GetDecimal++ (
(++( )
$num++) *
)++* +
},, 
;,, 
}-- 
}.. 	
public00 
void00 

UpdateRate00 
(00 
Rate00 #
rate00$ (
)00( )
{11 	
using22 
(22 
var22 
conn22 
=22 
new22 !
OracleConnection22" 2
(222 3
_connectionString223 D
)22D E
)22E F
{33 
string44 
sqlQuery44 
=44  !
$str	44" ‚
;
44‚ ƒ
OracleCommand55 
cmd55 !
=55" #
new55$ '
OracleCommand55( 5
(555 6
sqlQuery556 >
,55> ?
conn55@ D
)55D E
;55E F
cmd66 
.66 

Parameters66 
.66 
Add66 "
(66" #
$str66# 2
,662 3
rate664 8
.668 9
categoryDesc669 E
)66E F
;66F G
cmd77 
.77 

Parameters77 
.77 
Add77 "
(77" #
$str77# *
,77* +
rate77, 0
.770 1
rate771 5
)775 6
;776 7
cmd88 
.88 

Parameters88 
.88 
Add88 "
(88" #
$str88# 2
,882 3
rate884 8
.888 9
categoryCode889 E
)88E F
;88F G
conn:: 
.:: 
Open:: 
(:: 
):: 
;:: 
cmd;; 
.;; 
ExecuteNonQuery;; #
(;;# $
);;$ %
;;;% &
}<< 
}== 	
public?? 
DataSet?? 
GetAllCategories?? '
(??' (
)??( )
{@@ 	
usingAA 
(AA 
varAA 
connAA 
=AA 
newAA !
OracleConnectionAA" 2
(AA2 3
_connectionStringAA3 D
)AAD E
)AAE F
{BB 
stringCC 
sqlQueryCC 
=CC  !
$strCC" M
;CCM N
OracleDataAdapterDD !
daDD" $
=DD% &
newDD' *
OracleDataAdapterDD+ <
(DD< =
sqlQueryDD= E
,DDE F
connDDG K
)DDK L
;DDL M
DataSetFF 
dsFF 
=FF 
newFF  
DataSetFF! (
(FF( )
)FF) *
;FF* +
daGG 
.GG 
FillGG 
(GG 
dsGG 
,GG 
$strGG #
)GG# $
;GG$ %
returnII 
dsII 
;II 
}JJ 
}KK 	
publicMM 
boolMM !
DoesCategoryCodeExistMM )
(MM) *
stringMM* 0
categoryCodeMM1 =
)MM= >
{NN 	
usingOO 
(OO 
varOO 
connOO 
=OO 
newOO !
OracleConnectionOO" 2
(OO2 3
_connectionStringOO3 D
)OOD E
)OOE F
{PP 
stringQQ 
sqlQueryQQ 
=QQ  !
$strQQ" a
;QQa b
varRR 
cmdRR 
=RR 
newRR 
OracleCommandRR +
(RR+ ,
sqlQueryRR, 4
,RR4 5
connRR6 :
)RR: ;
;RR; <
cmdSS 
.SS 

ParametersSS 
.SS 
AddSS "
(SS" #
$strSS# 2
,SS2 3
OracleDbTypeSS4 @
.SS@ A
Varchar2SSA I
)SSI J
.SSJ K
ValueSSK P
=SSQ R
categoryCodeSSS _
;SS_ `
connUU 
.UU 
OpenUU 
(UU 
)UU 
;UU 
intVV 
countVV 
=VV 
ConvertVV #
.VV# $
ToInt32VV$ +
(VV+ ,
cmdVV, /
.VV/ 0
ExecuteScalarVV0 =
(VV= >
)VV> ?
)VV? @
;VV@ A
connWW 
.WW 
CloseWW 
(WW 
)WW 
;WW 
returnYY 
countYY 
>YY 
$numYY  
;YY  !
}ZZ 
}[[ 	
}\\ 
}]] ö
BC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\DBConnect.cs
	namespace 	
ToolSYS
 
{ 
public 

static 
class 
	DBConnect !
{ 
public 
const 
String 
oradb !
=" #
$str$ y
;y z
} 
} ‰
EC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\CustomerData.cs
	namespace

 	
ToolSYS


 
.

 
Data

 
{ 
public 

class 
CustomerData 
{ 
private 
readonly 
string 
_connectionString  1
=2 3
	DBConnect4 =
.= >
oradb> C
;C D
public 
int 
GetNextCustomerID $
($ %
)% &
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
_connectionString3 D
)D E
)E F
{ 
string 
sqlQuery 
=  !
$str" I
;I J
var 
cmd 
= 
new 
OracleCommand +
(+ ,
sqlQuery, 4
,4 5
conn6 :
): ;
;; <
conn 
. 
Open 
( 
) 
; 
int 
nextCustomerID "
=# $
cmd% (
.( )
ExecuteScalar) 6
(6 7
)7 8
==9 ;
DBNull< B
.B C
ValueC H
?I J
$numK L
:M N
ConvertO V
.V W
ToInt32W ^
(^ _
cmd_ b
.b c
ExecuteScalarc p
(p q
)q r
)r s
+t u
$numv w
;w x
conn 
. 
Close 
( 
) 
; 
return 
nextCustomerID %
;% &
} 
} 	
public 
void 
AddCustomer 
(  
Customer  (
customer) 1
)1 2
{   	
using!! 
(!! 
var!! 
conn!! 
=!! 
new!! !
OracleConnection!!" 2
(!!2 3
_connectionString!!3 D
)!!D E
)!!E F
{"" 
string## 
sqlQuery## 
=##  !
$str##" q
+##r s
$str$$" g
;$$g h
var&& 
cmd&& 
=&& 
new&& 
OracleCommand&& +
(&&+ ,
sqlQuery&&, 4
,&&4 5
conn&&6 :
)&&: ;
;&&; <
cmd'' 
.'' 

Parameters'' 
.'' 
Add'' "
(''" #
$str''# 0
,''0 1
OracleDbType''2 >
.''> ?
Int32''? D
)''D E
.''E F
Value''F K
=''L M
customer''N V
.''V W

customerID''W a
;''a b
cmd(( 
.(( 

Parameters(( 
.(( 
Add(( "
(((" #
$str((# .
,((. /
OracleDbType((0 <
.((< =
Varchar2((= E
)((E F
.((F G
Value((G L
=((M N
customer((O W
.((W X
forename((X `
;((` a
cmd)) 
.)) 

Parameters)) 
.)) 
Add)) "
())" #
$str))# -
,))- .
OracleDbType))/ ;
.)); <
Varchar2))< D
)))D E
.))E F
Value))F K
=))L M
customer))N V
.))V W
surname))W ^
;))^ _
cmd** 
.** 

Parameters** 
.** 
Add** "
(**" #
$str**# +
,**+ ,
OracleDbType**- 9
.**9 :
Varchar2**: B
)**B C
.**C D
Value**D I
=**J K
customer**L T
.**T U
email**U Z
;**Z [
cmd++ 
.++ 

Parameters++ 
.++ 
Add++ "
(++" #
$str++# +
,+++ ,
OracleDbType++- 9
.++9 :
Varchar2++: B
)++B C
.++C D
Value++D I
=++J K
customer++L T
.++T U
phone++U Z
;++Z [
cmd,, 
.,, 

Parameters,, 
.,, 
Add,, "
(,," #
$str,,# -
,,,- .
OracleDbType,,/ ;
.,,; <
Varchar2,,< D
),,D E
.,,E F
Value,,F K
=,,L M
customer,,N V
.,,V W
eircode,,W ^
;,,^ _
conn.. 
... 
Open.. 
(.. 
).. 
;.. 
cmd// 
.// 
ExecuteNonQuery// #
(//# $
)//$ %
;//% &
conn00 
.00 
Close00 
(00 
)00 
;00 
}11 
}22 	
public44 
void44 
UpdateCustomer44 "
(44" #
Customer44# +
customer44, 4
)444 5
{55 	
using66 
(66 
var66 
conn66 
=66 
new66 !
OracleConnection66" 2
(662 3
_connectionString663 D
)66D E
)66E F
{77 
string88 
sqlQuery88 
=88  !
$str	88" –
+
88— ˜
$str99" B
;99B C
var;; 
cmd;; 
=;; 
new;; 
OracleCommand;; +
(;;+ ,
sqlQuery;;, 4
,;;4 5
conn;;6 :
);;: ;
;;;; <
cmd<< 
.<< 

Parameters<< 
.<< 
Add<< "
(<<" #
$str<<# 0
,<<0 1
OracleDbType<<2 >
.<<> ?
Int32<<? D
)<<D E
.<<E F
Value<<F K
=<<L M
customer<<N V
.<<V W

customerID<<W a
;<<a b
cmd== 
.== 

Parameters== 
.== 
Add== "
(==" #
$str==# .
,==. /
OracleDbType==0 <
.==< =
Varchar2=== E
)==E F
.==F G
Value==G L
===M N
customer==O W
.==W X
forename==X `
;==` a
cmd>> 
.>> 

Parameters>> 
.>> 
Add>> "
(>>" #
$str>># -
,>>- .
OracleDbType>>/ ;
.>>; <
Varchar2>>< D
)>>D E
.>>E F
Value>>F K
=>>L M
customer>>N V
.>>V W
surname>>W ^
;>>^ _
cmd?? 
.?? 

Parameters?? 
.?? 
Add?? "
(??" #
$str??# +
,??+ ,
OracleDbType??- 9
.??9 :
Varchar2??: B
)??B C
.??C D
Value??D I
=??J K
customer??L T
.??T U
email??U Z
;??Z [
cmd@@ 
.@@ 

Parameters@@ 
.@@ 
Add@@ "
(@@" #
$str@@# +
,@@+ ,
OracleDbType@@- 9
.@@9 :
Varchar2@@: B
)@@B C
.@@C D
Value@@D I
=@@J K
customer@@L T
.@@T U
phone@@U Z
;@@Z [
cmdAA 
.AA 

ParametersAA 
.AA 
AddAA "
(AA" #
$strAA# -
,AA- .
OracleDbTypeAA/ ;
.AA; <
Varchar2AA< D
)AAD E
.AAE F
ValueAAF K
=AAL M
customerAAN V
.AAV W
eircodeAAW ^
;AA^ _
connCC 
.CC 
OpenCC 
(CC 
)CC 
;CC 
cmdDD 
.DD 
ExecuteNonQueryDD #
(DD# $
)DD$ %
;DD% &
connEE 
.EE 
CloseEE 
(EE 
)EE 
;EE 
}FF 
}GG 	
publicII 
DataSetII 
SearchCustomersII &
(II& '
stringII' -
searchPhraseII. :
)II: ;
{JJ 	
usingKK 
(KK 
varKK 
connKK 
=KK 
newKK !
OracleConnectionKK" 2
(KK2 3
_connectionStringKK3 D
)KKD E
)KKE F
{LL 
stringMM 
sqlQueryMM 
=MM  !
$strMM" `
+MMa b
$str	NN" ƒ
+
NN„ …
$str	OO" ‘
;
OO‘ ’
varQQ 
cmdQQ 
=QQ 
newQQ 
OracleCommandQQ +
(QQ+ ,
sqlQueryQQ, 4
,QQ4 5
connQQ6 :
)QQ: ;
;QQ; <
cmdRR 
.RR 

ParametersRR 
.RR 
AddRR "
(RR" #
$strRR# ,
,RR, -
OracleDbTypeRR. :
.RR: ;
Varchar2RR; C
)RRC D
.RRD E
ValueRRE J
=RRK L
$"RRM O
$strRRO P
{RRP Q
searchPhraseRRQ ]
}RR] ^
$strRR^ _
"RR_ `
;RR` a
OracleDataAdapterTT !
daTT" $
=TT% &
newTT' *
OracleDataAdapterTT+ <
(TT< =
cmdTT= @
)TT@ A
;TTA B
DataSetUU 
dsUU 
=UU 
newUU  
DataSetUU! (
(UU( )
)UU) *
;UU* +
daVV 
.VV 
FillVV 
(VV 
dsVV 
,VV 
$strVV &
)VV& '
;VV' (
returnWW 
dsWW 
;WW 
}XX 
}YY 	
public\\ 
DataSet\\  
GetFilteredCustomers\\ +
(\\+ ,
String\\, 2
custIDAsString\\3 A
,\\A B
String\\C I
forename\\J R
,\\R S
String\\T Z
surname\\[ b
,\\b c
String\\d j
email\\k p
,\\p q
String\\r x
phone\\y ~
,\\~ 
String
\\€ †
eircode
\\‡ Ž
,
\\Ž 
String
\\ –
phrase
\\— 
)
\\ ž
{]] 	
OracleConnection^^ 
conn^^ !
=^^" #
new^^$ '
OracleConnection^^( 8
(^^8 9
	DBConnect^^9 B
.^^B C
oradb^^C H
)^^H I
;^^I J
String`` 
sqlQuery`` 
=`` 
DetermineSQLQuery`` /
(``/ 0
custIDAsString``0 >
,``> ?
forename``@ H
,``H I
surname``J Q
,``Q R
email``S X
,``X Y
phone``Z _
,``_ `
eircode``a h
,``h i
phrase``j p
)``p q
;``q r
OracleCommandbb 
cmdbb 
=bb 
newbb  #
OracleCommandbb$ 1
(bb1 2
sqlQuerybb2 :
,bb: ;
connbb< @
)bb@ A
;bbA B
OracleDataAdapterdd 
dadd  
=dd! "
newdd# &
OracleDataAdapterdd' 8
(dd8 9
cmddd9 <
)dd< =
;dd= >
DataSetff 
dsff 
=ff 
newff 
DataSetff $
(ff$ %
)ff% &
;ff& '
dagg 
.gg 
Fillgg 
(gg 
dsgg 
,gg 
$strgg "
)gg" #
;gg# $
connii 
.ii 
Closeii 
(ii 
)ii 
;ii 
returnkk 
dskk 
;kk 
}mm 	
privatenn 
staticnn 
Stringnn 
DetermineSQLQuerynn /
(nn/ 0
Stringnn0 6
custIDAsStringnn7 E
,nnE F
StringnnG M
forenamennN V
,nnV W
StringnnX ^
surnamenn_ f
,nnf g
Stringnnh n
emailnno t
,nnt u
Stringnnv |
phone	nn} ‚
,
nn‚ ƒ
String
nn„ Š
eircode
nn‹ ’
,
nn’ “
String
nn” š
phrase
nn› ¡
)
nn¡ ¢
{oo 	
Stringpp 
sqlQuerypp 
=pp 
$strpp  
;pp  !
ifrr 
(rr 
stringrr 
.rr 
IsNullOrEmptyrr $
(rr$ %
custIDAsStringrr% 3
)rr3 4
&&rr5 7
Stringrr8 >
.rr> ?
IsNullOrEmptyrr? L
(rrL M
forenamerrM U
)rrU V
&&rrW Y
stringrrZ `
.rr` a
IsNullOrEmptyrra n
(rrn o
surnamerro v
)rrv w
&&rrx z
string	rr{ 
.
rr ‚
IsNullOrEmpty
rr‚ 
(
rr 
email
rr •
)
rr• –
&&
rr— ™
string
rrš  
.
rr  ¡
IsNullOrEmpty
rr¡ ®
(
rr® ¯
phone
rr¯ ´
)
rr´ µ
&&
rr¶ ¸
string
rr¹ ¿
.
rr¿ À
IsNullOrEmpty
rrÀ Í
(
rrÍ Î
eircode
rrÎ Õ
)
rrÕ Ö
&&
rr× Ù
string
rrÚ à
.
rrà á
IsNullOrEmpty
rrá î
(
rrî ï
phrase
rrï õ
)
rrõ ö
)
rrö ÷
{ss 
sqlQuerytt 
=tt 
$strtt g
;ttg h
}uu 
elsevv 
ifvv 
(vv 
!vv 
stringvv 
.vv 
IsNullOrEmptyvv *
(vv* +
custIDAsStringvv+ 9
)vv9 :
||vv; =
!vv> ?
stringvv? E
.vvE F
IsNullOrEmptyvvF S
(vvS T
forenamevvT \
)vv\ ]
||vv^ `
!vva b
stringvvb h
.vvh i
IsNullOrEmptyvvi v
(vvv w
surnamevvw ~
)vv~ 
||
vv€ ‚
!
vvƒ „
string
vv„ Š
.
vvŠ ‹
IsNullOrEmpty
vv‹ ˜
(
vv˜ ™
email
vv™ ž
)
vvž Ÿ
||
vv  ¢
!
vv£ ¤
string
vv¤ ª
.
vvª «
IsNullOrEmpty
vv« ¸
(
vv¸ ¹
phone
vv¹ ¾
)
vv¾ ¿
||
vvÀ Â
!
vvÃ Ä
string
vvÄ Ê
.
vvÊ Ë
IsNullOrEmpty
vvË Ø
(
vvØ Ù
eircode
vvÙ à
)
vvà á
||
vvâ ä
!
vvå æ
string
vvæ ì
.
vvì í
IsNullOrEmpty
vví ú
(
vvú û
phrase
vvû 
)
vv ‚
)
vv‚ ƒ
{ww 
sqlQueryxx 
=xx 
$strxx s
;xxs t
ifzz 
(zz 
!zz 
stringzz 
.zz 
IsNullOrEmptyzz )
(zz) *
custIDAsStringzz* 8
)zz8 9
)zz9 :
{{{ 
int|| 
custID|| 
;|| 
if}} 
(}} 
Decimal}} 
.}}  
TryParse}}  (
(}}( )
custIDAsString}}) 7
,}}7 8
out}}9 <
_}}= >
)}}> ?
)}}? @
{~~ 
custID 
=  
Convert! (
.( )
ToInt32) 0
(0 1
custIDAsString1 ?
)? @
;@ A
sqlQuery
€€  
+=
€€! #
$str
€€$ 8
+
€€9 :
custID
€€; A
;
€€A B
}
 
}
‚‚ 
if
„„ 
(
„„ 
!
„„ 
string
„„ 
.
„„ 
IsNullOrEmpty
„„ )
(
„„) *
forename
„„* 2
)
„„2 3
)
„„3 4
{
…… 
sqlQuery
†† 
+=
†† 
$str
††  D
+
††E F
forename
††G O
+
††P Q
$str
††R W
;
††W X
}
‡‡ 
if
‰‰ 
(
‰‰ 
!
‰‰ 
string
‰‰ 
.
‰‰ 
IsNullOrEmpty
‰‰ )
(
‰‰) *
surname
‰‰* 1
)
‰‰1 2
)
‰‰2 3
{
ŠŠ 
sqlQuery
‹‹ 
+=
‹‹ 
$str
‹‹  C
+
‹‹D E
surname
‹‹F M
+
‹‹N O
$str
‹‹P U
;
‹‹U V
}
ŒŒ 
if
ŽŽ 
(
ŽŽ 
!
ŽŽ 
string
ŽŽ 
.
ŽŽ 
IsNullOrEmpty
ŽŽ )
(
ŽŽ) *
email
ŽŽ* /
)
ŽŽ/ 0
)
ŽŽ0 1
{
 
sqlQuery
 
+=
 
$str
  A
+
B C
email
D I
+
J K
$str
L Q
;
Q R
}
‘‘ 
if
““ 
(
““ 
!
““ 
string
““ 
.
““ 
IsNullOrEmpty
““ )
(
““) *
phone
““* /
)
““/ 0
)
““0 1
{
”” 
sqlQuery
•• 
+=
•• 
$str
••  1
+
••2 3
phone
••4 9
+
••: ;
$str
••< @
;
••@ A
}
–– 
if
—— 
(
—— 
!
—— 
string
—— 
.
—— 
IsNullOrEmpty
—— )
(
——) *
eircode
——* 1
)
——1 2
)
——2 3
{
˜˜ 
sqlQuery
™™ 
+=
™™ 
$str
™™  C
+
™™D E
eircode
™™F M
+
™™N O
$str
™™P U
;
™™U V
}
šš 
if
›› 
(
›› 
!
›› 
string
›› 
.
›› 
IsNullOrEmpty
›› )
(
››) *
phrase
››* 0
)
››0 1
)
››1 2
{
œœ 
sqlQuery
 
+=
 
$str
  E
+
F G
phrase
H N
+
O P
$str
Q W
+
X Y
$str
žž 9
+
žž: ;
phrase
žž< B
+
žžC D
$str
žžE K
+
žžL M
$str
ŸŸ 7
+
ŸŸ8 9
phrase
ŸŸ: @
+
ŸŸA B
$str
ŸŸC I
+
ŸŸJ K
$str
   7
+
  8 9
phrase
  : @
+
  A B
$str
  C I
+
  J K
$str
¡¡ 9
+
¡¡: ;
phrase
¡¡< B
+
¡¡C D
$str
¡¡E K
;
¡¡K L
}
¢¢ 
}
££ 
return
¤¤ 
sqlQuery
¤¤ 
;
¤¤ 
}
¥¥ 	
}
¦¦ 
}§§ ê'
EC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\AnalysisData.cs
	namespace 	
ToolSYS
 
. 
Data 
{ 
public 

class 
AnalysisData 
{ 
private 
readonly 
string 
_connectionString  1
=2 3
	DBConnect4 =
.= >
oradb> C
;C D
public

 
	DataTable

 
GetDistinctYears

 )
(

) *
)

* +
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
_connectionString3 D
)D E
)E F
{ 
string 
sqlQuery 
=  !
$str" w
;w x
OracleCommand 
cmd !
=" #
new$ '
OracleCommand( 5
(5 6
sqlQuery6 >
,> ?
conn@ D
)D E
;E F
conn 
. 
Open 
( 
) 
; 
	DataTable 

yearsTable $
=% &
new' *
	DataTable+ 4
(4 5
)5 6
;6 7
using 
( 
OracleDataReader '
reader( .
=/ 0
cmd1 4
.4 5
ExecuteReader5 B
(B C
)C D
)D E
{ 

yearsTable 
. 
Load #
(# $
reader$ *
)* +
;+ ,
} 
return 

yearsTable !
;! "
} 
} 	
public 
	DataTable 
GetMonthlyRevenues +
(+ ,
int, /
year0 4
)4 5
{ 	
string 
sqlQuery 
= 
$str# <
;##< =
using%% 
(%% 
var%% 
conn%% 
=%% 
new%% !
OracleConnection%%" 2
(%%2 3
_connectionString%%3 D
)%%D E
)%%E F
{&& 
OracleCommand'' 
cmd'' !
=''" #
new''$ '
OracleCommand''( 5
(''5 6
sqlQuery''6 >
,''> ?
conn''@ D
)''D E
;''E F
cmd(( 
.(( 

Parameters(( 
.(( 
Add(( "
(((" #
$str((# *
,((* +
year((, 0
.((0 1
ToString((1 9
(((9 :
)((: ;
)((; <
;((< =
	DataTable** 
revenueTable** &
=**' (
new**) ,
	DataTable**- 6
(**6 7
)**7 8
;**8 9
OracleDataAdapter++ !
da++" $
=++% &
new++' *
OracleDataAdapter+++ <
(++< =
cmd++= @
)++@ A
;++A B
conn-- 
.-- 
Open-- 
(-- 
)-- 
;-- 
da.. 
... 
Fill.. 
(.. 
revenueTable.. $
)..$ %
;..% &
return00 
revenueTable00 #
;00# $
}11 
}22 	
public44 
	DataTable44 '
GetMonthlyRentalsByCategory44 4
(444 5
int445 8
year449 =
,44= >
string44? E
categoryCode44F R
)44R S
{55 	
string66 
sqlQuery66 
=66 
$str6= 
;==  
using?? 
(?? 
var?? 
conn?? 
=?? 
new?? !
OracleConnection??" 2
(??2 3
_connectionString??3 D
)??D E
)??E F
{@@ 
OracleCommandAA 
cmdAA !
=AA" #
newAA$ '
OracleCommandAA( 5
(AA5 6
sqlQueryAA6 >
,AA> ?
connAA@ D
)AAD E
;AAE F
cmdBB 
.BB 

ParametersBB 
.BB 
AddBB "
(BB" #
$strBB# *
,BB* +
yearBB, 0
.BB0 1
ToStringBB1 9
(BB9 :
)BB: ;
)BB; <
;BB< =
cmdCC 
.CC 

ParametersCC 
.CC 
AddCC "
(CC" #
$strCC# 2
,CC2 3
categoryCodeCC4 @
)CC@ A
;CCA B
OracleDataAdapterEE !
daEE" $
=EE% &
newEE' *
OracleDataAdapterEE+ <
(EE< =
cmdEE= @
)EE@ A
;EEA B
	DataTableFF 
dtFF 
=FF 
newFF "
	DataTableFF# ,
(FF, -
)FF- .
;FF. /
connHH 
.HH 
OpenHH 
(HH 
)HH 
;HH 
daII 
.II 
FillII 
(II 
dtII 
)II 
;II 
returnKK 
dtKK 
;KK 
}LL 
}MM 	
}NN 
}OO 