„ª
AC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\ToolData.cs
	namespace 	
ToolSYS
 
. 
Data 
{ 
public 

	interface 
	IToolData 
{ 
void		 
AddTool		 
(		 
Tool		 
tool		 
)		 
;		  
void

 

UpdateTool

 
(

 
Tool

 
tool

 !
)

! "
;

" #
void 

RemoveTool 
( 
int 
toolId "
)" #
;# $
int 
GetNextToolId 
( 
) 
; 
DataSet 
GetFilteredTools  
(  !
string! '
toolIdAsString( 6
,6 7
string8 >
categoryCode? K
,K L
stringM S
descriptionT _
,_ `
stringa g
manufacturerh t
,t u
stringv |
status	} ƒ
,
ƒ „
string
… ‹
phrase
Œ ’
)
’ “
;
“ ”
DataSet 
GetAvailableTools !
(! "
)" #
;# $
DataSet 
GetRentableTools  
(  !
string! '
categoryCode( 4
,4 5
DateTime6 >
from? C
,C D
DateTimeE M
toN P
)P Q
;Q R
bool 

ToolExists 
( 
int 
toolId #
)# $
;$ %
} 
public 

class 
ToolData 
: 
	IToolData %
{ 
private 
readonly 
string 
_connectionString  1
=2 3
	DbConnect4 =
.= >
Oradb> C
;C D
public 
void 
AddTool 
( 
Tool  
tool! %
)% &
{ 	
using 
( 
OracleConnection #
conn$ (
=) *
new+ .
OracleConnection/ ?
(? @
_connectionString@ Q
)Q R
)R S
{ 
string 
sqlQuery 
=  !
$str" |
+} ~
$str$ w
;w x
OracleCommand 
cmd !
=" #
new$ '
OracleCommand( 5
(5 6
sqlQuery6 >
,> ?
conn@ D
)D E
;E F
cmd 
. 

Parameters 
. 
Add "
(" #
$str# ,
,, -
tool. 2
.2 3
toolId3 9
)9 :
;: ;
cmd   
.   

Parameters   
.   
Add   "
(  " #
$str  # 2
,  2 3
tool  4 8
.  8 9
categoryCode  9 E
.  E F
	Substring  F O
(  O P
$num  P Q
,  Q R
$num  S T
)  T U
)  U V
;  V W
cmd!! 
.!! 

Parameters!! 
.!! 
Add!! "
(!!" #
$str!!# 5
,!!5 6
tool!!7 ;
.!!; <
toolDescription!!< K
)!!K L
;!!L M
cmd"" 
."" 

Parameters"" 
."" 
Add"" "
(""" #
$str""# 6
,""6 7
tool""8 <
.""< =
toolManufacturer""= M
)""M N
;""N O
cmd## 
.## 

Parameters## 
.## 
Add## "
(##" #
$str### 0
,##0 1
tool##2 6
.##6 7

toolStatus##7 A
)##A B
;##B C
conn%% 
.%% 
Open%% 
(%% 
)%% 
;%% 
cmd&& 
.&& 
ExecuteNonQuery&& #
(&&# $
)&&$ %
;&&% &
}'' 
}(( 	
public** 
void** 

UpdateTool** 
(** 
Tool** #
tool**$ (
)**( )
{++ 	
using,, 
(,, 
OracleConnection,, #
conn,,$ (
=,,) *
new,,+ .
OracleConnection,,/ ?
(,,? @
_connectionString,,@ Q
),,Q R
),,R S
{-- 
string.. 
sqlQuery.. 
=..  !
$str.." 5
+..6 7
$str//$ D
+//E F
$str00$ J
+00K L
$str11$ L
+11M N
$str22$ ?
+22@ A
$str33$ <
;33< =
OracleCommand55 
cmd55 !
=55" #
new55$ '
OracleCommand55( 5
(555 6
sqlQuery556 >
,55> ?
conn55@ D
)55D E
;55E F
cmd66 
.66 

Parameters66 
.66 
Add66 "
(66" #
$str66# 2
,662 3
tool664 8
.668 9
categoryCode669 E
)66E F
;66F G
cmd77 
.77 

Parameters77 
.77 
Add77 "
(77" #
$str77# 5
,775 6
tool777 ;
.77; <
toolDescription77< K
)77K L
;77L M
cmd88 
.88 

Parameters88 
.88 
Add88 "
(88" #
$str88# 6
,886 7
tool888 <
.88< =
toolManufacturer88= M
)88M N
;88N O
cmd99 
.99 

Parameters99 
.99 
Add99 "
(99" #
$str99# 0
,990 1
tool992 6
.996 7

toolStatus997 A
)99A B
;99B C
cmd:: 
.:: 

Parameters:: 
.:: 
Add:: "
(::" #
$str::# ,
,::, -
tool::. 2
.::2 3
toolId::3 9
)::9 :
;::: ;
conn<< 
.<< 
Open<< 
(<< 
)<< 
;<< 
cmd== 
.== 
ExecuteNonQuery== #
(==# $
)==$ %
;==% &
}>> 
}?? 	
publicAA 
voidAA 

RemoveToolAA 
(AA 
intAA "
toolIdAA# )
)AA) *
{BB 	
usingCC 
(CC 
OracleConnectionCC #
connCC$ (
=CC) *
newCC+ .
OracleConnectionCC/ ?
(CC? @
_connectionStringCC@ Q
)CCQ R
)CCR S
{DD 
stringEE 
sqlQueryEE 
=EE  !
$strEE" \
;EE\ ]
OracleCommandFF 
cmdFF !
=FF" #
newFF$ '
OracleCommandFF( 5
(FF5 6
sqlQueryFF6 >
,FF> ?
connFF@ D
)FFD E
;FFE F
cmdGG 
.GG 

ParametersGG 
.GG 
AddGG "
(GG" #
$strGG# ,
,GG, -
toolIdGG. 4
)GG4 5
;GG5 6
connII 
.II 
OpenII 
(II 
)II 
;II 
cmdJJ 
.JJ 
ExecuteNonQueryJJ #
(JJ# $
)JJ$ %
;JJ% &
}KK 
}LL 	
publicNN 
intNN 
GetNextToolIdNN  
(NN  !
)NN! "
{OO 	
usingPP 
(PP 
OracleConnectionPP #
connPP$ (
=PP) *
newPP+ .
OracleConnectionPP/ ?
(PP? @
_connectionStringPP@ Q
)PPQ R
)PPR S
{QQ 
stringRR 
sqlQueryRR 
=RR  !
$strRR" A
;RRA B
OracleCommandSS 
cmdSS !
=SS" #
newSS$ '
OracleCommandSS( 5
(SS5 6
sqlQuerySS6 >
,SS> ?
connSS@ D
)SSD E
;SSE F
connTT 
.TT 
OpenTT 
(TT 
)TT 
;TT 
objectVV 
resultVV 
=VV 
cmdVV  #
.VV# $
ExecuteScalarVV$ 1
(VV1 2
)VV2 3
;VV3 4
returnWW 
(WW 
resultWW 
==WW !
DBNullWW" (
.WW( )
ValueWW) .
)WW. /
?WW0 1
$numWW2 3
:WW4 5
ConvertWW6 =
.WW= >
ToInt32WW> E
(WWE F
resultWWF L
)WWL M
+WWN O
$numWWP Q
;WWQ R
}XX 
}YY 	
public[[ 
DataSet[[ 
GetFilteredTools[[ '
([[' (
string[[( .
toolIdAsString[[/ =
,[[= >
string[[? E
categoryCode[[F R
,[[R S
string[[T Z
description[[[ f
,[[f g
string[[h n
manufacturer[[o {
,[[{ |
string	[[} ƒ
status
[[„ Š
,
[[Š ‹
string
[[Œ ’
phrase
[[“ ™
)
[[™ š
{\\ 	
using]] 
(]] 
OracleConnection]] #
conn]]$ (
=]]) *
new]]+ .
OracleConnection]]/ ?
(]]? @
_connectionString]]@ Q
)]]Q R
)]]R S
{^^ 
string__ 
sqlQuery__ 
=__  !
DetermineSqlQuery__" 3
(__3 4
toolIdAsString__4 B
,__B C
categoryCode__D P
,__P Q
description__R ]
,__] ^
manufacturer___ k
,__k l
status__m s
,__s t
phrase__u {
)__{ |
;__| }
OracleCommandaa 
cmdaa !
=aa" #
newaa$ '
OracleCommandaa( 5
(aa5 6
sqlQueryaa6 >
,aa> ?
connaa@ D
)aaD E
;aaE F
OracleDataAdapterbb !
dabb" $
=bb% &
newbb' *
OracleDataAdapterbb+ <
(bb< =
cmdbb= @
)bb@ A
;bbA B
DataSetdd 
dsdd 
=dd 
newdd  
DataSetdd! (
(dd( )
)dd) *
;dd* +
daee 
.ee 
Fillee 
(ee 
dsee 
,ee 
$stree "
)ee" #
;ee# $
returngg 
dsgg 
;gg 
}hh 
}ii 	
privatekk 
statickk 
Stringkk 
DetermineSqlQuerykk /
(kk/ 0
Stringkk0 6
toolIdAsStringkk7 E
,kkE F
StringkkG M
categoryCodekkN Z
,kkZ [
Stringkk\ b
descriptionkkc n
,kkn o
Stringkkp v
manufacturer	kkw ƒ
,
kkƒ „
String
kk… ‹
status
kkŒ ’
,
kk’ “
String
kk” š
phrase
kk› ¡
)
kk¡ ¢
{ll 	
Stringmm 
sqlQuerymm 
=mm 
$strmm  
;mm  !
ifoo 
(oo 
stringoo 
.oo 
IsNullOrEmptyoo $
(oo$ %
toolIdAsStringoo% 3
)oo3 4
&&oo5 7
Stringoo8 >
.oo> ?
IsNullOrEmptyoo? L
(ooL M
categoryCodeooM Y
)ooY Z
&&oo[ ]
stringoo^ d
.ood e
IsNullOrEmptyooe r
(oor s
descriptionoos ~
)oo~ 
&&
oo€ ‚
string
ooƒ ‰
.
oo‰ Š
IsNullOrEmpty
ooŠ —
(
oo— ˜
manufacturer
oo˜ ¤
)
oo¤ ¥
&&
oo¦ ¨
string
oo© ¯
.
oo¯ °
IsNullOrEmpty
oo° ½
(
oo½ ¾
status
oo¾ Ä
)
ooÄ Å
&&
ooÆ È
string
ooÉ Ï
.
ooÏ Ð
IsNullOrEmpty
ooÐ Ý
(
ooÝ Þ
phrase
ooÞ ä
)
ooä å
)
ooå æ
{pp 
sqlQueryqq 
=qq 
$strqq r
;qqr s
}rr 
elsess 
ifss 
(ss 
!ss 
stringss 
.ss 
IsNullOrEmptyss *
(ss* +
toolIdAsStringss+ 9
)ss9 :
||ss; =
!ss> ?
stringss? E
.ssE F
IsNullOrEmptyssF S
(ssS T
categoryCodessT `
)ss` a
||ssb d
!sse f
stringssf l
.ssl m
IsNullOrEmptyssm z
(ssz {
description	ss{ †
)
ss† ‡
||
ssˆ Š
!
ss‹ Œ
string
ssŒ ’
.
ss’ “
IsNullOrEmpty
ss“  
(
ss  ¡
manufacturer
ss¡ ­
)
ss­ ®
||
ss¯ ±
!
ss² ³
string
ss³ ¹
.
ss¹ º
IsNullOrEmpty
ssº Ç
(
ssÇ È
status
ssÈ Î
)
ssÎ Ï
||
ssÐ Ò
!
ssÓ Ô
string
ssÔ Ú
.
ssÚ Û
IsNullOrEmpty
ssÛ è
(
ssè é
phrase
ssé ï
)
ssï ð
)
ssð ñ
{tt 
sqlQueryuu 
=uu 
$struu ~
;uu~ 
ifww 
(ww 
!ww 
stringww 
.ww 
IsNullOrEmptyww )
(ww) *
toolIdAsStringww* 8
)ww8 9
)ww9 :
{xx 
intyy 
toolIdyy 
=yy  
Convertyy! (
.yy( )
ToInt32yy) 0
(yy0 1
toolIdAsStringyy1 ?
)yy? @
;yy@ A
sqlQueryzz 
+=zz 
$strzz  0
+zz1 2
toolIdzz3 9
;zz9 :
}{{ 
if}} 
(}} 
!}} 
string}} 
.}} 
IsNullOrEmpty}} )
(}}) *
categoryCode}}* 6
)}}6 7
)}}7 8
{~~ 
categoryCode  
=! "
categoryCode# /
./ 0
	Substring0 9
(9 :
$num: ;
,; <
$num= >
)> ?
;? @
sqlQuery
€€ 
+=
€€ 
$str
€€  G
+
€€H I
categoryCode
€€J V
+
€€W X
$str
€€Y ]
;
€€] ^
}
 
if
ƒƒ 
(
ƒƒ 
!
ƒƒ 
string
ƒƒ 
.
ƒƒ 
IsNullOrEmpty
ƒƒ )
(
ƒƒ) *
description
ƒƒ* 5
)
ƒƒ5 6
)
ƒƒ6 7
{
„„ 
sqlQuery
…… 
+=
…… 
$str
……  K
+
……L M
description
……N Y
+
……Z [
$str
……\ a
;
……a b
}
†† 
if
ˆˆ 
(
ˆˆ 
!
ˆˆ 
string
ˆˆ 
.
ˆˆ 
IsNullOrEmpty
ˆˆ )
(
ˆˆ) *
manufacturer
ˆˆ* 6
)
ˆˆ6 7
)
ˆˆ7 8
{
‰‰ 
sqlQuery
ŠŠ 
+=
ŠŠ 
$str
ŠŠ  L
+
ŠŠM N
manufacturer
ŠŠO [
+
ŠŠ\ ]
$str
ŠŠ^ c
;
ŠŠc d
}
‹‹ 
if
 
(
 
!
 
string
 
.
 
IsNullOrEmpty
 )
(
) *
status
* 0
)
0 1
)
1 2
{
ŽŽ 
status
 
=
 
status
 #
.
# $
	Substring
$ -
(
- .
$num
. /
,
/ 0
$num
1 2
)
2 3
;
3 4
sqlQuery
 
+=
 
$str
  5
+
6 7
status
8 >
+
? @
$str
A D
;
D E
}
‘‘ 
if
““ 
(
““ 
!
““ 
string
““ 
.
““ 
IsNullOrEmpty
““ )
(
““) *
phrase
““* 0
)
““0 1
)
““1 2
{
”” 
sqlQuery
•• 
+=
•• 
$str
••  I
+
••J K
phrase
••L R
+
••S T
$str
••U [
+
••\ ]
$str
–– A
+
––B C
phrase
––D J
+
––K L
$str
––M S
+
––T U
$str
—— B
+
——C D
phrase
——E K
+
——L M
$str
——N T
;
——T U
}
˜˜ 
}
™™ 
return
šš 
sqlQuery
šš 
;
šš 
}
›› 	
public
žž 
DataSet
žž 
GetAvailableTools
žž (
(
žž( )
)
žž) *
{
ŸŸ 	
using
   
(
   
OracleConnection
   #
conn
  $ (
=
  ) *
new
  + .
OracleConnection
  / ?
(
  ? @
_connectionString
  @ Q
)
  Q R
)
  R S
{
¡¡ 
string
¢¢ 
sqlQuery
¢¢ 
=
¢¢  !
$str
¢¢" n
+
¢¢o p
$str
££ (
;
££( )
OracleCommand
¥¥ 
cmd
¥¥ !
=
¥¥" #
new
¥¥$ '
OracleCommand
¥¥( 5
(
¥¥5 6
sqlQuery
¥¥6 >
,
¥¥> ?
conn
¥¥@ D
)
¥¥D E
;
¥¥E F
OracleDataAdapter
¦¦ !
da
¦¦" $
=
¦¦% &
new
¦¦' *
OracleDataAdapter
¦¦+ <
(
¦¦< =
cmd
¦¦= @
)
¦¦@ A
;
¦¦A B
DataSet
¨¨ 
ds
¨¨ 
=
¨¨ 
new
¨¨  
DataSet
¨¨! (
(
¨¨( )
)
¨¨) *
;
¨¨* +
da
©© 
.
©© 
Fill
©© 
(
©© 
ds
©© 
,
©© 
$str
©© "
)
©©" #
;
©©# $
return
«« 
ds
«« 
;
«« 
}
¬¬ 
}
­­ 	
public
¯¯ 
DataSet
¯¯ 
GetRentableTools
¯¯ '
(
¯¯' (
string
¯¯( .
categoryCode
¯¯/ ;
,
¯¯; <
DateTime
¯¯= E
from
¯¯F J
,
¯¯J K
DateTime
¯¯L T
to
¯¯U W
)
¯¯W X
{
°° 	
using
±± 
(
±± 
OracleConnection
±± #
conn
±±$ (
=
±±) *
new
±±+ .
OracleConnection
±±/ ?
(
±±? @
_connectionString
±±@ Q
)
±±Q R
)
±±R S
{
²² 
string
³³ 
sqlQuery
³³ 
=
³³  !
$str
³½" 
;
½½ 
using
¿¿ 
(
¿¿ 
OracleCommand
¿¿ $
cmd
¿¿% (
=
¿¿) *
new
¿¿+ .
OracleCommand
¿¿/ <
(
¿¿< =
sqlQuery
¿¿= E
,
¿¿E F
conn
¿¿G K
)
¿¿K L
)
¿¿L M
{
ÀÀ 
cmd
ÁÁ 
.
ÁÁ 

Parameters
ÁÁ "
.
ÁÁ" #
Add
ÁÁ# &
(
ÁÁ& '
new
ÁÁ' *
OracleParameter
ÁÁ+ :
(
ÁÁ: ;
$str
ÁÁ; J
,
ÁÁJ K
categoryCode
ÁÁL X
)
ÁÁX Y
)
ÁÁY Z
;
ÁÁZ [
cmd
ÂÂ 
.
ÂÂ 

Parameters
ÂÂ "
.
ÂÂ" #
Add
ÂÂ# &
(
ÂÂ& '
new
ÂÂ' *
OracleParameter
ÂÂ+ :
(
ÂÂ: ;
$str
ÂÂ; F
,
ÂÂF G
from
ÂÂH L
.
ÂÂL M
ToString
ÂÂM U
(
ÂÂU V
$str
ÂÂV a
)
ÂÂa b
)
ÂÂb c
)
ÂÂc d
;
ÂÂd e
cmd
ÃÃ 
.
ÃÃ 

Parameters
ÃÃ "
.
ÃÃ" #
Add
ÃÃ# &
(
ÃÃ& '
new
ÃÃ' *
OracleParameter
ÃÃ+ :
(
ÃÃ: ;
$str
ÃÃ; D
,
ÃÃD E
to
ÃÃF H
.
ÃÃH I
ToString
ÃÃI Q
(
ÃÃQ R
$str
ÃÃR ]
)
ÃÃ] ^
)
ÃÃ^ _
)
ÃÃ_ `
;
ÃÃ` a
OracleDataAdapter
ÅÅ %
da
ÅÅ& (
=
ÅÅ) *
new
ÅÅ+ .
OracleDataAdapter
ÅÅ/ @
(
ÅÅ@ A
cmd
ÅÅA D
)
ÅÅD E
;
ÅÅE F
DataSet
ÆÆ 
ds
ÆÆ 
=
ÆÆ  
new
ÆÆ! $
DataSet
ÆÆ% ,
(
ÆÆ, -
)
ÆÆ- .
;
ÆÆ. /
da
ÇÇ 
.
ÇÇ 
Fill
ÇÇ 
(
ÇÇ 
ds
ÇÇ 
,
ÇÇ 
$str
ÇÇ  &
)
ÇÇ& '
;
ÇÇ' (
return
ÉÉ 
ds
ÉÉ 
;
ÉÉ 
}
ÊÊ 
}
ËË 
}
ÌÌ 	
public
ÍÍ 
bool
ÍÍ 

ToolExists
ÍÍ 
(
ÍÍ 
int
ÍÍ "
toolId
ÍÍ# )
)
ÍÍ) *
{
ÎÎ 	
using
ÏÏ 
(
ÏÏ 
OracleConnection
ÏÏ #
conn
ÏÏ$ (
=
ÏÏ) *
new
ÏÏ+ .
OracleConnection
ÏÏ/ ?
(
ÏÏ? @
_connectionString
ÏÏ@ Q
)
ÏÏQ R
)
ÏÏR S
{
ÐÐ 
string
ÑÑ 
sqlQuery
ÑÑ 
=
ÑÑ  !
$str
ÑÑ" j
;
ÑÑj k
OracleCommand
ÒÒ 
cmd
ÒÒ !
=
ÒÒ" #
new
ÒÒ$ '
OracleCommand
ÒÒ( 5
(
ÒÒ5 6
sqlQuery
ÒÒ6 >
,
ÒÒ> ?
conn
ÒÒ@ D
)
ÒÒD E
;
ÒÒE F
cmd
ÓÓ 
.
ÓÓ 

Parameters
ÓÓ 
.
ÓÓ 
Add
ÓÓ "
(
ÓÓ" #
$str
ÓÓ# ,
,
ÓÓ, -
toolId
ÓÓ. 4
)
ÓÓ4 5
;
ÓÓ5 6
conn
ÕÕ 
.
ÕÕ 
Open
ÕÕ 
(
ÕÕ 
)
ÕÕ 
;
ÕÕ 
int
ÖÖ 
count
ÖÖ 
=
ÖÖ 
Convert
ÖÖ #
.
ÖÖ# $
ToInt32
ÖÖ$ +
(
ÖÖ+ ,
cmd
ÖÖ, /
.
ÖÖ/ 0
ExecuteScalar
ÖÖ0 =
(
ÖÖ= >
)
ÖÖ> ?
)
ÖÖ? @
;
ÖÖ@ A
conn
×× 
.
×× 
Close
×× 
(
×× 
)
×× 
;
×× 
return
ÙÙ 
count
ÙÙ 
>
ÙÙ 
$num
ÙÙ  
;
ÙÙ  !
}
ÚÚ 
}
ÛÛ 	
}
ÝÝ 
}ÞÞ ¦
GC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\RentalItemData.cs
	namespace 	
ToolSYS
 
. 
Data 
{ 
public 

class 
RentalItemData 
{ 
private 
readonly 
string 
_connectionString  1
=2 3
	DbConnect4 =
.= >
Oradb> C
;C D
public

 
void

 
AddRentalItem

 !
(

! "

RentalItem

" ,

rentalItem

- 7
)

7 8
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
_connectionString3 D
)D E
)E F
{ 
conn 
. 
Open 
( 
) 
; 
string 
	sqlInsert  
=! "
$str# T
;T U
var 
cmd 
= 
new 
OracleCommand +
(+ ,
	sqlInsert, 5
,5 6
conn7 ;
); <
;< =
cmd 
. 

Parameters 
. 
Add "
(" #
$str# .
,. /
OracleDbType0 <
.< =
Int32= B
)B C
.C D
ValueD I
=J K

rentalItemL V
.V W
rentalIdW _
;_ `
cmd 
. 

Parameters 
. 
Add "
(" #
$str# ,
,, -
OracleDbType. :
.: ;
Int32; @
)@ A
.A B
ValueB G
=H I

rentalItemJ T
.T U
toolIdU [
;[ \
cmd 
. 

Parameters 
. 
Add "
(" #
$str# .
,. /
OracleDbType0 <
.< =
Date= A
)A B
.B C
ValueC H
=I J

rentalItemK U
.U V
rentDateV ^
;^ _
cmd 
. 

Parameters 
. 
Add "
(" #
$str# 0
,0 1
OracleDbType2 >
.> ?
Date? C
)C D
.D E
ValueE J
=K L

rentalItemM W
.W X

returnDateX b
;b c
cmd 
. 

Parameters 
. 
Add "
(" #
$str# /
,/ 0
OracleDbType1 =
.= >
Decimal> E
)E F
.F G
ValueG L
=M N

rentalItemO Y
.Y Z
	rentalFeeZ c
;c d
cmd 
. 
ExecuteNonQuery #
(# $
)$ %
;% &
string 
sqlUpdateStatus &
=' (
$str) c
;c d
cmd   
=   
new   
OracleCommand   '
(  ' (
sqlUpdateStatus  ( 7
,  7 8
conn  9 =
)  = >
;  > ?
cmd!! 
.!! 

Parameters!! 
.!! 
Add!! "
(!!" #
$str!!# ,
,!!, -
OracleDbType!!. :
.!!: ;
Int32!!; @
)!!@ A
.!!A B
Value!!B G
=!!H I

rentalItem!!J T
.!!T U
toolId!!U [
;!![ \
cmd## 
.## 
ExecuteNonQuery## #
(### $
)##$ %
;##% &
}$$ 
}%% 	
}&& 
}'' ´3
CC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\RentalData.cs
	namespace 	
ToolSYS
 
. 
Data 
{ 
public 

class 

RentalData 
{ 
public		 
static		 
int		 
GetNextRentalId		 )
(		) *
)		* +
{

 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
	DbConnect3 <
.< =
Oradb= B
)B C
)C D
{ 
conn 
. 
Open 
( 
) 
; 
string 
sqlQuery 
=  !
$str" Q
;Q R
var 
cmd 
= 
new 
OracleCommand +
(+ ,
sqlQuery, 4
,4 5
conn6 :
): ;
;; <
return 
Convert 
. 
ToInt32 &
(& '
cmd' *
.* +
ExecuteScalar+ 8
(8 9
)9 :
): ;
;; <
} 
} 	
public 
static 
void 
	AddRental $
($ %
Rental% +
rental, 2
)2 3
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
	DbConnect3 <
.< =
Oradb= B
)B C
)C D
{ 
conn 
. 
Open 
( 
) 
; 
string 
sqlQuery 
=  !
$str" Q
;Q R
var 
cmd 
= 
new 
OracleCommand +
(+ ,
sqlQuery, 4
,4 5
conn6 :
): ;
;; <
cmd 
. 

Parameters 
. 
Add "
(" #
$str# .
,. /
rental0 6
.6 7
rentalId7 ?
)? @
;@ A
cmd 
. 

Parameters 
. 
Add "
(" #
$str# 0
,0 1
rental2 8
.8 9

customerId9 C
)C D
;D E
cmd   
.   

Parameters   
.   
Add   "
(  " #
$str  # 5
,  5 6
rental  7 =
.  = >
transactionDate  > M
)  M N
;  N O
cmd!! 
.!! 

Parameters!! 
.!! 
Add!! "
(!!" #
$str!!# .
,!!. /
rental!!0 6
.!!6 7
totalFee!!7 ?
)!!? @
;!!@ A
cmd"" 
."" 
ExecuteNonQuery"" #
(""# $
)""$ %
;""% &
}## 
}$$ 	
public&& 
static&& 
	DataTable&& $
GetRentalItemsByRentalId&&  8
(&&8 9
int&&9 <
rentalId&&= E
)&&E F
{'' 	
using(( 
((( 
var(( 
conn(( 
=(( 
new(( !
OracleConnection((" 2
(((2 3
	DbConnect((3 <
.((< =
Oradb((= B
)((B C
)((C D
{)) 
string** 
query** 
=** 
$str*/ V
;//V W
OracleCommand11 
cmd11 !
=11" #
new11$ '
OracleCommand11( 5
(115 6
query116 ;
,11; <
conn11= A
)11A B
;11B C
cmd22 
.22 

Parameters22 
.22 
Add22 "
(22" #
$str22# .
,22. /
rentalId220 8
)228 9
;229 :
OracleDataAdapter44 !
adapter44" )
=44* +
new44, /
OracleDataAdapter440 A
(44A B
cmd44B E
)44E F
;44F G
	DataTable55 
dt55 
=55 
new55 "
	DataTable55# ,
(55, -
)55- .
;55. /
adapter66 
.66 
Fill66 
(66 
dt66 
)66  
;66  !
return88 
dt88 
;88 
}99 
}:: 	
public<< 
static<< 
void<< 

ReturnTool<< %
(<<% &
int<<& )
rentalId<<* 2
,<<2 3
int<<4 7
toolId<<8 >
)<<> ?
{== 	
using>> 
(>> 
var>> 
conn>> 
=>> 
new>> !
OracleConnection>>" 2
(>>2 3
	DbConnect>>3 <
.>>< =
Oradb>>= B
)>>B C
)>>C D
{?? 
conn@@ 
.@@ 
Open@@ 
(@@ 
)@@ 
;@@ 
stringBB 
updateToolQueryBB &
=BB' (
$strBB) c
;BBc d
OracleCommandCC 
updateToolCmdCC +
=CC, -
newCC. 1
OracleCommandCC2 ?
(CC? @
updateToolQueryCC@ O
,CCO P
connCCQ U
)CCU V
;CCV W
updateToolCmdDD 
.DD 

ParametersDD (
.DD( )
AddDD) ,
(DD, -
$strDD- 6
,DD6 7
toolIdDD8 >
)DD> ?
;DD? @
updateToolCmdEE 
.EE 
ExecuteNonQueryEE -
(EE- .
)EE. /
;EE/ 0
stringGG !
updateRentalItemQueryGG ,
=GG- .
$strGJ/ D
;JJD E
OracleCommandKK 
updateRentalCmdKK -
=KK. /
newKK0 3
OracleCommandKK4 A
(KKA B!
updateRentalItemQueryKKB W
,KKW X
connKKY ]
)KK] ^
;KK^ _
updateRentalCmdLL 
.LL  

ParametersLL  *
.LL* +
AddLL+ .
(LL. /
$strLL/ :
,LL: ;
rentalIdLL< D
)LLD E
;LLE F
updateRentalCmdMM 
.MM  

ParametersMM  *
.MM* +
AddMM+ .
(MM. /
$strMM/ 8
,MM8 9
toolIdMM: @
)MM@ A
;MMA B
updateRentalCmdNN 
.NN  
ExecuteNonQueryNN  /
(NN/ 0
)NN0 1
;NN1 2
}OO 
}PP 	
}QQ 
}RR Ï=
AC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\RateData.cs
	namespace 	
ToolSYS
 
. 
Data 
{ 
public 

class 
RateData 
{ 
private		 
readonly		 
string		 
_connectionString		  1
=		2 3
	DbConnect		4 =
.		= >
Oradb		> C
;		C D
public 
void 
AddRate 
( 
Rate  
rate! %
)% &
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
_connectionString3 D
)D E
)E F
{ 
string 
sqlQuery 
=  !
$str	" …
;
… †
OracleCommand 
cmd !
=" #
new$ '
OracleCommand( 5
(5 6
sqlQuery6 >
,> ?
conn@ D
)D E
;E F
cmd 
. 

Parameters 
. 
Add "
(" #
$str# 2
,2 3
rate4 8
.8 9
categoryCode9 E
)E F
;F G
cmd 
. 

Parameters 
. 
Add "
(" #
$str# 2
,2 3
rate4 8
.8 9
categoryDesc9 E
)E F
;F G
cmd 
. 

Parameters 
. 
Add "
(" #
$str# *
,* +
rate, 0
.0 1
rate1 5
)5 6
;6 7
conn 
. 
Open 
( 
) 
; 
cmd 
. 
ExecuteNonQuery #
(# $
)$ %
;% &
} 
} 	
public 
Rate !
GetRateByCategoryCode )
() *
string* 0
categoryCode1 =
)= >
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
_connectionString3 D
)D E
)E F
{ 
string 
sqlQuery 
=  !
$str k
;k l
OracleCommand   
cmd   !
=  " #
new  $ '
OracleCommand  ( 5
(  5 6
sqlQuery  6 >
,  > ?
conn  @ D
)  D E
;  E F
cmd!! 
.!! 

Parameters!! 
.!! 
Add!! "
(!!" #
$str!!# 2
,!!2 3
categoryCode!!4 @
)!!@ A
;!!A B
conn## 
.## 
Open## 
(## 
)## 
;## 
OracleDataReader$$  
dr$$! #
=$$$ %
cmd$$& )
.$$) *
ExecuteReader$$* 7
($$7 8
)$$8 9
;$$9 :
dr&& 
.&& 
Read&& 
(&& 
)&& 
;&& 
return'' 
new'' 
Rate'' 
{(( 
categoryCode))  
=))! "
dr))# %
.))% &
	GetString))& /
())/ 0
$num))0 1
)))1 2
,))2 3
categoryDesc**  
=**! "
dr**# %
.**% &
	GetString**& /
(**/ 0
$num**0 1
)**1 2
,**2 3
rate++ 
=++ 
dr++ 
.++ 

GetDecimal++ (
(++( )
$num++) *
)++* +
},, 
;,, 
}-- 
}.. 	
public00 
void00 

UpdateRate00 
(00 
Rate00 #
rate00$ (
)00( )
{11 	
using22 
(22 
var22 
conn22 
=22 
new22 !
OracleConnection22" 2
(222 3
_connectionString223 D
)22D E
)22E F
{33 
string44 
sqlQuery44 
=44  !
$str	44" ‚
;
44‚ ƒ
OracleCommand55 
cmd55 !
=55" #
new55$ '
OracleCommand55( 5
(555 6
sqlQuery556 >
,55> ?
conn55@ D
)55D E
;55E F
cmd66 
.66 

Parameters66 
.66 
Add66 "
(66" #
$str66# 2
,662 3
rate664 8
.668 9
categoryDesc669 E
)66E F
;66F G
cmd77 
.77 

Parameters77 
.77 
Add77 "
(77" #
$str77# *
,77* +
rate77, 0
.770 1
rate771 5
)775 6
;776 7
cmd88 
.88 

Parameters88 
.88 
Add88 "
(88" #
$str88# 2
,882 3
rate884 8
.888 9
categoryCode889 E
)88E F
;88F G
conn:: 
.:: 
Open:: 
(:: 
):: 
;:: 
cmd;; 
.;; 
ExecuteNonQuery;; #
(;;# $
);;$ %
;;;% &
}<< 
}== 	
public?? 
DataSet?? 
GetAllCategories?? '
(??' (
)??( )
{@@ 	
usingAA 
(AA 
varAA 
connAA 
=AA 
newAA !
OracleConnectionAA" 2
(AA2 3
_connectionStringAA3 D
)AAD E
)AAE F
{BB 
stringCC 
sqlQueryCC 
=CC  !
$strCC" M
;CCM N
OracleDataAdapterDD !
daDD" $
=DD% &
newDD' *
OracleDataAdapterDD+ <
(DD< =
sqlQueryDD= E
,DDE F
connDDG K
)DDK L
;DDL M
DataSetFF 
dsFF 
=FF 
newFF  
DataSetFF! (
(FF( )
)FF) *
;FF* +
daGG 
.GG 
FillGG 
(GG 
dsGG 
,GG 
$strGG #
)GG# $
;GG$ %
returnII 
dsII 
;II 
}JJ 
}KK 	
publicMM 
boolMM !
DoesCategoryCodeExistMM )
(MM) *
stringMM* 0
categoryCodeMM1 =
)MM= >
{NN 	
usingOO 
(OO 
varOO 
connOO 
=OO 
newOO !
OracleConnectionOO" 2
(OO2 3
_connectionStringOO3 D
)OOD E
)OOE F
{PP 
stringQQ 
sqlQueryQQ 
=QQ  !
$strQQ" a
;QQa b
varRR 
cmdRR 
=RR 
newRR 
OracleCommandRR +
(RR+ ,
sqlQueryRR, 4
,RR4 5
connRR6 :
)RR: ;
;RR; <
cmdSS 
.SS 

ParametersSS 
.SS 
AddSS "
(SS" #
$strSS# 2
,SS2 3
OracleDbTypeSS4 @
.SS@ A
Varchar2SSA I
)SSI J
.SSJ K
ValueSSK P
=SSQ R
categoryCodeSSS _
;SS_ `
connUU 
.UU 
OpenUU 
(UU 
)UU 
;UU 
intVV 
countVV 
=VV 
ConvertVV #
.VV# $
ToInt32VV$ +
(VV+ ,
cmdVV, /
.VV/ 0
ExecuteScalarVV0 =
(VV= >
)VV> ?
)VV? @
;VV@ A
connWW 
.WW 
CloseWW 
(WW 
)WW 
;WW 
returnYY 
countYY 
>YY 
$numYY  
;YY  !
}ZZ 
}[[ 	
}\\ 
}]] —
BC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\DBConnect.cs
	namespace 	
ToolSYS
 
. 
Data 
{ 
public 

static 
class 
	DbConnect !
{ 
public		 
const		 
string		 
Oradb		 !
=		" #
$str		$ y
;		y z
} 
} åŒ
EC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\CustomerData.cs
	namespace 	
ToolSYS
 
. 
Data 
{ 
public 

class 
CustomerData 
{ 
private		 
readonly		 
string		 
_connectionString		  1
=		2 3
	DbConnect		4 =
.		= >
Oradb		> C
;		C D
public 
int 
GetNextCustomerId $
($ %
)% &
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
_connectionString3 D
)D E
)E F
{ 
string 
sqlQuery 
=  !
$str" I
;I J
var 
cmd 
= 
new 
OracleCommand +
(+ ,
sqlQuery, 4
,4 5
conn6 :
): ;
;; <
conn 
. 
Open 
( 
) 
; 
int 
nextCustomerId "
=# $
cmd% (
.( )
ExecuteScalar) 6
(6 7
)7 8
==9 ;
DBNull< B
.B C
ValueC H
?I J
$numK L
:M N
ConvertO V
.V W
ToInt32W ^
(^ _
cmd_ b
.b c
ExecuteScalarc p
(p q
)q r
)r s
+t u
$numv w
;w x
conn 
. 
Close 
( 
) 
; 
return 
nextCustomerId %
;% &
} 
} 	
public 
void 
AddCustomer 
(  
Customer  (
customer) 1
)1 2
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
_connectionString3 D
)D E
)E F
{ 
string 
sqlQuery 
=  !
$str" q
+r s
$str" g
;g h
var!! 
cmd!! 
=!! 
new!! 
OracleCommand!! +
(!!+ ,
sqlQuery!!, 4
,!!4 5
conn!!6 :
)!!: ;
;!!; <
cmd"" 
."" 

Parameters"" 
."" 
Add"" "
(""" #
$str""# 0
,""0 1
OracleDbType""2 >
.""> ?
Int32""? D
)""D E
.""E F
Value""F K
=""L M
customer""N V
.""V W

customerId""W a
;""a b
cmd## 
.## 

Parameters## 
.## 
Add## "
(##" #
$str### .
,##. /
OracleDbType##0 <
.##< =
Varchar2##= E
)##E F
.##F G
Value##G L
=##M N
customer##O W
.##W X
forename##X `
;##` a
cmd$$ 
.$$ 

Parameters$$ 
.$$ 
Add$$ "
($$" #
$str$$# -
,$$- .
OracleDbType$$/ ;
.$$; <
Varchar2$$< D
)$$D E
.$$E F
Value$$F K
=$$L M
customer$$N V
.$$V W
surname$$W ^
;$$^ _
cmd%% 
.%% 

Parameters%% 
.%% 
Add%% "
(%%" #
$str%%# +
,%%+ ,
OracleDbType%%- 9
.%%9 :
Varchar2%%: B
)%%B C
.%%C D
Value%%D I
=%%J K
customer%%L T
.%%T U
email%%U Z
;%%Z [
cmd&& 
.&& 

Parameters&& 
.&& 
Add&& "
(&&" #
$str&&# +
,&&+ ,
OracleDbType&&- 9
.&&9 :
Varchar2&&: B
)&&B C
.&&C D
Value&&D I
=&&J K
customer&&L T
.&&T U
phone&&U Z
;&&Z [
cmd'' 
.'' 

Parameters'' 
.'' 
Add'' "
(''" #
$str''# -
,''- .
OracleDbType''/ ;
.''; <
Varchar2''< D
)''D E
.''E F
Value''F K
=''L M
customer''N V
.''V W
eircode''W ^
;''^ _
conn)) 
.)) 
Open)) 
()) 
))) 
;)) 
cmd** 
.** 
ExecuteNonQuery** #
(**# $
)**$ %
;**% &
conn++ 
.++ 
Close++ 
(++ 
)++ 
;++ 
},, 
}-- 	
public// 
void// 
UpdateCustomer// "
(//" #
Customer//# +
customer//, 4
)//4 5
{00 	
using11 
(11 
var11 
conn11 
=11 
new11 !
OracleConnection11" 2
(112 3
_connectionString113 D
)11D E
)11E F
{22 
string33 
sqlQuery33 
=33  !
$str	33" –
+
33— ˜
$str44" B
;44B C
var66 
cmd66 
=66 
new66 
OracleCommand66 +
(66+ ,
sqlQuery66, 4
,664 5
conn666 :
)66: ;
;66; <
cmd77 
.77 

Parameters77 
.77 
Add77 "
(77" #
$str77# 0
,770 1
OracleDbType772 >
.77> ?
Int3277? D
)77D E
.77E F
Value77F K
=77L M
customer77N V
.77V W

customerId77W a
;77a b
cmd88 
.88 

Parameters88 
.88 
Add88 "
(88" #
$str88# .
,88. /
OracleDbType880 <
.88< =
Varchar288= E
)88E F
.88F G
Value88G L
=88M N
customer88O W
.88W X
forename88X `
;88` a
cmd99 
.99 

Parameters99 
.99 
Add99 "
(99" #
$str99# -
,99- .
OracleDbType99/ ;
.99; <
Varchar299< D
)99D E
.99E F
Value99F K
=99L M
customer99N V
.99V W
surname99W ^
;99^ _
cmd:: 
.:: 

Parameters:: 
.:: 
Add:: "
(::" #
$str::# +
,::+ ,
OracleDbType::- 9
.::9 :
Varchar2::: B
)::B C
.::C D
Value::D I
=::J K
customer::L T
.::T U
email::U Z
;::Z [
cmd;; 
.;; 

Parameters;; 
.;; 
Add;; "
(;;" #
$str;;# +
,;;+ ,
OracleDbType;;- 9
.;;9 :
Varchar2;;: B
);;B C
.;;C D
Value;;D I
=;;J K
customer;;L T
.;;T U
phone;;U Z
;;;Z [
cmd<< 
.<< 

Parameters<< 
.<< 
Add<< "
(<<" #
$str<<# -
,<<- .
OracleDbType<</ ;
.<<; <
Varchar2<<< D
)<<D E
.<<E F
Value<<F K
=<<L M
customer<<N V
.<<V W
eircode<<W ^
;<<^ _
conn>> 
.>> 
Open>> 
(>> 
)>> 
;>> 
cmd?? 
.?? 
ExecuteNonQuery?? #
(??# $
)??$ %
;??% &
conn@@ 
.@@ 
Close@@ 
(@@ 
)@@ 
;@@ 
}AA 
}BB 	
publicDD 
DataSetDD 
SearchCustomersDD &
(DD& '
stringDD' -
searchPhraseDD. :
)DD: ;
{EE 	
usingFF 
(FF 
varFF 
connFF 
=FF 
newFF !
OracleConnectionFF" 2
(FF2 3
_connectionStringFF3 D
)FFD E
)FFE F
{GG 
stringHH 
sqlQueryHH 
=HH  !
$strHH" `
+HHa b
$str	II" ƒ
+
II„ …
$str	JJ" ‘
;
JJ‘ ’
varLL 
cmdLL 
=LL 
newLL 
OracleCommandLL +
(LL+ ,
sqlQueryLL, 4
,LL4 5
connLL6 :
)LL: ;
;LL; <
cmdMM 
.MM 

ParametersMM 
.MM 
AddMM "
(MM" #
$strMM# ,
,MM, -
OracleDbTypeMM. :
.MM: ;
Varchar2MM; C
)MMC D
.MMD E
ValueMME J
=MMK L
$"MMM O
$strMMO P
{MMP Q
searchPhraseMMQ ]
}MM] ^
$strMM^ _
"MM_ `
;MM` a
OracleDataAdapterOO !
daOO" $
=OO% &
newOO' *
OracleDataAdapterOO+ <
(OO< =
cmdOO= @
)OO@ A
;OOA B
DataSetPP 
dsPP 
=PP 
newPP  
DataSetPP! (
(PP( )
)PP) *
;PP* +
daQQ 
.QQ 
FillQQ 
(QQ 
dsQQ 
,QQ 
$strQQ &
)QQ& '
;QQ' (
returnRR 
dsRR 
;RR 
}SS 
}TT 	
publicWW 
DataSetWW  
GetFilteredCustomersWW +
(WW+ ,
StringWW, 2
custIdAsStringWW3 A
,WWA B
StringWWC I
forenameWWJ R
,WWR S
StringWWT Z
surnameWW[ b
,WWb c
StringWWd j
emailWWk p
,WWp q
StringWWr x
phoneWWy ~
,WW~ 
String
WW€ †
eircode
WW‡ Ž
,
WWŽ 
String
WW –
phrase
WW— 
)
WW ž
{XX 	
OracleConnectionYY 
connYY !
=YY" #
newYY$ '
OracleConnectionYY( 8
(YY8 9
	DbConnectYY9 B
.YYB C
OradbYYC H
)YYH I
;YYI J
String[[ 
sqlQuery[[ 
=[[ 
DetermineSqlQuery[[ /
([[/ 0
custIdAsString[[0 >
,[[> ?
forename[[@ H
,[[H I
surname[[J Q
,[[Q R
email[[S X
,[[X Y
phone[[Z _
,[[_ `
eircode[[a h
,[[h i
phrase[[j p
)[[p q
;[[q r
OracleCommand]] 
cmd]] 
=]] 
new]]  #
OracleCommand]]$ 1
(]]1 2
sqlQuery]]2 :
,]]: ;
conn]]< @
)]]@ A
;]]A B
OracleDataAdapter__ 
da__  
=__! "
new__# &
OracleDataAdapter__' 8
(__8 9
cmd__9 <
)__< =
;__= >
DataSetaa 
dsaa 
=aa 
newaa 
DataSetaa $
(aa$ %
)aa% &
;aa& '
dabb 
.bb 
Fillbb 
(bb 
dsbb 
,bb 
$strbb "
)bb" #
;bb# $
conndd 
.dd 
Closedd 
(dd 
)dd 
;dd 
returnff 
dsff 
;ff 
}hh 	
privateii 
staticii 
Stringii 
DetermineSqlQueryii /
(ii/ 0
Stringii0 6
custIdAsStringii7 E
,iiE F
StringiiG M
forenameiiN V
,iiV W
StringiiX ^
surnameii_ f
,iif g
Stringiih n
emailiio t
,iit u
Stringiiv |
phone	ii} ‚
,
ii‚ ƒ
String
ii„ Š
eircode
ii‹ ’
,
ii’ “
String
ii” š
phrase
ii› ¡
)
ii¡ ¢
{jj 	
Stringkk 
sqlQuerykk 
=kk 
$strkk  
;kk  !
ifmm 
(mm 
stringmm 
.mm 
IsNullOrEmptymm $
(mm$ %
custIdAsStringmm% 3
)mm3 4
&&mm5 7
Stringmm8 >
.mm> ?
IsNullOrEmptymm? L
(mmL M
forenamemmM U
)mmU V
&&mmW Y
stringmmZ `
.mm` a
IsNullOrEmptymma n
(mmn o
surnamemmo v
)mmv w
&&mmx z
string	mm{ 
.
mm ‚
IsNullOrEmpty
mm‚ 
(
mm 
email
mm •
)
mm• –
&&
mm— ™
string
mmš  
.
mm  ¡
IsNullOrEmpty
mm¡ ®
(
mm® ¯
phone
mm¯ ´
)
mm´ µ
&&
mm¶ ¸
string
mm¹ ¿
.
mm¿ À
IsNullOrEmpty
mmÀ Í
(
mmÍ Î
eircode
mmÎ Õ
)
mmÕ Ö
&&
mm× Ù
string
mmÚ à
.
mmà á
IsNullOrEmpty
mmá î
(
mmî ï
phrase
mmï õ
)
mmõ ö
)
mmö ÷
{nn 
sqlQueryoo 
=oo 
$stroo g
;oog h
}pp 
elseqq 
ifqq 
(qq 
!qq 
stringqq 
.qq 
IsNullOrEmptyqq *
(qq* +
custIdAsStringqq+ 9
)qq9 :
||qq; =
!qq> ?
stringqq? E
.qqE F
IsNullOrEmptyqqF S
(qqS T
forenameqqT \
)qq\ ]
||qq^ `
!qqa b
stringqqb h
.qqh i
IsNullOrEmptyqqi v
(qqv w
surnameqqw ~
)qq~ 
||
qq€ ‚
!
qqƒ „
string
qq„ Š
.
qqŠ ‹
IsNullOrEmpty
qq‹ ˜
(
qq˜ ™
email
qq™ ž
)
qqž Ÿ
||
qq  ¢
!
qq£ ¤
string
qq¤ ª
.
qqª «
IsNullOrEmpty
qq« ¸
(
qq¸ ¹
phone
qq¹ ¾
)
qq¾ ¿
||
qqÀ Â
!
qqÃ Ä
string
qqÄ Ê
.
qqÊ Ë
IsNullOrEmpty
qqË Ø
(
qqØ Ù
eircode
qqÙ à
)
qqà á
||
qqâ ä
!
qqå æ
string
qqæ ì
.
qqì í
IsNullOrEmpty
qqí ú
(
qqú û
phrase
qqû 
)
qq ‚
)
qq‚ ƒ
{rr 
sqlQueryss 
=ss 
$strss s
;sss t
ifuu 
(uu 
!uu 
stringuu 
.uu 
IsNullOrEmptyuu )
(uu) *
custIdAsStringuu* 8
)uu8 9
)uu9 :
{vv 
intww 
custIdww 
;ww 
ifxx 
(xx 
Decimalxx 
.xx  
TryParsexx  (
(xx( )
custIdAsStringxx) 7
,xx7 8
outxx9 <
_xx= >
)xx> ?
)xx? @
{yy 
custIdzz 
=zz  
Convertzz! (
.zz( )
ToInt32zz) 0
(zz0 1
custIdAsStringzz1 ?
)zz? @
;zz@ A
sqlQuery{{  
+={{! #
$str{{$ 8
+{{9 :
custId{{; A
;{{A B
}|| 
}}} 
if 
( 
! 
string 
. 
IsNullOrEmpty )
() *
forename* 2
)2 3
)3 4
{
€€ 
sqlQuery
 
+=
 
$str
  D
+
E F
forename
G O
+
P Q
$str
R W
;
W X
}
‚‚ 
if
„„ 
(
„„ 
!
„„ 
string
„„ 
.
„„ 
IsNullOrEmpty
„„ )
(
„„) *
surname
„„* 1
)
„„1 2
)
„„2 3
{
…… 
sqlQuery
†† 
+=
†† 
$str
††  C
+
††D E
surname
††F M
+
††N O
$str
††P U
;
††U V
}
‡‡ 
if
‰‰ 
(
‰‰ 
!
‰‰ 
string
‰‰ 
.
‰‰ 
IsNullOrEmpty
‰‰ )
(
‰‰) *
email
‰‰* /
)
‰‰/ 0
)
‰‰0 1
{
ŠŠ 
sqlQuery
‹‹ 
+=
‹‹ 
$str
‹‹  A
+
‹‹B C
email
‹‹D I
+
‹‹J K
$str
‹‹L Q
;
‹‹Q R
}
ŒŒ 
if
ŽŽ 
(
ŽŽ 
!
ŽŽ 
string
ŽŽ 
.
ŽŽ 
IsNullOrEmpty
ŽŽ )
(
ŽŽ) *
phone
ŽŽ* /
)
ŽŽ/ 0
)
ŽŽ0 1
{
 
sqlQuery
 
+=
 
$str
  1
+
2 3
phone
4 9
+
: ;
$str
< @
;
@ A
}
‘‘ 
if
’’ 
(
’’ 
!
’’ 
string
’’ 
.
’’ 
IsNullOrEmpty
’’ )
(
’’) *
eircode
’’* 1
)
’’1 2
)
’’2 3
{
““ 
sqlQuery
”” 
+=
”” 
$str
””  C
+
””D E
eircode
””F M
+
””N O
$str
””P U
;
””U V
}
•• 
if
–– 
(
–– 
!
–– 
string
–– 
.
–– 
IsNullOrEmpty
–– )
(
––) *
phrase
––* 0
)
––0 1
)
––1 2
{
—— 
sqlQuery
˜˜ 
+=
˜˜ 
$str
˜˜  E
+
˜˜F G
phrase
˜˜H N
+
˜˜O P
$str
˜˜Q W
+
˜˜X Y
$str
™™ 9
+
™™: ;
phrase
™™< B
+
™™C D
$str
™™E K
+
™™L M
$str
šš 7
+
šš8 9
phrase
šš: @
+
ššA B
$str
ššC I
+
ššJ K
$str
›› 7
+
››8 9
phrase
››: @
+
››A B
$str
››C I
+
››J K
$str
œœ 9
+
œœ: ;
phrase
œœ< B
+
œœC D
$str
œœE K
;
œœK L
}
 
}
žž 
return
ŸŸ 
sqlQuery
ŸŸ 
;
ŸŸ 
}
   	
}
¡¡ 
}¢¢ ê'
EC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\AnalysisData.cs
	namespace 	
ToolSYS
 
. 
Data 
{ 
public 

class 
AnalysisData 
{ 
private 
readonly 
string 
_connectionString  1
=2 3
	DbConnect4 =
.= >
Oradb> C
;C D
public

 
	DataTable

 
GetDistinctYears

 )
(

) *
)

* +
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
_connectionString3 D
)D E
)E F
{ 
string 
sqlQuery 
=  !
$str" w
;w x
OracleCommand 
cmd !
=" #
new$ '
OracleCommand( 5
(5 6
sqlQuery6 >
,> ?
conn@ D
)D E
;E F
conn 
. 
Open 
( 
) 
; 
	DataTable 

yearsTable $
=% &
new' *
	DataTable+ 4
(4 5
)5 6
;6 7
using 
( 
OracleDataReader '
reader( .
=/ 0
cmd1 4
.4 5
ExecuteReader5 B
(B C
)C D
)D E
{ 

yearsTable 
. 
Load #
(# $
reader$ *
)* +
;+ ,
} 
return 

yearsTable !
;! "
} 
} 	
public 
	DataTable 
GetMonthlyRevenues +
(+ ,
int, /
year0 4
)4 5
{ 	
string 
sqlQuery 
= 
$str# <
;##< =
using%% 
(%% 
var%% 
conn%% 
=%% 
new%% !
OracleConnection%%" 2
(%%2 3
_connectionString%%3 D
)%%D E
)%%E F
{&& 
OracleCommand'' 
cmd'' !
=''" #
new''$ '
OracleCommand''( 5
(''5 6
sqlQuery''6 >
,''> ?
conn''@ D
)''D E
;''E F
cmd(( 
.(( 

Parameters(( 
.(( 
Add(( "
(((" #
$str((# *
,((* +
year((, 0
.((0 1
ToString((1 9
(((9 :
)((: ;
)((; <
;((< =
	DataTable** 
revenueTable** &
=**' (
new**) ,
	DataTable**- 6
(**6 7
)**7 8
;**8 9
OracleDataAdapter++ !
da++" $
=++% &
new++' *
OracleDataAdapter+++ <
(++< =
cmd++= @
)++@ A
;++A B
conn-- 
.-- 
Open-- 
(-- 
)-- 
;-- 
da.. 
... 
Fill.. 
(.. 
revenueTable.. $
)..$ %
;..% &
return00 
revenueTable00 #
;00# $
}11 
}22 	
public44 
	DataTable44 '
GetMonthlyRentalsByCategory44 4
(444 5
int445 8
year449 =
,44= >
string44? E
categoryCode44F R
)44R S
{55 	
string66 
sqlQuery66 
=66 
$str6= 
;==  
using?? 
(?? 
var?? 
conn?? 
=?? 
new?? !
OracleConnection??" 2
(??2 3
_connectionString??3 D
)??D E
)??E F
{@@ 
OracleCommandAA 
cmdAA !
=AA" #
newAA$ '
OracleCommandAA( 5
(AA5 6
sqlQueryAA6 >
,AA> ?
connAA@ D
)AAD E
;AAE F
cmdBB 
.BB 

ParametersBB 
.BB 
AddBB "
(BB" #
$strBB# *
,BB* +
yearBB, 0
.BB0 1
ToStringBB1 9
(BB9 :
)BB: ;
)BB; <
;BB< =
cmdCC 
.CC 

ParametersCC 
.CC 
AddCC "
(CC" #
$strCC# 2
,CC2 3
categoryCodeCC4 @
)CC@ A
;CCA B
OracleDataAdapterEE !
daEE" $
=EE% &
newEE' *
OracleDataAdapterEE+ <
(EE< =
cmdEE= @
)EE@ A
;EEA B
	DataTableFF 
dtFF 
=FF 
newFF "
	DataTableFF# ,
(FF, -
)FF- .
;FF. /
connHH 
.HH 
OpenHH 
(HH 
)HH 
;HH 
daII 
.II 
FillII 
(II 
dtII 
)II 
;II 
returnKK 
dtKK 
;KK 
}LL 
}MM 	
}NN 
}OO 