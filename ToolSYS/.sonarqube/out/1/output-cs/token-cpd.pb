„ª
AC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\ToolData.cs
	namespace 	
ToolSYS
 
. 
Data 
{ 
public 

	interface 
	IToolData 
{ 
void		 
AddTool		 
(		 
Tool		 
tool		 
)		 
;		  
void

 

UpdateTool

 
(

 
Tool

 
tool

 !
)

! "
;

" #
void 

RemoveTool 
( 
int 
toolId "
)" #
;# $
int 
GetNextToolId 
( 
) 
; 
DataSet 
GetFilteredTools  
(  !
string! '
toolIdAsString( 6
,6 7
string8 >
categoryCode? K
,K L
stringM S
descriptionT _
,_ `
stringa g
manufacturerh t
,t u
stringv |
status	} ƒ
,
ƒ „
string
… ‹
phrase
Œ ’
)
’ “
;
“ ”
DataSet 
GetAvailableTools !
(! "
)" #
;# $
DataSet 
GetRentableTools  
(  !
string! '
categoryCode( 4
,4 5
DateTime6 >
from? C
,C D
DateTimeE M
toN P
)P Q
;Q R
bool 

ToolExists 
( 
int 
toolId #
)# $
;$ %
} 
public 

class 
ToolData 
: 
	IToolData %
{ 
private 
readonly 
string 
_connectionString  1
=2 3
	DbConnect4 =
.= >
Oradb> C
;C D
public 
void 
AddTool 
( 
Tool  
tool! %
)% &
{ 	
using 
( 
OracleConnection #
conn$ (
=) *
new+ .
OracleConnection/ ?
(? @
_connectionString@ Q
)Q R
)R S
{ 
string 
sqlQuery 
=  !
$str" |
+} ~
$str$ w
;w x
OracleCommand 
cmd !
=" #
new$ '
OracleCommand( 5
(5 6
sqlQuery6 >
,> ?
conn@ D
)D E
;E F
cmd 
. 

Parameters 
. 
Add "
(" #
$str# ,
,, -
tool. 2
.2 3
toolId3 9
)9 :
;: ;
cmd   
.   

Parameters   
.   
Add   "
(  " #
$str  # 2
,  2 3
tool  4 8
.  8 9
categoryCode  9 E
.  E F
	Substring  F O
(  O P
$num  P Q
,  Q R
$num  S T
)  T U
)  U V
;  V W
cmd!! 
.!! 

Parameters!! 
.!! 
Add!! "
(!!" #
$str!!# 5
,!!5 6
tool!!7 ;
.!!; <
toolDescription!!< K
)!!K L
;!!L M
cmd"" 
."" 

Parameters"" 
."" 
Add"" "
(""" #
$str""# 6
,""6 7
tool""8 <
.""< =
toolManufacturer""= M
)""M N
;""N O
cmd## 
.## 

Parameters## 
.## 
Add## "
(##" #
$str### 0
,##0 1
tool##2 6
.##6 7

toolStatus##7 A
)##A B
;##B C
conn%% 
.%% 
Open%% 
(%% 
)%% 
;%% 
cmd&& 
.&& 
ExecuteNonQuery&& #
(&&# $
)&&$ %
;&&% &
}'' 
}(( 	
public** 
void** 

UpdateTool** 
(** 
Tool** #
tool**$ (
)**( )
{++ 	
using,, 
(,, 
OracleConnection,, #
conn,,$ (
=,,) *
new,,+ .
OracleConnection,,/ ?
(,,? @
_connectionString,,@ Q
),,Q R
),,R S
{-- 
string.. 
sqlQuery.. 
=..  !
$str.." 5
+..6 7
$str//$ D
+//E F
$str00$ J
+00K L
$str11$ L
+11M N
$str22$ ?
+22@ A
$str33$ <
;33< =
OracleCommand55 
cmd55 !
=55" #
new55$ '
OracleCommand55( 5
(555 6
sqlQuery556 >
,55> ?
conn55@ D
)55D E
;55E F
cmd66 
.66 

Parameters66 
.66 
Add66 "
(66" #
$str66# 2
,662 3
tool664 8
.668 9
categoryCode669 E
)66E F
;66F G
cmd77 
.77 

Parameters77 
.77 
Add77 "
(77" #
$str77# 5
,775 6
tool777 ;
.77; <
toolDescription77< K
)77K L
;77L M
cmd88 
.88 

Parameters88 
.88 
Add88 "
(88" #
$str88# 6
,886 7
tool888 <
.88< =
toolManufacturer88= M
)88M N
;88N O
cmd99 
.99 

Parameters99 
.99 
Add99 "
(99" #
$str99# 0
,990 1
tool992 6
.996 7

toolStatus997 A
)99A B
;99B C
cmd:: 
.:: 

Parameters:: 
.:: 
Add:: "
(::" #
$str::# ,
,::, -
tool::. 2
.::2 3
toolId::3 9
)::9 :
;::: ;
conn<< 
.<< 
Open<< 
(<< 
)<< 
;<< 
cmd== 
.== 
ExecuteNonQuery== #
(==# $
)==$ %
;==% &
}>> 
}?? 	
publicAA 
voidAA 

RemoveToolAA 
(AA 
intAA "
toolIdAA# )
)AA) *
{BB 	
usingCC 
(CC 
OracleConnectionCC #
connCC$ (
=CC) *
newCC+ .
OracleConnectionCC/ ?
(CC? @
_connectionStringCC@ Q
)CCQ R
)CCR S
{DD 
stringEE 
sqlQueryEE 
=EE  !
$strEE" \
;EE\ ]
OracleCommandFF 
cmdFF !
=FF" #
newFF$ '
OracleCommandFF( 5
(FF5 6
sqlQueryFF6 >
,FF> ?
connFF@ D
)FFD E
;FFE F
cmdGG 
.GG 

ParametersGG 
.GG 
AddGG "
(GG" #
$strGG# ,
,GG, -
toolIdGG. 4
)GG4 5
;GG5 6
connII 
.II 
OpenII 
(II 
)II 
;II 
cmdJJ 
.JJ 
ExecuteNonQueryJJ #
(JJ# $
)JJ$ %
;JJ% &
}KK 
}LL 	
publicNN 
intNN 
GetNextToolIdNN  
(NN  !
)NN! "
{OO 	
usingPP 
(PP 
OracleConnectionPP #
connPP$ (
=PP) *
newPP+ .
OracleConnectionPP/ ?
(PP? @
_connectionStringPP@ Q
)PPQ R
)PPR S
{QQ 
stringRR 
sqlQueryRR 
=RR  !
$strRR" A
;RRA B
OracleCommandSS 
cmdSS !
=SS" #
newSS$ '
OracleCommandSS( 5
(SS5 6
sqlQuerySS6 >
,SS> ?
connSS@ D
)SSD E
;SSE F
connTT 
.TT 
OpenTT 
(TT 
)TT 
;TT 
objectVV 
resultVV 
=VV 
cmdVV  #
.VV# $
ExecuteScalarVV$ 1
(VV1 2
)VV2 3
;VV3 4
returnWW 
(WW 
resultWW 
==WW !
DBNullWW" (
.WW( )
ValueWW) .
)WW. /
?WW0 1
$numWW2 3
:WW4 5
ConvertWW6 =
.WW= >
ToInt32WW> E
(WWE F
resultWWF L
)WWL M
+WWN O
$numWWP Q
;WWQ R
}XX 
}YY 	
public[[ 
DataSet[[ 
GetFilteredTools[[ '
([[' (
string[[( .
toolIdAsString[[/ =
,[[= >
string[[? E
categoryCode[[F R
,[[R S
string[[T Z
description[[[ f
,[[f g
string[[h n
manufacturer[[o {
,[[{ |
string	[[} ƒ
status
[[„ Š
,
[[Š ‹
string
[[Œ ’
phrase
[[“ ™
)
[[™ š
{\\ 	
using]] 
(]] 
OracleConnection]] #
conn]]$ (
=]]) *
new]]+ .
OracleConnection]]/ ?
(]]? @
_connectionString]]@ Q
)]]Q R
)]]R S
{^^ 
string__ 
sqlQuery__ 
=__  !
DetermineSqlQuery__" 3
(__3 4
toolIdAsString__4 B
,__B C
categoryCode__D P
,__P Q
description__R ]
,__] ^
manufacturer___ k
,__k l
status__m s
,__s t
phrase__u {
)__{ |
;__| }
OracleCommandaa 
cmdaa !
=aa" #
newaa$ '
OracleCommandaa( 5
(aa5 6
sqlQueryaa6 >
,aa> ?
connaa@ D
)aaD E
;aaE F
OracleDataAdapterbb !
dabb" $
=bb% &
newbb' *
OracleDataAdapterbb+ <
(bb< =
cmdbb= @
)bb@ A
;bbA B
DataSetdd 
dsdd 
=dd 
newdd  
DataSetdd! (
(dd( )
)dd) *
;dd* +
daee 
.ee 
Fillee 
(ee 
dsee 
,ee 
$stree "
)ee" #
;ee# $
returngg 
dsgg 
;gg 
}hh 
}ii 	
privatekk 
statickk 
Stringkk 
DetermineSqlQuerykk /
(kk/ 0
Stringkk0 6
toolIdAsStringkk7 E
,kkE F
StringkkG M
categoryCodekkN Z
,kkZ [
Stringkk\ b
descriptionkkc n
,kkn o
Stringkkp v
manufacturer	kkw ƒ
,
kkƒ „
String
kk… ‹
status
kkŒ ’
,
kk’ “
String
kk” š
phrase
kk› ¡
)
kk¡ ¢
{ll 	
Stringmm 
sqlQuerymm 
=mm 
$strmm  
;mm  !
ifoo 
(oo 
stringoo 
.oo 
IsNullOrEmptyoo $
(oo$ %
toolIdAsStringoo% 3
)oo3 4
&&oo5 7
Stringoo8 >
.oo> ?
IsNullOrEmptyoo? L
(ooL M
categoryCodeooM Y
)ooY Z
&&oo[ ]
stringoo^ d
.ood e
IsNullOrEmptyooe r
(oor s
descriptionoos ~
)oo~ 
&&
oo€ ‚
string
ooƒ ‰
.
oo‰ Š
IsNullOrEmpty
ooŠ —
(
oo— ˜
manufacturer
oo˜ ¤
)
oo¤ ¥
&&
oo¦ ¨
string
oo© ¯
.
oo¯ °
IsNullOrEmpty
oo° ½
(
oo½ ¾
status
oo¾ Ä
)
ooÄ Å
&&
ooÆ È
string
ooÉ Ï
.
ooÏ Ð
IsNullOrEmpty
ooÐ Ý
(
ooÝ Þ
phrase
ooÞ ä
)
ooä å
)
ooå æ
{pp 
sqlQueryqq 
=qq 
$strqq r
;qqr s
}rr 
elsess 
ifss 
(ss 
!ss 
stringss 
.ss 
IsNullOrEmptyss *
(ss* +
toolIdAsStringss+ 9
)ss9 :
||ss; =
!ss> ?
stringss? E
.ssE F
IsNullOrEmptyssF S
(ssS T
categoryCodessT `
)ss` a
||ssb d
!sse f
stringssf l
.ssl m
IsNullOrEmptyssm z
(ssz {
description	ss{ †
)
ss† ‡
||
ssˆ Š
!
ss‹ Œ
string
ssŒ ’
.
ss’ “
IsNullOrEmpty
ss“  
(
ss  ¡
manufacturer
ss¡ ­
)
ss­ ®
||
ss¯ ±
!
ss² ³
string
ss³ ¹
.
ss¹ º
IsNullOrEmpty
ssº Ç
(
ssÇ È
status
ssÈ Î
)
ssÎ Ï
||
ssÐ Ò
!
ssÓ Ô
string
ssÔ Ú
.
ssÚ Û
IsNullOrEmpty
ssÛ è
(
ssè é
phrase
ssé ï
)
ssï ð
)
ssð ñ
{tt 
sqlQueryuu 
=uu 
$struu ~
;uu~ 
ifww 
(ww 
!ww 
stringww 
.ww 
IsNullOrEmptyww )
(ww) *
toolIdAsStringww* 8
)ww8 9
)ww9 :
{xx 
intyy 
toolIdyy 
=yy  
Convertyy! (
.yy( )
ToInt32yy) 0
(yy0 1
toolIdAsStringyy1 ?
)yy? @
;yy@ A
sqlQueryzz 
+=zz 
$strzz  0
+zz1 2
toolIdzz3 9
;zz9 :
}{{ 
if}} 
(}} 
!}} 
string}} 
.}} 
IsNullOrEmpty}} )
(}}) *
categoryCode}}* 6
)}}6 7
)}}7 8
{~~ 
categoryCode  
=! "
categoryCode# /
./ 0
	Substring0 9
(9 :
$num: ;
,; <
$num= >
)> ?
;? @
sqlQuery
€€ 
+=
€€ 
$str
€€  G
+
€€H I
categoryCode
€€J V
+
€€W X
$str
€€Y ]
;
€€] ^
}
 
if
ƒƒ 
(
ƒƒ 
!
ƒƒ 
string
ƒƒ 
.
ƒƒ 
IsNullOrEmpty
ƒƒ )
(
ƒƒ) *
description
ƒƒ* 5
)
ƒƒ5 6
)
ƒƒ6 7
{
„„ 
sqlQuery
…… 
+=
…… 
$str
……  K
+
……L M
description
……N Y
+
……Z [
$str
……\ a
;
……a b
}
†† 
if
ˆˆ 
(
ˆˆ 
!
ˆˆ 
string
ˆˆ 
.
ˆˆ 
IsNullOrEmpty
ˆˆ )
(
ˆˆ) *
manufacturer
ˆˆ* 6
)
ˆˆ6 7
)
ˆˆ7 8
{
‰‰ 
sqlQuery
ŠŠ 
+=
ŠŠ 
$str
ŠŠ  L
+
ŠŠM N
manufacturer
ŠŠO [
+
ŠŠ\ ]
$str
ŠŠ^ c
;
ŠŠc d
}
‹‹ 
if
 
(
 
!
 
string
 
.
 
IsNullOrEmpty
 )
(
) *
status
* 0
)
0 1
)
1 2
{
ŽŽ 
status
 
=
 
status
 #
.
# $
	Substring
$ -
(
- .
$num
. /
,
/ 0
$num
1 2
)
2 3
;
3 4
sqlQuery
 
+=
 
$str
  5
+
6 7
status
8 >
+
? @
$str
A D
;
D E
}
‘‘ 
if
““ 
(
““ 
!
““ 
string
““ 
.
““ 
IsNullOrEmpty
““ )
(
““) *
phrase
““* 0
)
““0 1
)
““1 2
{
”” 
sqlQuery
•• 
+=
•• 
$str
••  I
+
••J K
phrase
••L R
+
••S T
$str
••U [
+
••\ ]
$str
–– A
+
––B C
phrase
––D J
+
––K L
$str
––M S
+
––T U
$str
—— B
+
——C D
phrase
——E K
+
——L M
$str
——N T
;
——T U
}
˜˜ 
}
™™ 
return
šš 
sqlQuery
šš 
;
šš 
}
›› 	
public
žž 
DataSet
žž 
GetAvailableTools
žž (
(
žž( )
)
žž) *
{
ŸŸ 	
using
   
(
   
OracleConnection
   #
conn
  $ (
=
  ) *
new
  + .
OracleConnection
  / ?
(
  ? @
_connectionString
  @ Q
)
  Q R
)
  R S
{
¡¡ 
string
¢¢ 
sqlQuery
¢¢ 
=
¢¢  !
$str
¢¢" n
+
¢¢o p
$str
££ (
;
££( )
OracleCommand
¥¥ 
cmd
¥¥ !
=
¥¥" #
new
¥¥$ '
OracleCommand
¥¥( 5
(
¥¥5 6
sqlQuery
¥¥6 >
,
¥¥> ?
conn
¥¥@ D
)
¥¥D E
;
¥¥E F
OracleDataAdapter
¦¦ !
da
¦¦" $
=
¦¦% &
new
¦¦' *
OracleDataAdapter
¦¦+ <
(
¦¦< =
cmd
¦¦= @
)
¦¦@ A
;
¦¦A B
DataSet
¨¨ 
ds
¨¨ 
=
¨¨ 
new
¨¨  
DataSet
¨¨! (
(
¨¨( )
)
¨¨) *
;
¨¨* +
da
©© 
.
©© 
Fill
©© 
(
©© 
ds
©© 
,
©© 
$str
©© "
)
©©" #
;
©©# $
return
«« 
ds
«« 
;
«« 
}
¬¬ 
}
­­ 	
public
¯¯ 
DataSet
¯¯ 
GetRentableTools
¯¯ '
(
¯¯' (
string
¯¯( .
categoryCode
¯¯/ ;
,
¯¯; <
DateTime
¯¯= E
from
¯¯F J
,
¯¯J K
DateTime
¯¯L T
to
¯¯U W
)
¯¯W X
{
°° 	
using
±± 
(
±± 
OracleConnection
±± #
conn
±±$ (
=
±±) *
new
±±+ .
OracleConnection
±±/ ?
(
±±? @
_connectionString
±±@ Q
)
±±Q R
)
±±R S
{
²² 
string
³³ 
sqlQuery
³³ 
=
³³  !
$str
³½" 
;
½½ 
using
¿¿ 
(
¿¿ 
OracleCommand
¿¿ $
cmd
¿¿% (
=
¿¿) *
new
¿¿+ .
OracleCommand
¿¿/ <
(
¿¿< =
sqlQuery
¿¿= E
,
¿¿E F
conn
¿¿G K
)
¿¿K L
)
¿¿L M
{
ÀÀ 
cmd
ÁÁ 
.
ÁÁ 

Parameters
ÁÁ "
.
ÁÁ" #
Add
ÁÁ# &
(
ÁÁ& '
new
ÁÁ' *
OracleParameter
ÁÁ+ :
(
ÁÁ: ;
$str
ÁÁ; J
,
ÁÁJ K
categoryCode
ÁÁL X
)
ÁÁX Y
)
ÁÁY Z
;
ÁÁZ [
cmd
ÂÂ 
.
ÂÂ 

Parameters
ÂÂ "
.
ÂÂ" #
Add
ÂÂ# &
(
ÂÂ& '
new
ÂÂ' *
OracleParameter
ÂÂ+ :
(
ÂÂ: ;
$str
ÂÂ; F
,
ÂÂF G
from
ÂÂH L
.
ÂÂL M
ToString
ÂÂM U
(
ÂÂU V
$str
ÂÂV a
)
ÂÂa b
)
ÂÂb c
)
ÂÂc d
;
ÂÂd e
cmd
ÃÃ 
.
ÃÃ 

Parameters
ÃÃ "
.
ÃÃ" #
Add
ÃÃ# &
(
ÃÃ& '
new
ÃÃ' *
OracleParameter
ÃÃ+ :
(
ÃÃ: ;
$str
ÃÃ; D
,
ÃÃD E
to
ÃÃF H
.
ÃÃH I
ToString
ÃÃI Q
(
ÃÃQ R
$str
ÃÃR ]
)
ÃÃ] ^
)
ÃÃ^ _
)
ÃÃ_ `
;
ÃÃ` a
OracleDataAdapter
ÅÅ %
da
ÅÅ& (
=
ÅÅ) *
new
ÅÅ+ .
OracleDataAdapter
ÅÅ/ @
(
ÅÅ@ A
cmd
ÅÅA D
)
ÅÅD E
;
ÅÅE F
DataSet
ÆÆ 
ds
ÆÆ 
=
ÆÆ  
new
ÆÆ! $
DataSet
ÆÆ% ,
(
ÆÆ, -
)
ÆÆ- .
;
ÆÆ. /
da
ÇÇ 
.
ÇÇ 
Fill
ÇÇ 
(
ÇÇ 
ds
ÇÇ 
,
ÇÇ 
$str
ÇÇ  &
)
ÇÇ& '
;
ÇÇ' (
return
ÉÉ 
ds
ÉÉ 
;
ÉÉ 
}
ÊÊ 
}
ËË 
}
ÌÌ 	
public
ÍÍ 
bool
ÍÍ 

ToolExists
ÍÍ 
(
ÍÍ 
int
ÍÍ "
toolId
ÍÍ# )
)
ÍÍ) *
{
ÎÎ 	
using
ÏÏ 
(
ÏÏ 
OracleConnection
ÏÏ #
conn
ÏÏ$ (
=
ÏÏ) *
new
ÏÏ+ .
OracleConnection
ÏÏ/ ?
(
ÏÏ? @
_connectionString
ÏÏ@ Q
)
ÏÏQ R
)
ÏÏR S
{
ÐÐ 
string
ÑÑ 
sqlQuery
ÑÑ 
=
ÑÑ  !
$str
ÑÑ" j
;
ÑÑj k
OracleCommand
ÒÒ 
cmd
ÒÒ !
=
ÒÒ" #
new
ÒÒ$ '
OracleCommand
ÒÒ( 5
(
ÒÒ5 6
sqlQuery
ÒÒ6 >
,
ÒÒ> ?
conn
ÒÒ@ D
)
ÒÒD E
;
ÒÒE F
cmd
ÓÓ 
.
ÓÓ 

Parameters
ÓÓ 
.
ÓÓ 
Add
ÓÓ "
(
ÓÓ" #
$str
ÓÓ# ,
,
ÓÓ, -
toolId
ÓÓ. 4
)
ÓÓ4 5
;
ÓÓ5 6
conn
ÕÕ 
.
ÕÕ 
Open
ÕÕ 
(
ÕÕ 
)
ÕÕ 
;
ÕÕ 
int
ÖÖ 
count
ÖÖ 
=
ÖÖ 
Convert
ÖÖ #
.
ÖÖ# $
ToInt32
ÖÖ$ +
(
ÖÖ+ ,
cmd
ÖÖ, /
.
ÖÖ/ 0
ExecuteScalar
ÖÖ0 =
(
ÖÖ= >
)
ÖÖ> ?
)
ÖÖ? @
;
ÖÖ@ A
conn
×× 
.
×× 
Close
×× 
(
×× 
)
×× 
;
×× 
return
ÙÙ 
count
ÙÙ 
>
ÙÙ 
$num
ÙÙ  
;
ÙÙ  !
}
ÚÚ 
}
ÛÛ 	
}
ÝÝ 
}ÞÞ Â
GC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\RentalItemData.cs
	namespace 	
ToolSYS
 
. 
Data 
{ 
public 

	interface 
IRentalItemData $
{ 
void 
AddRentalItem 
( 

RentalItem %

rentalItem& 0
)0 1
;1 2
}		 
public 

class 
RentalItemData 
:  !
IRentalItemData" 1
{ 
private 
readonly 
string 
_connectionString  1
=2 3
	DbConnect4 =
.= >
Oradb> C
;C D
public 
void 
AddRentalItem !
(! "

RentalItem" ,

rentalItem- 7
)7 8
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
_connectionString3 D
)D E
)E F
{ 
conn 
. 
Open 
( 
) 
; 
string 
	sqlInsert  
=! "
$str# T
;T U
var 
cmd 
= 
new 
OracleCommand +
(+ ,
	sqlInsert, 5
,5 6
conn7 ;
); <
;< =
cmd 
. 

Parameters 
. 
Add "
(" #
$str# .
,. /
OracleDbType0 <
.< =
Int32= B
)B C
.C D
ValueD I
=J K

rentalItemL V
.V W
rentalIdW _
;_ `
cmd 
. 

Parameters 
. 
Add "
(" #
$str# ,
,, -
OracleDbType. :
.: ;
Int32; @
)@ A
.A B
ValueB G
=H I

rentalItemJ T
.T U
toolIdU [
;[ \
cmd 
. 

Parameters 
. 
Add "
(" #
$str# .
,. /
OracleDbType0 <
.< =
Date= A
)A B
.B C
ValueC H
=I J

rentalItemK U
.U V
rentDateV ^
;^ _
cmd 
. 

Parameters 
. 
Add "
(" #
$str# 0
,0 1
OracleDbType2 >
.> ?
Date? C
)C D
.D E
ValueE J
=K L

rentalItemM W
.W X

returnDateX b
;b c
cmd 
. 

Parameters 
. 
Add "
(" #
$str# /
,/ 0
OracleDbType1 =
.= >
Decimal> E
)E F
.F G
ValueG L
=M N

rentalItemO Y
.Y Z
	rentalFeeZ c
;c d
cmd   
.   
ExecuteNonQuery   #
(  # $
)  $ %
;  % &
string"" 
sqlUpdateStatus"" &
=""' (
$str"") c
;""c d
cmd$$ 
=$$ 
new$$ 
OracleCommand$$ '
($$' (
sqlUpdateStatus$$( 7
,$$7 8
conn$$9 =
)$$= >
;$$> ?
cmd%% 
.%% 

Parameters%% 
.%% 
Add%% "
(%%" #
$str%%# ,
,%%, -
OracleDbType%%. :
.%%: ;
Int32%%; @
)%%@ A
.%%A B
Value%%B G
=%%H I

rentalItem%%J T
.%%T U
toolId%%U [
;%%[ \
cmd'' 
.'' 
ExecuteNonQuery'' #
(''# $
)''$ %
;''% &
}(( 
})) 	
}** 
}++ Š8
CC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\RentalData.cs
	namespace 	
ToolSYS
 
. 
Data 
{ 
public 

	interface 
IRentalData  
{ 
int		 
GetNextRentalId		 
(		 
)		 
;		 
void

 
	AddRental

 
(

 
Rental

 
rental

 $
)

$ %
;

% &
	DataTable $
GetRentalItemsByRentalId *
(* +
int+ .
rentalId/ 7
)7 8
;8 9
void 

ReturnTool 
( 
int 
rentalId $
,$ %
int& )
toolId* 0
)0 1
;1 2
} 
public 

class 

RentalData 
: 
IRentalData )
{ 
public 
int 
GetNextRentalId "
(" #
)# $
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
	DbConnect3 <
.< =
Oradb= B
)B C
)C D
{ 
conn 
. 
Open 
( 
) 
; 
string 
sqlQuery 
=  !
$str" Q
;Q R
var 
cmd 
= 
new 
OracleCommand +
(+ ,
sqlQuery, 4
,4 5
conn6 :
): ;
;; <
return 
Convert 
. 
ToInt32 &
(& '
cmd' *
.* +
ExecuteScalar+ 8
(8 9
)9 :
): ;
;; <
} 
} 	
public 
void 
	AddRental 
( 
Rental $
rental% +
)+ ,
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
	DbConnect3 <
.< =
Oradb= B
)B C
)C D
{ 
conn   
.   
Open   
(   
)   
;   
string!! 
sqlQuery!! 
=!!  !
$str!#" Q
;##Q R
var%% 
cmd%% 
=%% 
new%% 
OracleCommand%% +
(%%+ ,
sqlQuery%%, 4
,%%4 5
conn%%6 :
)%%: ;
;%%; <
cmd&& 
.&& 

Parameters&& 
.&& 
Add&& "
(&&" #
$str&&# .
,&&. /
rental&&0 6
.&&6 7
rentalId&&7 ?
)&&? @
;&&@ A
cmd'' 
.'' 

Parameters'' 
.'' 
Add'' "
(''" #
$str''# 0
,''0 1
rental''2 8
.''8 9

customerId''9 C
)''C D
;''D E
cmd(( 
.(( 

Parameters(( 
.(( 
Add(( "
(((" #
$str((# 5
,((5 6
rental((7 =
.((= >
transactionDate((> M
)((M N
;((N O
cmd)) 
.)) 

Parameters)) 
.)) 
Add)) "
())" #
$str))# .
,)). /
rental))0 6
.))6 7
totalFee))7 ?
)))? @
;))@ A
cmd** 
.** 
ExecuteNonQuery** #
(**# $
)**$ %
;**% &
}++ 
},, 	
public.. 
	DataTable.. $
GetRentalItemsByRentalId.. 1
(..1 2
int..2 5
rentalId..6 >
)..> ?
{// 	
using00 
(00 
var00 
conn00 
=00 
new00 !
OracleConnection00" 2
(002 3
	DbConnect003 <
.00< =
Oradb00= B
)00B C
)00C D
{11 
string22 
query22 
=22 
$str27 V
;77V W
OracleCommand99 
cmd99 !
=99" #
new99$ '
OracleCommand99( 5
(995 6
query996 ;
,99; <
conn99= A
)99A B
;99B C
cmd:: 
.:: 

Parameters:: 
.:: 
Add:: "
(::" #
$str::# .
,::. /
rentalId::0 8
)::8 9
;::9 :
OracleDataAdapter<< !
adapter<<" )
=<<* +
new<<, /
OracleDataAdapter<<0 A
(<<A B
cmd<<B E
)<<E F
;<<F G
	DataTable== 
dt== 
=== 
new== "
	DataTable==# ,
(==, -
)==- .
;==. /
adapter>> 
.>> 
Fill>> 
(>> 
dt>> 
)>>  
;>>  !
return@@ 
dt@@ 
;@@ 
}AA 
}BB 	
publicDD 
voidDD 

ReturnToolDD 
(DD 
intDD "
rentalIdDD# +
,DD+ ,
intDD- 0
toolIdDD1 7
)DD7 8
{EE 	
usingFF 
(FF 
varFF 
connFF 
=FF 
newFF !
OracleConnectionFF" 2
(FF2 3
	DbConnectFF3 <
.FF< =
OradbFF= B
)FFB C
)FFC D
{GG 
connHH 
.HH 
OpenHH 
(HH 
)HH 
;HH 
stringJJ 
updateToolQueryJJ &
=JJ' (
$strJJ) c
;JJc d
OracleCommandKK 
updateToolCmdKK +
=KK, -
newKK. 1
OracleCommandKK2 ?
(KK? @
updateToolQueryKK@ O
,KKO P
connKKQ U
)KKU V
;KKV W
updateToolCmdLL 
.LL 

ParametersLL (
.LL( )
AddLL) ,
(LL, -
$strLL- 6
,LL6 7
toolIdLL8 >
)LL> ?
;LL? @
updateToolCmdMM 
.MM 
ExecuteNonQueryMM -
(MM- .
)MM. /
;MM/ 0
stringOO !
updateRentalItemQueryOO ,
=OO- .
$strOR/ D
;RRD E
OracleCommandSS 
updateRentalCmdSS -
=SS. /
newSS0 3
OracleCommandSS4 A
(SSA B!
updateRentalItemQuerySSB W
,SSW X
connSSY ]
)SS] ^
;SS^ _
updateRentalCmdTT 
.TT  

ParametersTT  *
.TT* +
AddTT+ .
(TT. /
$strTT/ :
,TT: ;
rentalIdTT< D
)TTD E
;TTE F
updateRentalCmdUU 
.UU  

ParametersUU  *
.UU* +
AddUU+ .
(UU. /
$strUU/ 8
,UU8 9
toolIdUU: @
)UU@ A
;UUA B
updateRentalCmdVV 
.VV  
ExecuteNonQueryVV  /
(VV/ 0
)VV0 1
;VV1 2
}WW 
}XX 	
}YY 
}ZZ ÈC
AC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\RateData.cs
	namespace 	
ToolSYS
 
. 
Data 
{ 
public 

	interface 
	IRateData 
{ 
void		 
AddRate		 
(		 
Rate		 
rate		 
)		 
;		  
Rate

 !
GetRateByCategoryCode

 "
(

" #
string

# )
categoryCode

* 6
)

6 7
;

7 8
void 

UpdateRate 
( 
Rate 
rate !
)! "
;" #
DataSet 
GetAllCategories  
(  !
)! "
;" #
bool !
DoesCategoryCodeExist "
(" #
string# )
categoryCode* 6
)6 7
;7 8
} 
public 

class 
RateData 
: 
	IRateData %
{ 
private 
readonly 
string 
_connectionString  1
=2 3
	DbConnect4 =
.= >
Oradb> C
;C D
public 
void 
AddRate 
( 
Rate  
rate! %
)% &
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
_connectionString3 D
)D E
)E F
{ 
string 
sqlQuery 
=  !
$str	" …
;
… †
OracleCommand 
cmd !
=" #
new$ '
OracleCommand( 5
(5 6
sqlQuery6 >
,> ?
conn@ D
)D E
;E F
cmd 
. 

Parameters 
. 
Add "
(" #
$str# 2
,2 3
rate4 8
.8 9
categoryCode9 E
)E F
;F G
cmd 
. 

Parameters 
. 
Add "
(" #
$str# 2
,2 3
rate4 8
.8 9
categoryDesc9 E
)E F
;F G
cmd 
. 

Parameters 
. 
Add "
(" #
$str# *
,* +
rate, 0
.0 1
rate1 5
)5 6
;6 7
conn 
. 
Open 
( 
) 
; 
cmd 
. 
ExecuteNonQuery #
(# $
)$ %
;% &
}   
}!! 	
public## 
Rate## !
GetRateByCategoryCode## )
(##) *
string##* 0
categoryCode##1 =
)##= >
{$$ 	
using%% 
(%% 
var%% 
conn%% 
=%% 
new%% !
OracleConnection%%" 2
(%%2 3
_connectionString%%3 D
)%%D E
)%%E F
{&& 
string'' 
sqlQuery'' 
=''  !
$str(( k
;((k l
OracleCommand)) 
cmd)) !
=))" #
new))$ '
OracleCommand))( 5
())5 6
sqlQuery))6 >
,))> ?
conn))@ D
)))D E
;))E F
cmd** 
.** 

Parameters** 
.** 
Add** "
(**" #
$str**# 2
,**2 3
categoryCode**4 @
)**@ A
;**A B
conn,, 
.,, 
Open,, 
(,, 
),, 
;,, 
OracleDataReader--  
dr--! #
=--$ %
cmd--& )
.--) *
ExecuteReader--* 7
(--7 8
)--8 9
;--9 :
dr// 
.// 
Read// 
(// 
)// 
;// 
return00 
new00 
Rate00 
{11 
categoryCode22  
=22! "
dr22# %
.22% &
	GetString22& /
(22/ 0
$num220 1
)221 2
,222 3
categoryDesc33  
=33! "
dr33# %
.33% &
	GetString33& /
(33/ 0
$num330 1
)331 2
,332 3
rate44 
=44 
dr44 
.44 

GetDecimal44 (
(44( )
$num44) *
)44* +
}55 
;55 
}66 
}77 	
public99 
void99 

UpdateRate99 
(99 
Rate99 #
rate99$ (
)99( )
{:: 	
using;; 
(;; 
var;; 
conn;; 
=;; 
new;; !
OracleConnection;;" 2
(;;2 3
_connectionString;;3 D
);;D E
);;E F
{<< 
string== 
sqlQuery== 
===  !
$str	==" ‚
;
==‚ ƒ
OracleCommand>> 
cmd>> !
=>>" #
new>>$ '
OracleCommand>>( 5
(>>5 6
sqlQuery>>6 >
,>>> ?
conn>>@ D
)>>D E
;>>E F
cmd?? 
.?? 

Parameters?? 
.?? 
Add?? "
(??" #
$str??# 2
,??2 3
rate??4 8
.??8 9
categoryDesc??9 E
)??E F
;??F G
cmd@@ 
.@@ 

Parameters@@ 
.@@ 
Add@@ "
(@@" #
$str@@# *
,@@* +
rate@@, 0
.@@0 1
rate@@1 5
)@@5 6
;@@6 7
cmdAA 
.AA 

ParametersAA 
.AA 
AddAA "
(AA" #
$strAA# 2
,AA2 3
rateAA4 8
.AA8 9
categoryCodeAA9 E
)AAE F
;AAF G
connCC 
.CC 
OpenCC 
(CC 
)CC 
;CC 
cmdDD 
.DD 
ExecuteNonQueryDD #
(DD# $
)DD$ %
;DD% &
}EE 
}FF 	
publicHH 
DataSetHH 
GetAllCategoriesHH '
(HH' (
)HH( )
{II 	
usingJJ 
(JJ 
varJJ 
connJJ 
=JJ 
newJJ !
OracleConnectionJJ" 2
(JJ2 3
_connectionStringJJ3 D
)JJD E
)JJE F
{KK 
stringLL 
sqlQueryLL 
=LL  !
$strLL" M
;LLM N
OracleDataAdapterMM !
daMM" $
=MM% &
newMM' *
OracleDataAdapterMM+ <
(MM< =
sqlQueryMM= E
,MME F
connMMG K
)MMK L
;MML M
DataSetOO 
dsOO 
=OO 
newOO  
DataSetOO! (
(OO( )
)OO) *
;OO* +
daPP 
.PP 
FillPP 
(PP 
dsPP 
,PP 
$strPP #
)PP# $
;PP$ %
returnRR 
dsRR 
;RR 
}SS 
}TT 	
publicVV 
boolVV !
DoesCategoryCodeExistVV )
(VV) *
stringVV* 0
categoryCodeVV1 =
)VV= >
{WW 	
usingXX 
(XX 
varXX 
connXX 
=XX 
newXX !
OracleConnectionXX" 2
(XX2 3
_connectionStringXX3 D
)XXD E
)XXE F
{YY 
stringZZ 
sqlQueryZZ 
=ZZ  !
$strZZ" a
;ZZa b
var[[ 
cmd[[ 
=[[ 
new[[ 
OracleCommand[[ +
([[+ ,
sqlQuery[[, 4
,[[4 5
conn[[6 :
)[[: ;
;[[; <
cmd\\ 
.\\ 

Parameters\\ 
.\\ 
Add\\ "
(\\" #
$str\\# 2
,\\2 3
OracleDbType\\4 @
.\\@ A
Varchar2\\A I
)\\I J
.\\J K
Value\\K P
=\\Q R
categoryCode\\S _
;\\_ `
conn^^ 
.^^ 
Open^^ 
(^^ 
)^^ 
;^^ 
int__ 
count__ 
=__ 
Convert__ #
.__# $
ToInt32__$ +
(__+ ,
cmd__, /
.__/ 0
ExecuteScalar__0 =
(__= >
)__> ?
)__? @
;__@ A
conn`` 
.`` 
Close`` 
(`` 
)`` 
;`` 
returnbb 
countbb 
>bb 
$numbb  
;bb  !
}cc 
}dd 	
}ee 
}ff —
BC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\DBConnect.cs
	namespace 	
ToolSYS
 
. 
Data 
{ 
public 

static 
class 
	DbConnect !
{ 
public		 
const		 
string		 
Oradb		 !
=		" #
$str		$ y
;		y z
} 
} ¹Œ
EC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\CustomerData.cs
	namespace 	
ToolSYS
 
. 
Data 
{ 
public 

	interface 
ICustomerData "
{ 
int		 
GetNextCustomerId		 
(		 
)		 
;		  
void

 
AddCustomer

 
(

 
Customer

 !
customer

" *
)

* +
;

+ ,
void 
UpdateCustomer 
( 
Customer $
customer% -
)- .
;. /
DataSet 
SearchCustomers 
(  
string  &
searchPhrase' 3
)3 4
;4 5
DataSet  
GetFilteredCustomers $
($ %
string% +
custIdAsString, :
,: ;
string< B
forenameC K
,K L
stringM S
surnameT [
,[ \
string] c
emaild i
,i j
stringk q
phoner w
,w x
stringy 
eircode
€ ‡
,
‡ ˆ
string
‰ 
phrase
 –
)
– —
;
— ˜
} 
public 

class 
CustomerData 
: 
ICustomerData  -
{ 
private 
readonly 
string 
_connectionString  1
=2 3
	DbConnect4 =
.= >
Oradb> C
;C D
public 
int 
GetNextCustomerId $
($ %
)% &
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
_connectionString3 D
)D E
)E F
{ 
var 
cmd 
= 
new 
OracleCommand +
(+ ,
$str, ?
,? @
connA E
)E F
{ 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
} 
; 
cmd 
. 

Parameters 
. 
Add "
(" #
$str# 5
,5 6
OracleDbType7 C
.C D
Int32D I
,I J
ParameterDirectionK ]
.] ^
Output^ d
)d e
;e f
conn 
. 
Open 
( 
) 
; 
cmd   
.   
ExecuteNonQuery   #
(  # $
)  $ %
;  % &
int!! 
nextCustomerId!! "
=!!# $
Convert!!% ,
.!!, -
ToInt32!!- 4
(!!4 5
cmd!!5 8
.!!8 9

Parameters!!9 C
[!!C D
$str!!D V
]!!V W
.!!W X
Value!!X ]
.!!] ^
ToString!!^ f
(!!f g
)!!g h
)!!h i
;!!i j
conn"" 
."" 
Close"" 
("" 
)"" 
;"" 
return$$ 
nextCustomerId$$ %
;$$% &
}%% 
}&& 	
public(( 
void(( 
AddCustomer(( 
(((  
Customer((  (
customer(() 1
)((1 2
{)) 	
using** 
(** 
var** 
conn** 
=** 
new** !
OracleConnection**" 2
(**2 3
_connectionString**3 D
)**D E
)**E F
{++ 
var,, 
cmd,, 
=,, 
new,, 
OracleCommand,, +
(,,+ ,
$str,,, 9
,,,9 :
conn,,; ?
),,? @
{-- 
CommandType.. 
=..  !
CommandType.." -
...- .
StoredProcedure... =
}// 
;// 
cmd11 
.11 

Parameters11 
.11 
Add11 "
(11" #
$str11# 1
,111 2
OracleDbType113 ?
.11? @
Int3211@ E
)11E F
.11F G
Value11G L
=11M N
customer11O W
.11W X

customerId11X b
;11b c
cmd22 
.22 

Parameters22 
.22 
Add22 "
(22" #
$str22# /
,22/ 0
OracleDbType221 =
.22= >
Varchar222> F
)22F G
.22G H
Value22H M
=22N O
customer22P X
.22X Y
forename22Y a
;22a b
cmd33 
.33 

Parameters33 
.33 
Add33 "
(33" #
$str33# .
,33. /
OracleDbType330 <
.33< =
Varchar233= E
)33E F
.33F G
Value33G L
=33M N
customer33O W
.33W X
surname33X _
;33_ `
cmd44 
.44 

Parameters44 
.44 
Add44 "
(44" #
$str44# ,
,44, -
OracleDbType44. :
.44: ;
Varchar244; C
)44C D
.44D E
Value44E J
=44K L
customer44M U
.44U V
email44V [
;44[ \
cmd55 
.55 

Parameters55 
.55 
Add55 "
(55" #
$str55# ,
,55, -
OracleDbType55. :
.55: ;
Varchar255; C
)55C D
.55D E
Value55E J
=55K L
customer55M U
.55U V
phone55V [
;55[ \
cmd66 
.66 

Parameters66 
.66 
Add66 "
(66" #
$str66# .
,66. /
OracleDbType660 <
.66< =
Varchar266= E
)66E F
.66F G
Value66G L
=66M N
customer66O W
.66W X
eircode66X _
;66_ `
conn88 
.88 
Open88 
(88 
)88 
;88 
cmd99 
.99 
ExecuteNonQuery99 #
(99# $
)99$ %
;99% &
conn:: 
.:: 
Close:: 
(:: 
):: 
;:: 
};; 
}<< 	
public>> 
void>> 
UpdateCustomer>> "
(>>" #
Customer>># +
customer>>, 4
)>>4 5
{?? 	
using@@ 
(@@ 
var@@ 
conn@@ 
=@@ 
new@@ !
OracleConnection@@" 2
(@@2 3
_connectionString@@3 D
)@@D E
)@@E F
{AA 
varBB 
cmdBB 
=BB 
newBB 
OracleCommandBB +
(BB+ ,
$strBB, <
,BB< =
connBB> B
)BBB C
{CC 
CommandTypeDD 
=DD  !
CommandTypeDD" -
.DD- .
StoredProcedureDD. =
}EE 
;EE 
cmdGG 
.GG 

ParametersGG 
.GG 
AddGG "
(GG" #
$strGG# 1
,GG1 2
OracleDbTypeGG3 ?
.GG? @
Int32GG@ E
)GGE F
.GGF G
ValueGGG L
=GGM N
customerGGO W
.GGW X

customerIdGGX b
;GGb c
cmdHH 
.HH 

ParametersHH 
.HH 
AddHH "
(HH" #
$strHH# /
,HH/ 0
OracleDbTypeHH1 =
.HH= >
Varchar2HH> F
)HHF G
.HHG H
ValueHHH M
=HHN O
customerHHP X
.HHX Y
forenameHHY a
;HHa b
cmdII 
.II 

ParametersII 
.II 
AddII "
(II" #
$strII# .
,II. /
OracleDbTypeII0 <
.II< =
Varchar2II= E
)IIE F
.IIF G
ValueIIG L
=IIM N
customerIIO W
.IIW X
surnameIIX _
;II_ `
cmdJJ 
.JJ 

ParametersJJ 
.JJ 
AddJJ "
(JJ" #
$strJJ# ,
,JJ, -
OracleDbTypeJJ. :
.JJ: ;
Varchar2JJ; C
)JJC D
.JJD E
ValueJJE J
=JJK L
customerJJM U
.JJU V
emailJJV [
;JJ[ \
cmdKK 
.KK 

ParametersKK 
.KK 
AddKK "
(KK" #
$strKK# ,
,KK, -
OracleDbTypeKK. :
.KK: ;
Varchar2KK; C
)KKC D
.KKD E
ValueKKE J
=KKK L
customerKKM U
.KKU V
phoneKKV [
;KK[ \
cmdLL 
.LL 

ParametersLL 
.LL 
AddLL "
(LL" #
$strLL# .
,LL. /
OracleDbTypeLL0 <
.LL< =
Varchar2LL= E
)LLE F
.LLF G
ValueLLG L
=LLM N
customerLLO W
.LLW X
eircodeLLX _
;LL_ `
connNN 
.NN 
OpenNN 
(NN 
)NN 
;NN 
cmdOO 
.OO 
ExecuteNonQueryOO #
(OO# $
)OO$ %
;OO% &
connPP 
.PP 
ClosePP 
(PP 
)PP 
;PP 
}QQ 
}RR 	
publicTT 
DataSetTT 
SearchCustomersTT &
(TT& '
stringTT' -
searchPhraseTT. :
)TT: ;
{UU 	
usingVV 
(VV 
varVV 
connVV 
=VV 
newVV !
OracleConnectionVV" 2
(VV2 3
_connectionStringVV3 D
)VVD E
)VVE F
{WW 
varXX 
cmdXX 
=XX 
newXX 
OracleCommandXX +
(XX+ ,
$strXX, =
,XX= >
connXX? C
)XXC D
{YY 
CommandTypeZZ 
=ZZ  !
CommandTypeZZ" -
.ZZ- .
StoredProcedureZZ. =
}[[ 
;[[ 
cmd]] 
.]] 

Parameters]] 
.]] 
Add]] "
(]]" #
$str]]# 3
,]]3 4
OracleDbType]]5 A
.]]A B
Varchar2]]B J
)]]J K
.]]K L
Value]]L Q
=]]R S
searchPhrase]]T `
;]]` a
cmd^^ 
.^^ 

Parameters^^ 
.^^ 
Add^^ "
(^^" #
$str^^# -
,^^- .
OracleDbType^^/ ;
.^^; <
	RefCursor^^< E
)^^E F
.^^F G
	Direction^^G P
=^^Q R
ParameterDirection^^S e
.^^e f
Output^^f l
;^^l m
conn`` 
.`` 
Open`` 
(`` 
)`` 
;`` 
OracleDataAdapteraa !
daaa" $
=aa% &
newaa' *
OracleDataAdapteraa+ <
(aa< =
cmdaa= @
)aa@ A
;aaA B
DataSetbb 
dsbb 
=bb 
newbb  
DataSetbb! (
(bb( )
)bb) *
;bb* +
dacc 
.cc 
Fillcc 
(cc 
dscc 
,cc 
$strcc &
)cc& '
;cc' (
conndd 
.dd 
Closedd 
(dd 
)dd 
;dd 
returnff 
dsff 
;ff 
}gg 
}hh 	
publicjj 
DataSetjj  
GetFilteredCustomersjj +
(jj+ ,
stringjj, 2
custIdAsStringjj3 A
,jjA B
stringjjC I
forenamejjJ R
,jjR S
stringjjT Z
surnamejj[ b
,jjb c
stringjjd j
emailjjk p
,jjp q
stringjjr x
phonejjy ~
,jj~ 
string
jj€ †
eircode
jj‡ Ž
,
jjŽ 
string
jj –
phrase
jj— 
)
jj ž
{kk 	
usingll 
(ll 
varll 
connll 
=ll 
newll !
OracleConnectionll" 2
(ll2 3
_connectionStringll3 D
)llD E
)llE F
{mm 
varnn 
cmdnn 
=nn 
newnn 
OracleCommandnn +
(nn+ ,
$strnn, B
,nnB C
connnnD H
)nnH I
{oo 
CommandTypepp 
=pp  !
CommandTypepp" -
.pp- .
StoredProcedurepp. =
}qq 
;qq 
inttt 
?tt 

customerIdtt 
=tt  !
nulltt" &
;tt& '
ifuu 
(uu 
intuu 
.uu 
TryParseuu  
(uu  !
custIdAsStringuu! /
,uu/ 0
outuu1 4
intuu5 8
parsedIduu9 A
)uuA B
)uuB C

customerIdvv 
=vv  
parsedIdvv! )
;vv) *
cmdxx 
.xx 

Parametersxx 
.xx 
Addxx "
(xx" #
$strxx# 1
,xx1 2
OracleDbTypexx3 ?
.xx? @
Int32xx@ E
)xxE F
.xxF G
ValuexxG L
=xxM N

customerIdxxO Y
.xxY Z
HasValuexxZ b
?xxc d
(xxe f
objectxxf l
)xxl m

customerIdxxm w
.xxw x
Valuexxx }
:xx~ 
DBNull
xx€ †
.
xx† ‡
Value
xx‡ Œ
;
xxŒ 
cmdyy 
.yy 

Parametersyy 
.yy 
Addyy "
(yy" #
$stryy# /
,yy/ 0
OracleDbTypeyy1 =
.yy= >
Varchar2yy> F
)yyF G
.yyG H
ValueyyH M
=yyN O
stringyyP V
.yyV W
IsNullOrEmptyyyW d
(yyd e
forenameyye m
)yym n
?yyo p
DBNullyyq w
.yyw x
Valueyyx }
:yy~ 
(
yy€ 
object
yy ‡
)
yy‡ ˆ
forename
yyˆ 
;
yy ‘
cmdzz 
.zz 

Parameterszz 
.zz 
Addzz "
(zz" #
$strzz# .
,zz. /
OracleDbTypezz0 <
.zz< =
Varchar2zz= E
)zzE F
.zzF G
ValuezzG L
=zzM N
stringzzO U
.zzU V
IsNullOrEmptyzzV c
(zzc d
surnamezzd k
)zzk l
?zzm n
DBNullzzo u
.zzu v
Valuezzv {
:zz| }
(zz~ 
object	zz …
)
zz… †
surname
zz† 
;
zz Ž
cmd{{ 
.{{ 

Parameters{{ 
.{{ 
Add{{ "
({{" #
$str{{# ,
,{{, -
OracleDbType{{. :
.{{: ;
Varchar2{{; C
){{C D
.{{D E
Value{{E J
={{K L
string{{M S
.{{S T
IsNullOrEmpty{{T a
({{a b
email{{b g
){{g h
?{{i j
DBNull{{k q
.{{q r
Value{{r w
:{{x y
({{z {
object	{{{ 
)
{{ ‚
email
{{‚ ‡
;
{{‡ ˆ
cmd|| 
.|| 

Parameters|| 
.|| 
Add|| "
(||" #
$str||# ,
,||, -
OracleDbType||. :
.||: ;
Varchar2||; C
)||C D
.||D E
Value||E J
=||K L
string||M S
.||S T
IsNullOrEmpty||T a
(||a b
phone||b g
)||g h
?||i j
DBNull||k q
.||q r
Value||r w
:||x y
(||z {
object	||{ 
)
|| ‚
phone
||‚ ‡
;
||‡ ˆ
cmd}} 
.}} 

Parameters}} 
.}} 
Add}} "
(}}" #
$str}}# .
,}}. /
OracleDbType}}0 <
.}}< =
Varchar2}}= E
)}}E F
.}}F G
Value}}G L
=}}M N
string}}O U
.}}U V
IsNullOrEmpty}}V c
(}}c d
eircode}}d k
)}}k l
?}}m n
DBNull}}o u
.}}u v
Value}}v {
:}}| }
(}}~ 
object	}} …
)
}}… †
eircode
}}† 
;
}} Ž
cmd~~ 
.~~ 

Parameters~~ 
.~~ 
Add~~ "
(~~" #
$str~~# -
,~~- .
OracleDbType~~/ ;
.~~; <
Varchar2~~< D
)~~D E
.~~E F
Value~~F K
=~~L M
string~~N T
.~~T U
IsNullOrEmpty~~U b
(~~b c
phrase~~c i
)~~i j
?~~k l
DBNull~~m s
.~~s t
Value~~t y
:~~z {
(~~| }
object	~~} ƒ
)
~~ƒ „
phrase
~~„ Š
;
~~Š ‹
cmd 
. 

Parameters 
. 
Add "
(" #
$str# -
,- .
OracleDbType/ ;
.; <
	RefCursor< E
)E F
.F G
	DirectionG P
=Q R
ParameterDirectionS e
.e f
Outputf l
;l m
conn
 
.
 
Open
 
(
 
)
 
;
 
OracleDataAdapter
‚‚ !
da
‚‚" $
=
‚‚% &
new
‚‚' *
OracleDataAdapter
‚‚+ <
(
‚‚< =
cmd
‚‚= @
)
‚‚@ A
;
‚‚A B
DataSet
ƒƒ 
ds
ƒƒ 
=
ƒƒ 
new
ƒƒ  
DataSet
ƒƒ! (
(
ƒƒ( )
)
ƒƒ) *
;
ƒƒ* +
da
„„ 
.
„„ 
Fill
„„ 
(
„„ 
ds
„„ 
,
„„ 
$str
„„ &
)
„„& '
;
„„' (
conn
…… 
.
…… 
Close
…… 
(
…… 
)
…… 
;
…… 
return
‡‡ 
ds
‡‡ 
;
‡‡ 
}
ˆˆ 
}
‰‰ 	
}
ŠŠ 
}‹‹ ®,
EC:\GitHub\SoftwareDesignPatterns\ToolSYS\ToolSYS.Data\AnalysisData.cs
	namespace 	
ToolSYS
 
. 
Data 
{ 
public 

	interface 
IAnalysisData "
{ 
	DataTable 
GetDistinctYears "
(" #
)# $
;$ %
	DataTable		 
GetMonthlyRevenues		 $
(		$ %
int		% (
year		) -
)		- .
;		. /
	DataTable

 '
GetMonthlyRentalsByCategory

 -
(

- .
int

. 1
year

2 6
,

6 7
string

8 >
categoryCode

? K
)

K L
;

L M
} 
public 

class 
AnalysisData 
: 
IAnalysisData  -
{ 
private 
readonly 
string 
_connectionString  1
=2 3
	DbConnect4 =
.= >
Oradb> C
;C D
public 
	DataTable 
GetDistinctYears )
() *
)* +
{ 	
using 
( 
var 
conn 
= 
new !
OracleConnection" 2
(2 3
_connectionString3 D
)D E
)E F
{ 
string 
sqlQuery 
=  !
$str" w
;w x
OracleCommand 
cmd !
=" #
new$ '
OracleCommand( 5
(5 6
sqlQuery6 >
,> ?
conn@ D
)D E
;E F
conn 
. 
Open 
( 
) 
; 
	DataTable 

yearsTable $
=% &
new' *
	DataTable+ 4
(4 5
)5 6
;6 7
using 
( 
OracleDataReader '
reader( .
=/ 0
cmd1 4
.4 5
ExecuteReader5 B
(B C
)C D
)D E
{ 

yearsTable 
. 
Load #
(# $
reader$ *
)* +
;+ ,
} 
return 

yearsTable !
;! "
}   
}!! 	
public## 
	DataTable## 
GetMonthlyRevenues## +
(##+ ,
int##, /
year##0 4
)##4 5
{$$ 	
string%% 
sqlQuery%% 
=%% 
$str%* <
;**< =
using,, 
(,, 
var,, 
conn,, 
=,, 
new,, !
OracleConnection,," 2
(,,2 3
_connectionString,,3 D
),,D E
),,E F
{-- 
OracleCommand.. 
cmd.. !
=.." #
new..$ '
OracleCommand..( 5
(..5 6
sqlQuery..6 >
,..> ?
conn..@ D
)..D E
;..E F
cmd// 
.// 

Parameters// 
.// 
Add// "
(//" #
$str//# *
,//* +
year//, 0
.//0 1
ToString//1 9
(//9 :
)//: ;
)//; <
;//< =
	DataTable11 
revenueTable11 &
=11' (
new11) ,
	DataTable11- 6
(116 7
)117 8
;118 9
OracleDataAdapter22 !
da22" $
=22% &
new22' *
OracleDataAdapter22+ <
(22< =
cmd22= @
)22@ A
;22A B
conn44 
.44 
Open44 
(44 
)44 
;44 
da55 
.55 
Fill55 
(55 
revenueTable55 $
)55$ %
;55% &
return77 
revenueTable77 #
;77# $
}88 
}99 	
public;; 
	DataTable;; '
GetMonthlyRentalsByCategory;; 4
(;;4 5
int;;5 8
year;;9 =
,;;= >
string;;? E
categoryCode;;F R
);;R S
{<< 	
string== 
sqlQuery== 
=== 
$str=D 
;DD  
usingFF 
(FF 
varFF 
connFF 
=FF 
newFF !
OracleConnectionFF" 2
(FF2 3
_connectionStringFF3 D
)FFD E
)FFE F
{GG 
OracleCommandHH 
cmdHH !
=HH" #
newHH$ '
OracleCommandHH( 5
(HH5 6
sqlQueryHH6 >
,HH> ?
connHH@ D
)HHD E
;HHE F
cmdII 
.II 

ParametersII 
.II 
AddII "
(II" #
$strII# *
,II* +
yearII, 0
.II0 1
ToStringII1 9
(II9 :
)II: ;
)II; <
;II< =
cmdJJ 
.JJ 

ParametersJJ 
.JJ 
AddJJ "
(JJ" #
$strJJ# 2
,JJ2 3
categoryCodeJJ4 @
)JJ@ A
;JJA B
OracleDataAdapterLL !
daLL" $
=LL% &
newLL' *
OracleDataAdapterLL+ <
(LL< =
cmdLL= @
)LL@ A
;LLA B
	DataTableMM 
dtMM 
=MM 
newMM "
	DataTableMM# ,
(MM, -
)MM- .
;MM. /
connOO 
.OO 
OpenOO 
(OO 
)OO 
;OO 
daPP 
.PP 
FillPP 
(PP 
dtPP 
)PP 
;PP 
returnRR 
dtRR 
;RR 
}SS 
}TT 	
}UU 
}VV 